"use strict";(self.webpackChunkAlfonsoLopezViejo_Github_io=self.webpackChunkAlfonsoLopezViejo_Github_io||[]).push([[792],{675:()=>{function Os(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function Hn(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){Os(s,i,r,o,a,"next",l)}function a(l){Os(s,i,r,o,a,"throw",l)}o(void 0)})}}let yn=null,ls=!1,Yf=1;const kn=Symbol("SIGNAL");function ht(n){const e=yn;return yn=n,e}const Fs={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function So(n){if(ls)throw new Error("");if(null===yn)return;yn.consumerOnSignalRead(n);const e=yn.nextProducerIndex++;Yl(yn),e<yn.producerNode.length&&yn.producerNode[e]!==n&&To(yn)&&Xl(yn.producerNode[e],yn.producerIndexOfThis[e]),yn.producerNode[e]!==n&&(yn.producerNode[e]=n,yn.producerIndexOfThis[e]=To(yn)?ql(n,yn,e):0),yn.producerLastReadVersion[e]=n.version}function jr(n){if((!To(n)||n.dirty)&&(n.dirty||n.lastCleanEpoch!==Yf)){if(!n.producerMustRecompute(n)&&!Tr(n))return void ba(n);n.producerRecomputeValue(n),ba(n)}}function Zf(n){if(void 0===n.liveConsumerNode)return;const e=ls;ls=!0;try{for(const t of n.liveConsumerNode)t.dirty||fd(t)}finally{ls=e}}function fd(n){n.dirty=!0,Zf(n),n.consumerMarkedDirty?.(n)}function ba(n){n.dirty=!1,n.lastCleanEpoch=Yf}function cs(n){return n&&(n.nextProducerIndex=0),ht(n)}function us(n,e){if(ht(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(To(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Xl(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Tr(n){Yl(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],i=n.producerLastReadVersion[e];if(i!==t.version||(jr(t),i!==t.version))return!0}return!1}function Ma(n){if(Yl(n),To(n))for(let e=0;e<n.producerNode.length;e++)Xl(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function ql(n,e,t){if(Jf(n),0===n.liveConsumerNode.length&&Kf(n))for(let i=0;i<n.producerNode.length;i++)n.producerIndexOfThis[i]=ql(n.producerNode[i],n,i);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function Xl(n,e){if(Jf(n),1===n.liveConsumerNode.length&&Kf(n))for(let i=0;i<n.producerNode.length;i++)Xl(n.producerNode[i],n.producerIndexOfThis[i]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[e],r=n.liveConsumerNode[e];Yl(r),r.producerIndexOfThis[i]=e}}function To(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Yl(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function Jf(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function Kf(n){return void 0!==n.producerNode}let Qf=function KS(){throw new Error};function Jl(n,e){(function hd(){return!1!==yn?.consumerAllowSignalWrites})()||function ep(){Qf()}(),n.equal(n.value,e)||(n.value=e,function k(n){n.version++,function qy(){Yf++}(),Zf(n)}(n))}const Ql={...Fs,equal:function wa(n,e){return Object.is(n,e)},value:void 0,kind:"signal"};function ye(n){return"function"==typeof n}function ni(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Kt=ni(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function jt(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Ut{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(ye(i))try{i()}catch(s){e=s instanceof Kt?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{Ta(s)}catch(o){e=e??[],o instanceof Kt?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Kt(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Ta(e);else{if(e instanceof Ut){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&jt(t,e)}remove(e){const{_finalizers:t}=this;t&&jt(t,e),e instanceof Ut&&e._removeParent(this)}}Ut.EMPTY=(()=>{const n=new Ut;return n.closed=!0,n})();const ks=Ut.EMPTY;function Co(n){return n instanceof Ut||n&&"closed"in n&&ye(n.remove)&&ye(n.add)&&ye(n.unsubscribe)}function Ta(n){ye(n)?n():n.unsubscribe()}const $r={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},mi={setTimeout(n,e,...t){const{delegate:i}=mi;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=mi;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Ca(n){mi.setTimeout(()=>{const{onUnhandledError:e}=$r;if(!e)throw n;e(n)})}function Mn(){}const Da=gd("C",void 0,void 0);function gd(n,e,t){return{kind:n,value:e,error:t}}let Aa=null;function np(n){if($r.useDeprecatedSynchronousErrorHandling){const e=!Aa;if(e&&(Aa={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Aa;if(Aa=null,t)throw i}}else n()}class Ky extends Ut{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Co(e)&&e.add(this)):this.destination=T3}static create(e,t,i){return new md(e,t,i)}next(e){this.isStopped?e_(function Jy(n){return gd("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?e_(function Zy(n){return gd("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?e_(Da,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const M3=Function.prototype.bind;function Qy(n,e){return M3.call(n,e)}class E3{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){ip(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){ip(i)}else ip(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){ip(t)}}}class md extends Ky{constructor(e,t,i){let r;if(super(),ye(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&$r.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Qy(e.next,s),error:e.error&&Qy(e.error,s),complete:e.complete&&Qy(e.complete,s)}):r=e}this.destination=new E3(r)}}function ip(n){$r.useDeprecatedSynchronousErrorHandling?function b3(n){$r.useDeprecatedSynchronousErrorHandling&&Aa&&(Aa.errorThrown=!0,Aa.error=n)}(n):Ca(n)}function e_(n,e){const{onStoppedNotification:t}=$r;t&&mi.setTimeout(()=>t(n,e))}const T3={closed:!0,next:Mn,error:function S3(n){throw n},complete:Mn},t_="function"==typeof Symbol&&Symbol.observable||"@@observable";function Do(n){return n}function tT(n){return 0===n.length?Do:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Nn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function A3(n){return n&&n instanceof Ky||function D3(n){return n&&ye(n.next)&&ye(n.error)&&ye(n.complete)}(n)&&Co(n)}(t)?t:new md(t,i,r);return np(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=nT(i))((r,s)=>{const o=new md({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[t_](){return this}pipe(...t){return tT(t)(this)}toPromise(t){return new(t=nT(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function nT(n){var e;return null!==(e=n??$r.Promise)&&void 0!==e?e:Promise}const I3=ni(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ii=(()=>{class n extends Nn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new iT(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new I3}next(t){np(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){np(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){np(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?ks:(this.currentObservers=null,s.push(t),new Ut(()=>{this.currentObservers=null,jt(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new Nn;return t.source=this,t}}return n.create=(e,t)=>new iT(e,t),n})();class iT extends ii{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:ks}}class Cr extends ii{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function rT(n){return ye(n?.lift)}function Gn(n){return e=>{if(rT(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Un(n,e,t,i,r){return new R3(n,e,t,i,r)}class R3 extends Ky{constructor(e,t,i,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Ct(n,e){return Gn((t,i)=>{let r=0;t.subscribe(Un(i,s=>{i.next(n.call(e,s,r++))}))})}const sT="https://g.co/ng/security#xss";class te extends Error{code;constructor(e,t){super(function Ia(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}const rp=Symbol("InputSignalNode#UNSET"),oT={...Ql,transformFn:void 0,applyValueToInputSignal(n,e){Jl(n,e)}};function aT(n,e){const t=Object.create(oT);function i(){if(So(t),t.value===rp)throw new te(-950,!1);return t.value}return t.value=n,t.transformFn=e?.transform,i[kn]=t,i}function Us(n){return{toString:n}.toString()}const tc="__parameters__";function ic(n,e,t){return Us(()=>{const i=function n_(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const d=l.hasOwnProperty(tc)?l[tc]:Object.defineProperty(l,tc,{value:[]})[tc];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}const hn=globalThis;function Xt(n){for(let e in n)if(n[e]===Xt)return e;throw Error("Could not find renamed property on target object.")}function jn(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(jn).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function i_(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const P3=Xt({__forward_ref__:Xt});function r_(n){return n.__forward_ref__=r_,n.toString=function(){return jn(this())},n}function et(n){return sp(n)?n():n}function sp(n){return"function"==typeof n&&n.hasOwnProperty(P3)&&n.__forward_ref__===r_}function xe(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Ra(n){return{providers:n.providers||[],imports:n.imports||[]}}function op(n){return cT(n,lp)||cT(n,uT)}function cT(n,e){return n.hasOwnProperty(e)?n[e]:null}function ap(n){return n&&(n.hasOwnProperty(s_)||n.hasOwnProperty(B3))?n[s_]:null}const lp=Xt({\u0275prov:Xt}),s_=Xt({\u0275inj:Xt}),uT=Xt({ngInjectableDef:Xt}),B3=Xt({ngInjectorDef:Xt});class oe{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=xe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function l_(n){return n&&!!n.\u0275providers}const vd=Xt({\u0275cmp:Xt}),c_=Xt({\u0275dir:Xt}),u_=Xt({\u0275pipe:Xt}),hT=Xt({\u0275mod:Xt}),Bs=Xt({\u0275fac:Xt}),yd=Xt({__NG_ELEMENT_ID__:Xt}),fT=Xt({__NG_ENV_ID__:Xt});function lt(n){return"string"==typeof n?n:null==n?"":String(n)}function d_(n,e){throw new te(-201,!1)}var Dt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Dt||{});let h_;function pT(){return h_}function ji(n){const e=h_;return h_=n,e}function gT(n,e,t){const i=op(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Dt.Optional?null:void 0!==e?e:void d_()}const _d={},f_="__NG_DI_FLAG__",dp="ngTempTokenPath",$3=/\n/gm,mT="__source";let rc;function Io(n){const e=rc;return rc=n,e}function X3(n,e=Dt.Default){if(void 0===rc)throw new te(-203,!1);return null===rc?gT(n,void 0,e):rc.get(n,e&Dt.Optional?null:void 0,e)}function _e(n,e=Dt.Default){return(pT()||X3)(et(n),e)}function W(n,e=Dt.Default){return _e(n,hp(e))}function hp(n){return typeof n>"u"||"number"==typeof n?n:(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function p_(n){const e=[];for(let t=0;t<n.length;t++){const i=et(n[t]);if(Array.isArray(i)){if(0===i.length)throw new te(900,!1);let r,s=Dt.Default;for(let o=0;o<i.length;o++){const a=i[o],l=Y3(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(_e(r,s))}else e.push(_e(i))}return e}function xd(n,e){return n[f_]=e,n.prototype[f_]=e,n}function Y3(n){return n[f_]}const g_=xd(ic("Optional"),8),m_=xd(ic("SkipSelf"),4);function Na(n,e){return n.hasOwnProperty(Bs)?n[Bs]:null}function sc(n,e){n.forEach(t=>Array.isArray(t)?sc(t,e):e(t))}function yT(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function fp(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function cr(n,e,t){let i=oc(n,e);return i>=0?n[1|i]=t:(i=~i,function _T(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function y_(n,e){const t=oc(n,e);if(t>=0)return n[1|t]}function oc(n,e){return function xT(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const ds={},Bt=[],Dr=new oe(""),wT=new oe("",-1),__=new oe("");class gp{get(e,t=_d){if(t===_d){const i=new Error(`NullInjectorError: No provider for ${jn(e)}!`);throw i.name="NullInjectorError",i}return t}}function vi(n,e){const t=n[hT]||null;if(!t&&!0===e)throw new Error(`Type ${jn(n)} does not have '\u0275mod' property.`);return t}function _t(n){return n[vd]||null}function $n(n){return n[c_]||null}function hi(n){return n[u_]||null}function Vs(n){return{\u0275providers:n}}function bT(...n){return{\u0275providers:x_(0,n),\u0275fromNgModule:!0}}function x_(n,...e){const t=[],i=new Set;let r;const s=o=>{t.push(o)};return sc(e,o=>{const a=o;mp(a,s,[],i)&&(r||=[],r.push(a))}),void 0!==r&&MT(r,s),t}function MT(n,e){for(let t=0;t<n.length;t++){const{ngModule:i,providers:r}=n[t];w_(r,s=>{e(s,i)})}}function mp(n,e,t,i){if(!(n=et(n)))return!1;let r=null,s=ap(n);const o=!s&&_t(n);if(s||o){if(o&&!o.standalone)return!1;r=n}else{const l=n.ngModule;if(s=ap(l),!s)return!1;r=l}const a=i.has(r);if(o){if(a)return!1;if(i.add(r),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const c of l)mp(c,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let c;i.add(r);try{sc(s.imports,u=>{mp(u,e,t,i)&&(c||=[],c.push(u))})}finally{}void 0!==c&&MT(c,e)}if(!a){const c=Na(r)||(()=>new r);e({provide:r,useFactory:c,deps:Bt},r),e({provide:__,useValue:r,multi:!0},r),e({provide:Dr,useValue:()=>_e(r),multi:!0},r)}const l=s.providers;if(null!=l&&!a){const c=n;w_(l,u=>{e(u,c)})}}}return r!==n&&void 0!==n.providers}function w_(n,e){for(let t of n)l_(t)&&(t=t.\u0275providers),Array.isArray(t)?w_(t,e):e(t)}const nU=Xt({provide:String,useValue:Xt});function b_(n){return null!==n&&"object"==typeof n&&nU in n}function Pa(n){return"function"==typeof n}const M_=new oe(""),vp={},rU={};let E_;function yp(){return void 0===E_&&(E_=new gp),E_}class Ci{}class La extends Ci{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,T_(e,o=>this.processProvider(o)),this.records.set(wT,ac(void 0,this)),r.has("environment")&&this.records.set(Ci,ac(void 0,this));const s=this.records.get(M_);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(__,Bt,Dt.Self))}destroy(){wd(this),this._destroyed=!0;const e=ht(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ht(e)}}onDestroy(e){return wd(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){wd(this);const t=Io(this),i=ji(void 0);try{return e()}finally{Io(t),ji(i)}}get(e,t=_d,i=Dt.Default){if(wd(this),e.hasOwnProperty(fT))return e[fT](this);i=hp(i);const s=Io(this),o=ji(void 0);try{if(!(i&Dt.SkipSelf)){let l=this.records.get(e);if(void 0===l){const c=function cU(n){return"function"==typeof n||"object"==typeof n&&n instanceof oe}(e)&&op(e);l=c&&this.injectableDefInScope(c)?ac(S_(e),vp):null,this.records.set(e,l)}if(null!=l)return this.hydrate(e,l)}return(i&Dt.Self?yp():this.parent).get(e,t=i&Dt.Optional&&t===_d?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[dp]=a[dp]||[]).unshift(jn(e)),s)throw a;return function Z3(n,e,t,i){const r=n[dp];throw e[mT]&&r.unshift(e[mT]),n.message=function J3(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=jn(e);if(Array.isArray(e))r=e.map(jn).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):jn(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace($3,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[dp]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{ji(o),Io(s)}}resolveInjectorInitializers(){const e=ht(null),t=Io(this),i=ji(void 0);try{const s=this.get(Dr,Bt,Dt.Self);for(const o of s)o()}finally{Io(t),ji(i),ht(e)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(jn(i));return`R3Injector[${e.join(", ")}]`}processProvider(e){let t=Pa(e=et(e))?e:et(e&&e.provide);const i=function oU(n){return b_(n)?ac(void 0,n.useValue):ac(function TT(n,e,t){let i;if(Pa(n)){const r=et(n);return Na(r)||S_(r)}if(b_(n))i=()=>et(n.useValue);else if(function ST(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...p_(n.deps||[]));else if(function ET(n){return!(!n||!n.useExisting)}(n))i=()=>_e(et(n.useExisting));else{const r=et(n&&(n.useClass||n.provide));if(!function aU(n){return!!n.deps}(n))return Na(r)||S_(r);i=()=>new r(...p_(n.deps))}return i}(n),vp)}(e);if(!Pa(e)&&!0===e.multi){let r=this.records.get(t);r||(r=ac(void 0,vp,!0),r.factory=()=>p_(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){const i=ht(null);try{return t.value===vp&&(t.value=rU,t.value=t.factory()),"object"==typeof t.value&&t.value&&function lU(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ht(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;const t=et(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function S_(n){const e=op(n),t=null!==e?e.factory:Na(n);if(null!==t)return t;if(n instanceof oe)throw new te(204,!1);if(n instanceof Function)return function sU(n){if(n.length>0)throw new te(204,!1);const t=function U3(n){return n&&(n[lp]||n[uT])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new te(204,!1)}function wd(n){if(n.destroyed)throw new te(205,!1)}function ac(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function T_(n,e){for(const t of n)Array.isArray(t)?T_(t,e):t&&l_(t)?T_(t.\u0275providers,e):e(t)}function Ar(n,e){n instanceof La&&wd(n);const i=Io(n),r=ji(void 0);try{return e()}finally{Io(i),ji(r)}}function CT(){return void 0!==pT()||null!=function q3(){return rc}()}function xn(n){return Array.isArray(n)&&"object"==typeof n[1]}function qn(n){return Array.isArray(n)&&!0===n[1]}function A_(n){return!!(4&n.flags)}function Po(n){return n.componentOffset>-1}function Mp(n){return!(1&~n.flags)}function Wr(n){return!!n.template}function Md(n){return!!(512&n[2])}function Lo(n){return!(256&~n[2])}class wU{previousValue;currentValue;firstChange;constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function OT(n,e,t,i){null!==e?e.applyValueToInputSignal(e,i):n[t]=i}const Ua=(()=>{const n=()=>FT;return n.ngInherit=!0,n})();function FT(n){return n.type.prototype.ngOnChanges&&(n.setInput=MU),bU}function bU(){const n=UT(this),e=n?.current;if(e){const t=n.previous;if(t===ds)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function MU(n,e,t,i,r){const s=this.declaredInputs[i],o=UT(n)||function EU(n,e){return n[kT]=e}(n,{previous:ds,current:null}),a=o.current||(o.current={}),l=o.previous,c=l[s];a[s]=new wU(c&&c.currentValue,t,l===ds),OT(n,e,r,t)}const kT="__ngSimpleChanges__";function UT(n){return n[kT]||null}function Pt(n){for(;Array.isArray(n);)n=n[0];return n}function gc(n,e){return Pt(e[n])}function _i(n,e){return Pt(e[n.index])}function Ba(n,e){return n.data[e]}function Va(n,e){return n[e]}function ur(n,e){const t=e[n];return xn(t)?t:t[0]}function N_(n){return!(128&~n[2])}function Rr(n,e){return null==e?null:n[e]}function zT(n){n[17]=0}function P_(n){1024&n[2]||(n[2]|=1024,N_(n)&&Ed(n))}function Sp(n){return!!(9216&n[2]||n[24]?.dirty)}function L_(n){n[10].changeDetectionScheduler?.notify(9),64&n[2]&&(n[2]|=1024),Sp(n)&&Ed(n)}function Ed(n){n[10].changeDetectionScheduler?.notify(0);let e=Gs(n);for(;null!==e&&!(8192&e[2])&&(e[2]|=8192,N_(e));)e=Gs(e)}function Tp(n,e){if(Lo(n))throw new te(911,!1);null===n[21]&&(n[21]=[]),n[21].push(e)}function Gs(n){const e=n[3];return qn(e)?e[3]:e}function GT(n){return n[7]??=[]}function jT(n){return n.cleanup??=[]}const rt={lFrame:eC(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let k_=!1;function $T(){return rt.bindingsEnabled}function za(){return null!==rt.skipHydrationRootTNode}function U(){return rt.lFrame.lView}function tt(){return rt.lFrame.tView}function xt(){let n=WT();for(;null!==n&&64===n.type;)n=n.parent;return n}function WT(){return rt.lFrame.currentTNode}function qr(n,e){const t=rt.lFrame;t.currentTNode=n,t.isParent=e}function U_(){return rt.lFrame.isParent}function B_(){rt.lFrame.isParent=!1}function YT(){return k_}function Dp(n){const e=k_;return k_=n,e}function Ai(){const n=rt.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Nr(){return rt.lFrame.bindingIndex++}function $s(n){const e=rt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function zU(n,e){const t=rt.lFrame;t.bindingIndex=t.bindingRootIndex=n,V_(e)}function V_(n){rt.lFrame.currentDirectiveIndex=n}function H_(){return rt.lFrame.currentQueryIndex}function Ap(n){rt.lFrame.currentQueryIndex=n}function GU(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[5]:null}function KT(n,e,t){if(t&Dt.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&Dt.Host||(r=GU(s),null===r||(s=s[14],10&r.type))););if(null===r)return!1;e=r,n=s}const i=rt.lFrame=QT();return i.currentTNode=e,i.lView=n,!0}function G_(n){const e=QT(),t=n[1];rt.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function QT(){const n=rt.lFrame,e=null===n?null:n.child;return null===e?eC(n):e}function eC(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function tC(){const n=rt.lFrame;return rt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const nC=tC;function j_(){const n=tC();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function fi(){return rt.lFrame.selectedIndex}function Ha(n){rt.lFrame.selectedIndex=n}function Qt(){const n=rt.lFrame;return Ba(n.tView,n.selectedIndex)}function si(){rt.lFrame.currentNamespace="svg"}function Ws(){!function WU(){rt.lFrame.currentNamespace=null}()}let rC=!0;function Td(){return rC}function ps(n){rC=n}function Ip(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),c&&((n.viewHooks??=[]).push(t,c),(n.viewCheckHooks??=[]).push(t,c)),null!=u&&(n.destroyHooks??=[]).push(t,u)}}function Rp(n,e,t){sC(n,e,3,t)}function Np(n,e,t,i){(3&n[2])===t&&sC(n,e,t,i)}function $_(n,e){let t=n[2];(3&t)===e&&(t&=16383,t+=1,n[2]=t)}function sC(n,e,t,i){const s=i??-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[17]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[17]+=65536),(a<s||-1==s)&&(XU(n,t,e,l),n[17]=(4294901760&n[17])+l+2),l++}function oC(n,e){const t=ht(null);try{e.call(n)}finally{ht(t)}}function XU(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];r?n[2]>>14<n[17]>>16&&(3&n[2])===e&&(n[2]+=16384,oC(a,s)):oC(a,s)}class Cd{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,i){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=i}}function aC(n){return 3===n||4===n||6===n}function lC(n){return 64===n.charCodeAt(0)}function vc(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||cC(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function cC(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}const X_={};class Ga{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=hp(i);const r=this.injector.get(e,X_,i);return r!==X_||t===X_?r:this.parentInjector.get(e,t,i)}}function Y_(n){return-1!==n}function Dd(n){return 32767&n}function Ad(n,e){let t=function eB(n){return n>>16}(n),i=e;for(;t>0;)i=i[14],t--;return i}let Z_=!0;function Pp(n){const e=Z_;return Z_=n,e}let nB=0;const gs={};function Lp(n,e){const t=hC(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,J_(i.data,n),J_(e,null),J_(i.blueprint,null));const r=Op(n,e),s=n.injectorIndex;if(Y_(r)){const o=Dd(r),a=Ad(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function J_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function hC(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Op(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=_C(r),null===i)return-1;if(t++,r=r[14],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function K_(n,e,t){!function iB(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(yd)&&(i=t[yd]),null==i&&(i=t[yd]=nB++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function fC(n,e,t){if(t&Dt.Optional||void 0!==n)return n;d_()}function pC(n,e,t,i){if(t&Dt.Optional&&void 0===i&&(i=null),!(t&(Dt.Self|Dt.Host))){const r=n[9],s=ji(void 0);try{return r?r.get(e,i,t&Dt.Optional):gT(e,i,t&Dt.Optional)}finally{ji(s)}}return fC(i,0,t)}function gC(n,e,t,i=Dt.Default,r){if(null!==n){if(2048&e[2]&&!(i&Dt.Self)){const o=function lB(n,e,t,i,r){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[2]&&!(512&o[2]);){const a=mC(s,o,t,i|Dt.Self,gs);if(a!==gs)return a;let l=s.parent;if(!l){const c=o[20];if(c){const u=c.get(t,gs,i);if(u!==gs)return u}l=_C(o),o=o[14]}s=l}return r}(n,e,t,i,gs);if(o!==gs)return o}const s=mC(n,e,t,i,gs);if(s!==gs)return s}return pC(e,t,i,r)}function mC(n,e,t,i,r){const s=function oB(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(yd)?n[yd]:void 0;return"number"==typeof e?e>=0?255&e:aB:e}(t);if("function"==typeof s){if(!KT(e,n,i))return i&Dt.Host?fC(r,0,i):pC(e,t,i,r);try{let o;if(o=s(i),null!=o||i&Dt.Optional)return o;d_()}finally{nC()}}else if("number"==typeof s){let o=null,a=hC(n,e),l=-1,c=i&Dt.Host?e[15][5]:null;for((-1===a||i&Dt.SkipSelf)&&(l=-1===a?Op(n,e):e[a+8],-1!==l&&yC(i,!1)?(o=e[1],a=Dd(l),e=Ad(l,e)):a=-1);-1!==a;){const u=e[1];if(vC(s,a,u.data)){const d=sB(a,e,t,o,i,c);if(d!==gs)return d}l=e[a+8],-1!==l&&yC(i,e[1].data[a+8]===c)&&vC(s,a,e)?(o=u,a=Dd(l),e=Ad(l,e)):a=-1}}return r}function sB(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],u=Fp(a,o,t,null==i?Po(a)&&Z_:i!=o&&!!(3&a.type),r&Dt.Host&&s===a);return null!==u?ja(e,o,u,a):gs}function Fp(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const p=o[f];if(f<l&&t===p||f>=l&&p.type===t)return f}if(r){const f=o[l];if(f&&Wr(f)&&f.type===t)return l}return null}function ja(n,e,t,i){let r=n[t];const s=e.data;if(function YU(n){return n instanceof Cd}(r)){const o=r;o.resolving&&function H3(n,e){throw e&&e.join(" > "),new te(-200,n)}(function Gt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():lt(n)}(s[t]));const a=Pp(o.canSeeViewProviders);o.resolving=!0;const c=o.injectImpl?ji(o.injectImpl):null;KT(n,i,Dt.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function qU(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=FT(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}r&&(t.preOrderHooks??=[]).push(0-n,r),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==c&&ji(c),Pp(a),o.resolving=!1,nC()}}return r}function vC(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function yC(n,e){return!(n&Dt.Self||n&Dt.Host&&e)}class Sn{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return gC(this._tNode,this._lView,e,hp(i),t)}}function aB(){return new Sn(xt(),U())}function yc(n){return Us(()=>{const e=n.prototype.constructor,t=e[Bs]||Q_(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Bs]||Q_(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Q_(n){return sp(n)?()=>{const e=Q_(et(n));return e&&e()}:Na(n)}function _C(n){const e=n[1],t=e.type;return 2===t?e.declTNode:1===t?n[5]:null}function EC(n,e=null,t=null,i){const r=SC(n,e,t,i);return r.resolveInjectorInitializers(),r}function SC(n,e=null,t=null,i,r=new Set){const s=[t||Bt,bT(n)];return i=i||("object"==typeof n?void 0:jn(n)),new La(s,e||yp(),i||null,r)}class Pn{static THROW_IF_NOT_FOUND=_d;static NULL=new gp;static create(e,t){if(Array.isArray(e))return EC({name:""},t,e,"");{const i=e.name??"";return EC({name:i},e.parent,e.providers,i)}}static \u0275prov=xe({token:Pn,providedIn:"any",factory:()=>_e(wT)});static __NG_ELEMENT_ID__=-1}new oe("").__NG_ELEMENT_ID__=n=>{const e=xt();if(null===e)throw new te(204,!1);if(2&e.type)return e.value;if(n&Dt.Optional)return null;throw new te(204,!1)};const TC=!1;let Fo=(()=>class n{static __NG_ELEMENT_ID__=vB;static __NG_ENV_ID__=t=>t})();class CC extends Fo{_lView;constructor(e){super(),this._lView=e}onDestroy(e){return Tp(this._lView,e),()=>function O_(n,e){if(null===n[21])return;const t=n[21].indexOf(e);-1!==t&&n[21].splice(t,1)}(this._lView,e)}}function vB(){return new CC(U())}class qs{}const Rd=new oe("",{providedIn:"root",factory:()=>!1}),DC=new oe(""),t0=new oe("");let ms=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new Cr(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=xe({token:n,providedIn:"root",factory:()=>new n})}return n})();const Xn=class _B extends ii{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,CT()&&(this.destroyRef=W(Fo,{optional:!0})??void 0,this.pendingTasks=W(ms,{optional:!0})??void 0)}emit(e){const t=ht(null);try{super.next(e)}finally{ht(t)}}subscribe(e,t,i){let r=e,s=t||(()=>null),o=i;if(e&&"object"==typeof e){const l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=this.wrapInTimeout(s),r&&(r=this.wrapInTimeout(r)),o&&(o=this.wrapInTimeout(o)));const a=super.subscribe({next:r,error:s,complete:o});return e instanceof Ut&&e.add(a),a}wrapInTimeout(e){return t=>{const i=this.pendingTasks?.add();setTimeout(()=>{e(t),void 0!==i&&this.pendingTasks?.remove(i)})}}};function Nd(...n){}function AC(n){let e,t;function i(){n=Nd;try{void 0!==t&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(t),void 0!==e&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),i()}),"function"==typeof requestAnimationFrame&&(t=requestAnimationFrame(()=>{n(),i()})),()=>i()}function IC(n){return queueMicrotask(()=>n()),()=>{n=Nd}}const n0="isAngularZone",Up=n0+"_ID";let xB=0;class Ot{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Xn(!1);onMicrotaskEmpty=new Xn(!1);onStable=new Xn(!1);onError=new Xn(!1);constructor(e){const{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:s=TC}=e;if(typeof Zone>"u")throw new te(908,!1);Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&i,o.shouldCoalesceRunChangeDetection=r,o.callbackScheduled=!1,o.scheduleInRootZone=s,function MB(n){const e=()=>{!function bB(n){function e(){AC(()=>{n.callbackScheduled=!1,s0(n),n.isCheckStableRunning=!0,r0(n),n.isCheckStableRunning=!1})}n.isCheckStableRunning||n.callbackScheduled||(n.callbackScheduled=!0,n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),s0(n))}(n)},t=xB++;n._inner=n._inner.fork({name:"angular",properties:{[n0]:!0,[Up]:t,[Up+t]:!0},onInvokeTask:(i,r,s,o,a,l)=>{if(function EB(n){return PC(n,"__ignore_ng_zone__")}(l))return i.invokeTask(s,o,a,l);try{return RC(n),i.invokeTask(s,o,a,l)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&e(),NC(n)}},onInvoke:(i,r,s,o,a,l,c)=>{try{return RC(n),i.invoke(s,o,a,l,c)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!function SB(n){return PC(n,"__scheduler_tick__")}(l)&&e(),NC(n)}},onHasTask:(i,r,s,o)=>{i.hasTask(s,o),r===s&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,s0(n),r0(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(i,r,s,o)=>(i.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get(n0)}static assertInAngularZone(){if(!Ot.isInAngularZone())throw new te(909,!1)}static assertNotInAngularZone(){if(Ot.isInAngularZone())throw new te(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,wB,Nd,Nd);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const wB={};function r0(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function s0(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&!0===n.callbackScheduled)}function RC(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function NC(n){n._nesting--,r0(n)}class o0{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Xn;onMicrotaskEmpty=new Xn;onStable=new Xn;onError=new Xn;run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}function PC(n,e){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0]?.data?.[e]}class vs{_console=console;handleError(e){this._console.error("ERROR",e)}}const CB=new oe("",{providedIn:"root",factory:()=>{const n=W(Ot),e=W(vs);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function OC(n,e){return aT(n,e)}const AB=(OC.required=function DB(n){return aT(rp,n)},OC);function IB(){return _c(xt(),U())}function _c(n,e){return new ys(_i(n,e))}let ys=(()=>class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=IB})();function FC(n){return n instanceof ys?n.nativeElement:n}const kC=new Set;function oi(n){kC.has(n)||(kC.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function RB(){return this._results[Symbol.iterator]()}class NB{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new ii}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;const i=function $i(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function tU(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=RB}function Ld(n){return!(128&~n.flags)}var Vp=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Vp||{});const zp=new Map;let LB=0;function l0(n){zp.delete(n[19])}const Hp="__ngContext__";function xi(n,e){xn(e)?(n[Hp]=e[19],function FB(n){zp.set(n[19],n)}(e)):n[Hp]=e}function YC(n){return JC(n[12])}function ZC(n){return JC(n[4])}function JC(n){for(;null!==n&&!qn(n);)n=n[4];return n}let d0;const Wa=new oe("",{providedIn:"root",factory:()=>eV}),eV="ng",h0=new oe(""),ko=new oe("",{providedIn:"platform",factory:()=>"unknown"}),sD=new oe("",{providedIn:"root",factory:()=>function _s(){if(void 0!==d0)return d0;if(typeof document<"u")return document;throw new te(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null}),cD=new oe("",{providedIn:"root",factory:()=>!1});var M0=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(M0||{});const bc=new oe("");var Mc=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Mc||{});let E0=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=xe({token:n,providedIn:"root",factory:()=>new n})}return n})();const fD=[Mc.EarlyRead,Mc.Write,Mc.MixedReadWrite,Mc.Read];let pD=(()=>{class n{ngZone=W(Ot);scheduler=W(qs);errorHandler=W(vs,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){W(bc,{optional:!0})}execute(){this.executing=!0;for(const t of fD)for(const i of this.sequences)if(!i.erroredOrDestroyed&&i.hooks[t])try{i.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>i.hooks[t](i.pipelinedValue),i.snapshot))}catch(r){i.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(const t of this.sequences)t.afterRun(),t.once&&(this.sequences.delete(t),t.destroy());for(const t of this.deferredRegistrations)this.sequences.add(t);this.deferredRegistrations.size>0&&this.scheduler.notify(8),this.deferredRegistrations.clear()}register(t){this.executing?this.deferredRegistrations.add(t):(this.sequences.add(t),this.scheduler.notify(7))}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(M0.AFTER_NEXT_RENDER,t):t()}static \u0275prov=xe({token:n,providedIn:"root",factory:()=>new n})}return n})();class gD{impl;hooks;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,i,r,s=null){this.impl=e,this.hooks=t,this.once=i,this.snapshot=s,this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.()}}function Ud(n,e){!e?.injector&&function lc(n){if(!CT())throw new te(-203,!1)}();const t=e?.injector??W(Pn);return oi("NgAfterNextRender"),function mD(n,e,t,i){const r=e.get(E0);r.impl??=e.get(pD);const s=e.get(bc,null,{optional:!0}),o=t?.phase??Mc.MixedReadWrite,a=!0!==t?.manualCleanup?e.get(Fo):null,l=new gD(r.impl,function oV(n,e){if(n instanceof Function){const t=[void 0,void 0,void 0,void 0];return t[e]=n,t}return[n.earlyRead,n.write,n.mixedReadWrite,n.read]}(n,o),i,a,s?.snapshot(null));return r.impl.register(l),l}(n,t,e,!0)}function UD(n,e){const t=n.contentQueries;if(null!==t){const i=ht(null);try{for(let r=0;r<t.length;r+=2){const o=t[r+1];if(-1!==o){const a=n.data[o];Ap(t[r]),a.contentQueries(2,e[o],o)}}}finally{ht(i)}}}function k0(n,e,t){Ap(0);const i=ht(null);try{e(n,t)}finally{ht(i)}}function U0(n,e,t){if(A_(e)){const i=ht(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{ht(i)}}}var Pr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Pr||{});let ng,ig;function Rc(n){return function B0(){if(void 0===ng&&(ng=null,hn.trustedTypes))try{ng=hn.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return ng}()?.createHTML(n)||n}function zD(n){return function V0(){if(void 0===ig&&(ig=null,hn.trustedTypes))try{ig=hn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return ig}()?.createScriptURL(n)||n}class Ya{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${sT})`}}class HV extends Ya{getTypeName(){return"HTML"}}class GV extends Ya{getTypeName(){return"Style"}}class jV extends Ya{getTypeName(){return"Script"}}class $V extends Ya{getTypeName(){return"URL"}}class WV extends Ya{getTypeName(){return"ResourceURL"}}function dr(n){return n instanceof Ya?n.changingThisBreaksApplicationSecurity:n}function xs(n,e){const t=function qV(n){return n instanceof Ya&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${sT})`)}return t===e}class QV{inertDocumentHelper;constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(Rc(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.firstChild?.remove(),t)}catch{return null}}}class ez{defaultDoc;inertDocument;constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=Rc(e),t}}const nz=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function rg(n){return(n=String(n)).match(nz)?n:"unsafe:"+n}function Xs(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function qd(...n){const e={};for(const t of n)for(const i in t)t.hasOwnProperty(i)&&(e[i]=!0);return e}const GD=Xs("area,br,col,hr,img,wbr"),jD=Xs("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),$D=Xs("rp,rt"),z0=qd(GD,qd(jD,Xs("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),qd($D,Xs("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),qd($D,jD)),H0=Xs("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),WD=qd(H0,Xs("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Xs("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),iz=Xs("script,style,template");class rz{sanitizedSomething=!1;buf=[];sanitizeChildren(e){let t=e.firstChild,i=!0,r=[];for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)r.push(t),t=az(t);else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let s=oz(t);if(s){t=s;break}t=r.pop()}return this.buf.join("")}startElement(e){const t=qD(e).toLowerCase();if(!z0.hasOwnProperty(t))return this.sanitizedSomething=!0,!iz.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,a=o.toLowerCase();if(!WD.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;H0[a]&&(l=rg(l)),this.buf.push(" ",o,'="',YD(l),'"')}return this.buf.push(">"),!0}endElement(e){const t=qD(e).toLowerCase();z0.hasOwnProperty(t)&&!GD.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(YD(e))}}function oz(n){const e=n.nextSibling;if(e&&n!==e.previousSibling)throw XD(e);return e}function az(n){const e=n.firstChild;if(e&&function sz(n,e){return(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}(n,e))throw XD(e);return e}function qD(n){const e=n.nodeName;return"string"==typeof e?e:"FORM"}function XD(n){return new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`)}const lz=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,cz=/([^\#-~ |!])/g;function YD(n){return n.replace(/&/g,"&amp;").replace(lz,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(cz,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let sg;function ZD(n,e){let t=null;try{sg=sg||function HD(n){const e=new ez(n);return function tz(){try{return!!(new window.DOMParser).parseFromString(Rc(""),"text/html")}catch{return!1}}()?new QV(e):e}(n);let i=e?String(e):"";t=sg.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=t.innerHTML,t=sg.getInertBodyElement(i)}while(i!==s);return Rc((new rz).sanitizeChildren(G0(t)||t))}finally{if(t){const i=G0(t)||t;for(;i.firstChild;)i.firstChild.remove()}}}function G0(n){return"content"in n&&function uz(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var Xi=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Xi||{});function zo(n){const e=Xd();return e?e.sanitize(Xi.URL,n)||"":xs(n,"URL")?dr(n):rg(lt(n))}function j0(n){const e=Xd();if(e)return zD(e.sanitize(Xi.RESOURCE_URL,n)||"");if(xs(n,"ResourceURL"))return zD(dr(n));throw new te(904,!1)}function Xd(){const n=U();return n&&n[10].sanitizer}function hr(n){return n instanceof Function?n():n}var Ho=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Ho||{});function Iz(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const oA="ng-template";function Rz(n,e,t,i){let r=0;if(i){for(;r<e.length&&"string"==typeof e[r];r+=2)if("class"===e[r]&&-1!==Iz(e[r+1].toLowerCase(),t,0))return!0}else if(q0(n))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&"string"==typeof(s=e[r]);)if(s.toLowerCase()===t)return!0}return!1}function q0(n){return 4===n.type&&n.value!==oA}function Nz(n,e,t){return e===(4!==n.type||t?n.value:oA)}function Pz(n,e,t){let i=4;const r=n.attrs,s=null!==r?function Fz(n){for(let e=0;e<n.length;e++)if(aC(n[e]))return e;return n.length}(r):0;let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!Nz(n,l,t)||""===l&&1===e.length){if(Xr(i))return!1;o=!0}}else if(8&i){if(null===r||!Rz(n,r,l,t)){if(Xr(i))return!1;o=!0}}else{const c=e[++a],u=Lz(l,r,q0(n),t);if(-1===u){if(Xr(i))return!1;o=!0;continue}if(""!==c){let d;if(d=u>s?"":r[u+1].toLowerCase(),2&i&&c!==d){if(Xr(i))return!1;o=!0}}}}else{if(!o&&!Xr(i)&&!Xr(l))return!1;if(o&&Xr(l))continue;o=!1,i=l|1&i}}return Xr(i)||o}function Xr(n){return!(1&n)}function Lz(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function kz(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function aA(n,e,t=!1){for(let i=0;i<e.length;i++)if(Pz(n,e[i],t))return!0;return!1}function Uz(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function lA(n,e){return n?":not("+e.trim()+")":e}function Bz(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Xr(o)&&(e+=lA(s,r),r=""),i=o,s=s||!Xr(i);t++}return""!==r&&(e+=lA(s,r)),e}const ct={};function Te(n=1){cA(tt(),U(),fi()+n,!1)}function cA(n,e,t,i){if(!i)if(3&~e[2]){const s=n.preOrderHooks;null!==s&&Np(e,s,0,t)}else{const s=n.preOrderCheckHooks;null!==s&&Rp(e,s,t)}Ha(t)}function Be(n,e=Dt.Default){const t=U();return null===t?_e(n,e):gC(xt(),t,et(n),e)}function dA(n,e,t,i,r,s){const o=ht(null);try{let a=null;r&Ho.SignalBased&&(a=e[i][kn]),null!==a&&void 0!==a.transformFn&&(s=a.transformFn(s)),r&Ho.HasDecoratorInputTransform&&(s=n.inputTransforms[i].call(e,s)),null!==n.setInput?n.setInput(e,a,s,t,i):OT(e,a,i,s)}finally{ht(o)}}function lg(n,e,t){return n.createElement(e,t)}function Za(n,e,t,i,r){n.insertBefore(e,t,i,r)}function fA(n,e,t){n.appendChild(e,t)}function pA(n,e,t,i,r){null!==i?Za(n,e,t,i,r):fA(n,e,t)}function Zd(n,e,t,i,r,s,o,a,l,c,u){const d=e.blueprint.slice();return d[0]=r,d[2]=1228|i,(null!==c||n&&2048&n[2])&&(d[2]|=2048),zT(d),d[3]=d[14]=n,d[8]=t,d[10]=o||n&&n[10],d[11]=a||n&&n[11],d[9]=l||n&&n[9]||null,d[5]=s,d[19]=function OB(){return LB++}(),d[6]=u,d[20]=c,d[15]=2==e.type?n[15]:d,d}function Ja(n,e,t,i,r){let s=n.data[e];if(null===s)s=function Z0(n,e,t,i,r){const s=WT(),o=U_(),l=n.data[e]=function qz(n,e,t,i,r,s){let o=e?e.injectorIndex:-1,a=0;return za()&&(a|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,i,r),function VU(){return rt.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function Sd(){const n=rt.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return qr(s,!0),s}function Jd(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function mA(n,e,t,i,r){const s=fi(),o=2&i;try{Ha(-1),o&&e.length>25&&cA(n,e,25,!1),t(i,r)}finally{Ha(s)}}function J0(n,e,t){$T()&&(function e4(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Po(t)&&function a4(n,e,t){const i=_i(e,n),r=Q0(t),s=n[10].rendererFactory,o=cg(n,Zd(n,r,null,ix(t),i,e,null,s.createRenderer(i,t),null,null,null));n[e.index]=o}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Lp(t,e),xi(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=ja(e,n,a,t);xi(c,e),null!==o&&l4(0,a-r,c,l,0,o),Wr(l)&&(ur(t.index,e)[8]=ja(e,n,a,t))}}(n,e,t,_i(t,e)),!(64&~t.flags)&&wA(n,e,t))}function K0(n,e,t=_i){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function Q0(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=ex(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function ex(n,e,t,i,r,s,o,a,l,c,u){const d=25+i,h=d+r,f=function Hz(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:ct);return t}(d,h),p="function"==typeof c?c():c;return f[1]={type:n,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:u}}let vA=()=>null;function yA(n,e,t,i,r){for(let s in e){if(!e.hasOwnProperty(s))continue;const o=e[s];if(void 0===o)continue;i??={};let a,l=Ho.None;Array.isArray(o)?(a=o[0],l=o[1]):a=o;let c=s;if(null!==r){if(!r.hasOwnProperty(s))continue;c=r[s]}0===n?_A(i,t,c,a,l):_A(i,t,c,a)}return i}function _A(n,e,t,i,r){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,i):s=n[t]=[e,i],void 0!==r&&s.push(r)}function tx(n,e,t,i){if($T()){const r=null===i?null:{"":-1},s=function n4(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(aA(e,o.selectors,!1))if(i||(i=[]),Wr(o))if(null!==o.findHostDirectiveDefs){const a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),i.unshift(...a,o),nx(n,e,a.length)}else i.unshift(o),nx(n,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,i,r),i.push(o)}return null===i?null:[i,r]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&xA(n,e,t,o,r,a),r&&function i4(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new te(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=vc(t.mergedAttrs,t.attrs)}function xA(n,e,t,i,r,s){for(let c=0;c<i.length;c++)K_(Lp(t,e),n,i[c].type);!function s4(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let c=0;c<i.length;c++){const u=i[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=Jd(n,e,i.length,null);for(let c=0;c<i.length;c++){const u=i[c];t.mergedAttrs=vc(t.mergedAttrs,u.hostAttrs),o4(n,t,e,l,u),r4(l,u,r),null!==u.contentQueries&&(t.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(t.flags|=64);const d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}!function Xz(n,e,t){const r=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,c=null;for(let u=e.directiveStart;u<r;u++){const d=s[u],h=t?t.get(d):null,p=h?h.outputs:null;l=yA(0,d.inputs,u,l,h?h.inputs:null),c=yA(1,d.outputs,u,c,p);const v=null===l||null===o||q0(e)?null:c4(l,u,o);a.push(v)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}(n,t,s)}function wA(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,o=function HU(){return rt.lFrame.currentDirectiveIndex}();try{Ha(s);for(let a=i;a<r;a++){const l=n.data[a],c=e[a];V_(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&t4(l,c)}}finally{Ha(-1),V_(o)}}function t4(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function nx(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function r4(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Wr(e)&&(t[""]=n)}}function o4(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=Na(r.type)),o=new Cd(s,Wr(r),Be);n.blueprint[i]=o,t[i]=o,function Kz(n,e,t,i,r){const s=r.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function Qz(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,i,s)}}(n,e,i,Jd(n,t,r.hostVars,ct),r)}function ix(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function ws(n,e,t,i,r,s){const o=_i(n,e);!function rx(n,e,t,i,r,s,o){if(null==s)n.removeAttribute(e,r,t);else{const a=null==o?lt(s):o(s,i||"",r);n.setAttribute(e,r,a,t)}}(e[11],o,s,n.value,t,i,r)}function l4(n,e,t,i,r,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)dA(i,t,o[a++],o[a++],o[a++],o[a++])}function c4(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){i.push(s,o[a+1],o[a+2],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function bA(n,e,t,i){return[n,!0,0,e,null,i,null,t,null,null]}function cg(n,e){return n[12]?n[13][4]=e:n[12]=e,n[13]=e,e}function ug(n,e){const t=n[9],i=t?t.get(vs,null):null;i&&i.handleError(e)}function sx(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=t[s++];dA(n.data[o],e[o],i,a,l,r)}}function u4(n,e){const t=ur(e,n),i=t[1];!function d4(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(i,t);const r=t[0];null!==r&&null===t[6]&&(t[6]=null),dg(i,t,t[8])}function dg(n,e,t){G_(e);try{const i=n.viewQuery;null!==i&&k0(1,i,t);const r=n.template;null!==r&&mA(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[18]?.finishViewCreation(n),n.staticContentQueries&&UD(n,e),n.staticViewQueries&&k0(2,n.viewQuery,t);const s=n.components;null!==s&&function h4(n,e){for(let t=0;t<e.length;t++)u4(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,j_()}}var Go=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Go||{});function ax(n,e){return undefined(n,e)}function Pc(n,e,t,i,r){if(null!=i){let s,o=!1;qn(i)?s=i:xn(i)&&(o=!0,i=i[0]);const a=Pt(i);0===n&&null!==t?null==r?fA(e,t,a):Za(e,t,a,r||null,!0):1===n&&null!==t?Za(e,t,a,r||null,!0):2===n?function Yd(n,e,t){n.removeChild(null,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function x4(n,e,t,i,r){const s=t[7];s!==Pt(t)&&Pc(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];fg(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function SA(n,e){e[10].changeDetectionScheduler?.notify(10),fg(n,e,e[11],2,null,null)}function TA(n,e){const t=n[9],i=e[3];(xn(i)||e[15]!==i[3][15])&&(n[2]|=2),null===t?n[9]=[e]:t.push(e)}function lx(n,e){const t=n[9],i=t.indexOf(e);t.splice(i,1)}function Kd(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[16];null!==r&&r!==n&&lx(r,i),e>0&&(n[t-1][4]=i[4]);const s=fp(n,10+e);!function EA(n,e){SA(n,e),e[0]=null,e[5]=null}(i[1],i);const o=s[18];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function Qd(n,e){if(Lo(e))return;const t=e[11];t.destroyNode&&fg(n,e,t,3,null,null),function g4(n){let e=n[12];if(!e)return cx(n[1],n);for(;e;){let t=null;if(xn(e))t=e[12];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)xn(e)&&cx(e[1],e),e=e[3];null===e&&(e=n),xn(e)&&cx(e[1],e),t=e&&e[4]}e=t}}(e)}function cx(n,e){if(Lo(e))return;const t=ht(null);try{e[2]&=-129,e[2]|=256,e[24]&&Ma(e[24]),function y4(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof Cd)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function v4(n,e){const t=n.cleanup,i=e[7];if(null!==t)for(let o=0;o<t.length-1;o+=2)if("string"==typeof t[o]){const a=t[o+3];a>=0?i[a]():i[-a].unsubscribe(),o+=2}else t[o].call(i[t[o+1]]);null!==i&&(e[7]=null);const r=e[21];if(null!==r){e[21]=null;for(let o=0;o<r.length;o++)(0,r[o])()}const s=e[23];if(null!==s){e[23]=null;for(const o of s)o.destroy()}}(n,e),1===e[1].type&&e[11].destroy();const i=e[16];if(null!==i&&qn(e[3])){i!==e[3]&&lx(i,e);const r=e[18];null!==r&&r.detachView(n)}l0(e)}finally{ht(t)}}function ux(n,e,t){return function CA(n,e,t){let i=e;for(;null!==i&&168&i.type;)i=(e=i).parent;if(null===i)return t[0];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Pr.None||s===Pr.Emulated)return null}return _i(i,t)}}(n,e.parent,t)}function DA(n,e,t){return IA(n,e,t)}let IA=function AA(n,e,t){return 40&n.type?_i(n,t):null};function hg(n,e,t,i){const r=ux(n,i,e),s=e[11],a=DA(i.parent||e[5],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)pA(s,r,t[l],a,!1);else pA(s,r,t,a,!1)}function Ka(n,e){if(null!==e){const t=e.type;if(3&t)return _i(e,n);if(4&t)return hx(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Ka(n,i);{const r=n[e.index];return qn(r)?hx(-1,r):Pt(r)}}if(128&t)return Ka(n,e.next);if(32&t)return ax(e,n)()||Pt(n[e.index]);{const i=NA(n,e);return null!==i?Array.isArray(i)?i[0]:Ka(Gs(n[15]),i):Ka(n,e.next)}}return null}function NA(n,e){return null!==e?n[15][5].projection[e.projection]:null}function hx(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return Ka(i,r)}return e[7]}function fx(n,e,t,i,r,s,o){for(;null!=t;){if(128===t.type){t=t.next;continue}const a=i[t.index],l=t.type;if(o&&0===e&&(a&&xi(Pt(a),i),t.flags|=2),32&~t.flags)if(8&l)fx(n,e,t.child,i,r,s,!1),Pc(e,n,r,a,s);else if(32&l){const c=ax(t,i);let u;for(;u=c();)Pc(e,n,r,u,s);Pc(e,n,r,a,s)}else 16&l?PA(n,e,i,t,r,s):Pc(e,n,r,a,s);t=o?t.projectionNext:t.next}}function fg(n,e,t,i,r,s){fx(t,i,n.firstChild,e,r,s,!1)}function PA(n,e,t,i,r,s){const o=t[15],l=o[5].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Pc(e,n,r,l[c],s);else{let c=l;const u=o[3];Ld(i)&&(c.flags|=128),fx(n,e,c,u,r,s,!0)}}function LA(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&function QU(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],o=t[i++],a=t[i++];n.setAttribute(e,o,a,s)}else{const s=r,o=t[++i];lC(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),i++}}}(n,e,i),null!==r&&function M4(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}(n,e,r),null!==s&&function b4(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}function Lc(n,e,t,i){const r=ht(null);try{const s=e.tView,l=Zd(n,s,t,4096&n[2]?4096:16,null,e,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);l[16]=n[e.index];const u=n[18];return null!==u&&(l[18]=u.createEmbeddedView(s)),dg(s,l,t),l}finally{ht(r)}}function Qa(n,e){return!e||null===e.firstChild||Ld(n)}function Oc(n,e,t,i=!0){const r=e[1];if(function m4(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],yT(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[16];null!==o&&t!==o&&TA(o,e);const a=e[18];null!==a&&a.insertView(n),L_(e),e[2]|=128}(r,e,n,t),i){const o=hx(t,n),a=e[11],l=a.parentNode(n[7]);null!==l&&function p4(n,e,t,i,r,s){i[0]=r,i[5]=e,fg(n,i,t,1,r,s)}(r,n[5],a,e,l,o)}const s=e[6];null!==s&&null!==s.firstChild&&(s.firstChild=null)}function Fc(n,e,t,i,r=!1){for(;null!==t;){if(128===t.type){t=r?t.projectionNext:t.next;continue}const s=e[t.index];null!==s&&i.push(Pt(s)),qn(s)&&gx(s,i);const o=t.type;if(8&o)Fc(n,e,t.child,i);else if(32&o){const a=ax(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=NA(e,t);if(Array.isArray(a))i.push(...a);else{const l=Gs(e[15]);Fc(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}function gx(n,e){for(let t=10;t<n.length;t++){const i=n[t],r=i[1].firstChild;null!==r&&Fc(i[1],i,r,e)}n[7]!==n[0]&&e.push(n[7])}let FA=[];const C4={...Fs,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Ed(n.lView)},consumerOnSignalRead(){this.lView[24]=this}},A4={...Fs,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Gs(n.lView);for(;e&&!kA(e[1]);)e=Gs(e);e&&P_(e)},consumerOnSignalRead(){this.lView[24]=this}};function kA(n){return 2!==n.type}function UA(n){if(null===n[23])return;let e=!0;for(;e;){let t=!1;for(const i of n[23])i.dirty&&(t=!0,null===i.zone||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));e=t&&!!(8192&n[2])}}function pg(n,e=!0,t=0){const r=n[10].rendererFactory;r.begin?.();try{!function R4(n,e){const t=YT();try{Dp(!0),mx(n,e);let i=0;for(;Sp(n);){if(100===i)throw new te(103,!1);i++,mx(n,1)}}finally{Dp(t)}}(n,t)}catch(o){throw e&&ug(n,o),o}finally{r.end?.()}}function VA(n,e,t,i){if(Lo(e))return;const r=e[2];G_(e);let a=!0,l=null,c=null;kA(n)?(c=function E4(n){return n[24]??function S4(n){const e=FA.pop()??Object.create(C4);return e.lView=n,e}(n)}(e),l=cs(c)):null===function dd(){return yn}()?(a=!1,c=function D4(n){const e=n[24]??Object.create(A4);return e.lView=n,e}(e),l=cs(c)):e[24]&&(Ma(e[24]),e[24]=null);try{zT(e),function ZT(n){return rt.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&mA(n,e,t,2,i);const u=!(3&~r);if(u){const f=n.preOrderCheckHooks;null!==f&&Rp(e,f,null)}else{const f=n.preOrderHooks;null!==f&&Np(e,f,0,null),$_(e,0)}if(function N4(n){for(let e=YC(n);null!==e;e=ZC(e)){if(!(2&e[2]))continue;const t=e[9];for(let i=0;i<t.length;i++)P_(t[i])}}(e),UA(e),zA(e,0),null!==n.contentQueries&&UD(n,e),u){const f=n.contentCheckHooks;null!==f&&Rp(e,f)}else{const f=n.contentHooks;null!==f&&Np(e,f,1),$_(e,1)}!function L4(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)Ha(~r);else{const s=r,o=t[++i],a=t[++i];zU(o,s);const l=e[s];a(2,l)}}}finally{Ha(-1)}}(n,e);const d=n.components;null!==d&&GA(e,d,0);const h=n.viewQuery;if(null!==h&&k0(2,h,i),u){const f=n.viewCheckHooks;null!==f&&Rp(e,f)}else{const f=n.viewHooks;null!==f&&Np(e,f,2),$_(e,2)}if(!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[22]){for(const f of e[22])f();e[22]=null}e[2]&=-73}catch(u){throw Ed(e),u}finally{null!==c&&(us(c,l),a&&function T4(n){n.lView[24]!==n&&(n.lView=null,FA.push(n))}(c)),j_()}}function zA(n,e){for(let t=YC(n);null!==t;t=ZC(t))for(let i=10;i<t.length;i++)HA(t[i],e)}function P4(n,e,t){HA(ur(e,n),t)}function HA(n,e){N_(n)&&mx(n,e)}function mx(n,e){const i=n[1],r=n[2],s=n[24];let o=!!(0===e&&16&r);if(o||=!!(64&r&&0===e),o||=!!(1024&r),o||=!(!s?.dirty||!Tr(s)),o||=!1,s&&(s.dirty=!1),n[2]&=-9217,o)VA(i,n,i.template,n[8]);else if(8192&r){UA(n),zA(n,1);const a=i.components;null!==a&&GA(n,a,1)}}function GA(n,e,t){for(let i=0;i<e.length;i++)P4(n,e[i],t)}function eh(n,e){const t=YT()?64:1088;for(n[10].changeDetectionScheduler?.notify(e);n;){n[2]|=t;const i=Gs(n);if(Md(n)&&!i)return n;n=i}return null}class th{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){const e=this._lView,t=e[1];return Fc(t,e,t.firstChild,[])}constructor(e,t,i=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=i}get context(){return this._lView[8]}get dirty(){return!!(9280&this._lView[2])||!!this._lView[24]?.dirty}set context(e){this._lView[8]=e}get destroyed(){return Lo(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(qn(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Kd(e,i),fp(t,i))}this._attachedToViewContainer=!1}Qd(this._lView[1],this._lView)}onDestroy(e){Tp(this._lView,e)}markForCheck(){eh(this._cdRefInjectingView||this._lView,4)}markForRefresh(){P_(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){L_(this._lView),this._lView[2]|=128}detectChanges(){this._lView[2]|=1024,pg(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new te(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const e=Md(this._lView),t=this._lView[16];null!==t&&!e&&lx(t,this._lView),SA(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new te(902,!1);this._appRef=e;const t=Md(this._lView),i=this._lView[16];null!==i&&!t&&TA(i,this._lView),L_(this._lView)}}let Ys=(()=>class n{static __NG_ELEMENT_ID__=k4})();const O4=Ys,F4=class extends O4{_declarationLView;_declarationTContainer;elementRef;constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,i){const r=Lc(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:i});return new th(r)}};function k4(){return gg(xt(),U())}function gg(n,e){return 4&n.type?new F4(e,n,_c(n,e)):null}class RH{}class d1{}class NH{resolveComponentFactory(e){throw Error(`No component factory found for ${jn(e)}.`)}}class wg{static NULL=new NH}class Dx{}let bg=(()=>class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>function PH(){const n=U(),t=ur(xt().index,n);return(xn(t)?t:n)[11]}()})(),LH=(()=>{class n{static \u0275prov=xe({token:n,providedIn:"root",factory:()=>null})}return n})();function Eg(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=i_(r,a):2==s&&(i=i_(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}class p1 extends wg{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=_t(e);return new dh(t,this.ngModule)}}function g1(n,e){const t=[];for(const i in n){if(!n.hasOwnProperty(i))continue;const r=n[i];if(void 0===r)continue;const s=Array.isArray(r),o=s?r[0]:r;t.push(e?{propName:o,templateName:i,isSignal:!!((s?r[1]:Ho.None)&Ho.SignalBased)}:{propName:o,templateName:i})}return t}class dh extends d1{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;get inputs(){const e=this.componentDef,t=e.inputTransforms,i=g1(e.inputs,!0);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return g1(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Vz(n){return n.map(Bz).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){const s=ht(null);try{let o=(r=r||this.ngModule)instanceof Ci?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const a=o?new Ga(e,o):e,l=a.get(Dx,null);if(null===l)throw new te(407,!1);const d={rendererFactory:l,sanitizer:a.get(LH,null),changeDetectionScheduler:a.get(qs,null)},h=l.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",p=i?function Gz(n,e,t,i){const s=i.get(cD,!1)||t===Pr.ShadowDom,o=n.selectRootElement(e,s);return function jz(n){vA(n)}(o),o}(h,i,this.componentDef.encapsulation,a):lg(h,f,function kH(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(f));let v=512;this.componentDef.signals?v|=4096:this.componentDef.onPush||(v|=16);let m=null;null!==p&&(m=null);const g=ex(0,null,null,1,0,null,null,null,null,null,null),y=Zd(null,g,null,v,null,null,d,h,a,null,m);G_(y);let _,x,T=null;try{const E=this.componentDef;let C,R=null;E.findHostDirectiveDefs?(C=[],R=new Map,E.findHostDirectiveDefs(E,C,R),C.push(E)):C=[E];const M=function VH(n,e){const t=n[1];return n[25]=e,Ja(t,25,2,"#host",null)}(y,p),w=i?["ng-version","19.1.2"]:function UH(n){const{attrs:e,classes:t}=function zz(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!Xr(r))break;r=s}i++}return{attrs:e,classes:t}}(n),i=e;return t.length&&i.push(1,...t),i}(this.componentDef.selectors[0]);for(const N of C)M.mergedAttrs=vc(M.mergedAttrs,N.hostAttrs);M.mergedAttrs=vc(M.mergedAttrs,w),Eg(M,M.mergedAttrs,!0),p&&LA(h,p,M),T=function zH(n,e,t,i,r,s){const o=r[1];let a=null;null!==e&&(a=null);const l=s.rendererFactory.createRenderer(e,t),c=Zd(r,Q0(t),null,ix(t),r[n.index],n,s,l,null,null,a);return o.firstCreatePass&&nx(o,n,i.length-1),cg(r,c),r[n.index]=c}(M,p,E,C,y,d),x=Ba(g,25),void 0!==t&&function GH(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s&&s.length?Array.from(s):null)}}(M,this.ngContentSelectors,t),_=function HH(n,e,t,i,r,s){const o=xt(),a=r[1],l=_i(o,r);xA(a,r,o,t,null,i);for(let u=0;u<t.length;u++)xi(ja(r,a,o.directiveStart+u,o),r);wA(a,r,o),l&&xi(l,r);const c=ja(r,a,o.directiveStart+o.componentOffset,o);if(n[8]=r[8]=c,null!==s)for(const u of s)u(c,e);return U0(a,o,r),c}(T,E,C,R,y,[jH]),dg(g,y,null)}catch(E){throw null!==T&&l0(T),l0(y),E}finally{j_()}return new BH(this.componentType,_,_c(x,y),y,x)}finally{ht(s)}}}class BH extends RH{location;_rootLView;_tNode;instance;hostView;changeDetectorRef;componentType;previousInputValues=null;constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new th(r,void 0,!1),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;sx(s[1],s,r,e,t),this.previousInputValues.set(e,t),eh(ur(this._tNode.index,s),1)}}get injector(){return new Sn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function jH(){const n=xt();Ip(U()[1],n)}let fr=(()=>class n{static __NG_ELEMENT_ID__=$H})();function $H(){return y1(xt(),U())}const WH=fr,m1=class extends WH{_lContainer;_hostTNode;_hostLView;constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return _c(this._hostTNode,this._hostLView)}get injector(){return new Sn(this._hostTNode,this._hostLView)}get parentInjector(){const e=Op(this._hostTNode,this._hostLView);if(Y_(e)){const t=Ad(e,this._hostLView),i=Dd(e);return new Sn(t[1].data[i+8],t)}return new Sn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=v1(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,r,Qa(this._hostTNode,null)),a}createComponent(e,t,i,r,s){const o=e&&!function bd(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const p=t||{};a=p.index,i=p.injector,r=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}const l=o?e:new dh(_t(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule){const v=(o?c:this.parentInjector).get(Ci,null);v&&(s=v)}_t(l.componentType??{});const f=l.create(c,r,null,s);return this.insertImpl(f.hostView,a,Qa(this._hostTNode,null)),f}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,i){const r=e._lView;if(function DU(n){return qn(n[3])}(r)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const l=r[3],c=new m1(l,l[5],l[3]);c.detach(c.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;return Oc(o,r,s,i),e.attachToViewContainerRef(),yT(Rx(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=v1(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Kd(this._lContainer,t);i&&(fp(Rx(this._lContainer),t),Qd(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=Kd(this._lContainer,t);return i&&null!=fp(Rx(this._lContainer),t)?new th(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function v1(n){return n[8]}function Rx(n){return n[8]||(n[8]=[])}function y1(n,e){let t;const i=e[n.index];return qn(i)?t=i:(t=bA(i,e,null,n),e[n.index]=t,cg(e,t)),_1(t,e,n,i),new m1(t,n,e)}let _1=function w1(n,e,t,i){if(n[7])return;let r;r=8&t.type?Pt(i):function qH(n,e){const t=n[11],i=t.createComment(""),r=_i(e,n),s=t.parentNode(r);return Za(t,s,i,t.nextSibling(r),!1),i}(e,t),n[7]=r};class Px{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new Px(this.queryList)}setDirty(){this.queryList.setDirty()}}class Lx{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new Lx(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==Bx(e,t).matches&&this.queries[t].setDirty()}}class b1{flags;read;predicate;constructor(e,t,i=null){this.flags=t,this.read=i,this.predicate="string"==typeof e?function t5(n){return n.split(",").map(e=>e.trim())}(e):e}}class Ox{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new Ox(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Fx{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Fx(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1&~this.metadata.flags){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,JH(t,s)),this.matchTNodeWithReadOption(e,t,Fp(t,e,s,!1,!1))}else i===Ys?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Fp(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===ys||r===fr||r===Ys&&4&t.type)this.addMatch(t.index,-2);else{const s=Fp(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function JH(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function QH(n,e,t,i){return-1===t?function KH(n,e){return 11&n.type?_c(n,e):4&n.type?gg(n,e):null}(e,n):-2===t?function e5(n,e,t){return t===ys?_c(e,n):t===Ys?gg(e,n):t===fr?y1(e,n):void 0}(n,e,i):ja(n,n[1],t,e)}function M1(n,e,t,i){const r=e[18].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;null!==o&&l<o.length;l+=2){const c=o[l];a.push(c<0?null:QH(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function kx(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=M1(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let d=10;d<u.length;d++){const h=u[d];h[16]===h[3]&&kx(h[1],h,c,i)}if(null!==u[9]){const d=u[9];for(let h=0;h<d.length;h++){const f=d[h];kx(f[1],f,c,i)}}}}}return i}function S1(n,e,t){const i=tt();return i.firstCreatePass&&(function C1(n,e,t){null===n.queries&&(n.queries=new Ox),n.queries.track(new Fx(e,t))}(i,new b1(n,e,t),-1),!(2&~e)&&(i.staticViewQueries=!0)),function E1(n,e,t){const i=new NB(!(4&~t));return function AU(n,e,t,i){const r=GT(e);r.push(t),n.firstCreatePass&&jT(n).push(i,r.length-1)}(n,e,i,i.destroy),(e[18]??=new Lx).queries.push(new Px(i))-1}(i,U(),e)}function Bx(n,e){return n.queries.getByIndex(e)}function D1(n,e){const t=n[1],i=Bx(t,e);return i.crossesNgTemplate?kx(t,n,e,[]):M1(t,n,i,e)}class tl{}class B1{}class zx extends tl{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new p1(this);constructor(e,t,i,r=!0){super(),this.ngModuleType=e,this._parent=t;const s=vi(e);this._bootstrapComponents=hr(s.bootstrap),this._r3Injector=SC(e,t,[{provide:tl,useValue:this},{provide:wg,useValue:this.componentFactoryResolver},...i],jn(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Hx extends B1{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new zx(this.moduleType,e,[])}}class V1 extends tl{injector;componentFactoryResolver=new p1(this);instance=null;constructor(e){super();const t=new La([...e.providers,{provide:tl,useValue:this},{provide:wg,useValue:this.componentFactoryResolver}],e.parent||yp(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function Tg(n,e,t=null){return new V1({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let p5=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=x_(0,t.type),r=i.length>0?Tg([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=xe({token:n,providedIn:"environment",factory:()=>new n(_e(Ci))})}return n})();function Zs(n){return Us(()=>{const e=H1(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Vp.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(p5).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Pr.Emulated,styles:n.styles||Bt,_:null,schemas:n.schemas||null,tView:null,id:""};e.standalone&&oi("NgStandalone"),G1(t);const i=n.dependencies;return t.directiveDefs=Cg(i,!1),t.pipeDefs=Cg(i,!0),t.id=function y5(n){let e=0;const i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,"function"==typeof n.consts?"":n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(const s of i.join("|"))e=Math.imul(31,e)+s.charCodeAt(0)|0;return e+=2147483648,"c"+e}(t),t})}function g5(n){return _t(n)||$n(n)}function m5(n){return null!==n}function Vc(n){return Us(()=>({type:n.type,bootstrap:n.bootstrap||Bt,declarations:n.declarations||Bt,imports:n.imports||Bt,exports:n.exports||Bt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function z1(n,e){if(null==n)return ds;const t={};for(const i in n)if(n.hasOwnProperty(i)){const r=n[i];let s,o,a=Ho.None;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(t[s]=a!==Ho.None?[i,a]:i,e[s]=o):t[s]=i}return t}function Ri(n){return Us(()=>{const e=H1(n);return G1(e),e})}function li(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function H1(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||ds,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:!0===n.signals,selectors:n.selectors||Bt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:z1(n.inputs,e),outputs:z1(n.outputs),debugInfo:null}}function G1(n){n.features?.forEach(e=>e(n))}function Cg(n,e){if(!n)return null;const t=e?hi:g5;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(m5)}function Z1(n){const e=n.inputConfig,t={};for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];Array.isArray(r)&&r[3]&&(t[i]=r[3])}n.inputTransforms=t}function Ag(n){return!!function jx(n){return null!==n&&("function"==typeof n||"object"==typeof n)}(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function bs(n,e,t){return n[e]=t}function Tn(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function nl(n,e,t,i){const r=Tn(n,e,t);return Tn(n,e+1,i)||r}function ph(n,e,t,i,r,s,o,a,l,c){const u=t+25,d=e.firstCreatePass?function N5(n,e,t,i,r,s,o,a,l){const c=e.consts,u=Ja(e,n,4,o||null,a||null);tx(e,t,u,Rr(c,l)),Ip(e,u);const d=u.tView=ex(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,e,n,i,r,s,o,a,l):e.data[u];qr(d,!1);const h=J1(e,n,d,t);Td()&&hg(e,n,h,d),xi(h,n);const f=bA(h,n,h,d);return n[u]=f,cg(n,f),Mp(d)&&J0(e,n,d),null!=l&&K0(n,d,c),d}function ci(n,e,t,i,r,s,o,a){const l=U(),c=tt();return ph(l,c,n,e,t,i,r,Rr(c.consts,s),o,a),ci}let J1=function K1(n,e,t,i){return ps(!0),e[11].createComment("")};let sI=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const hI=new oe("");function Og(n){return!!n&&"function"==typeof n.then}function fI(n){return!!n&&"function"==typeof n.subscribe}const Fg=new oe("");let pI=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=W(Fg,{optional:!0})??[];injector=W(Pn);constructor(){}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const s=Ar(this.injector,r);if(Og(s))t.push(s);else if(fI(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Qx=(()=>{class n{static \u0275prov=xe({token:n,providedIn:"root",factory:()=>new gI})}return n})();class gI{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){const i=this.queues.get(e.zone);i.has(e)&&(i.delete(e),this.queuedEffectCount--)}enqueue(e){const t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);const i=this.queues.get(t);i.has(e)||(this.queuedEffectCount++,i.add(e))}flush(){for(;this.queuedEffectCount>0;)for(const[e,t]of this.queues)null===e?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(const t of e)e.delete(t),this.queuedEffectCount--,t.run()}}const jc=new oe("");let pr=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=W(CB);afterRenderManager=W(E0);zonelessEnabled=W(Rd);rootEffectScheduler=W(Qx);dirtyFlags=0;deferredDirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new ii;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=W(ms).hasPendingTasks.pipe(Ct(t=>!t));constructor(){W(bc,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=W(Ci);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){const r=t instanceof d1;if(!this._injector.get(pI).done)throw!r&&function Ro(n){const e=_t(n)||$n(n)||hi(n);return null!==e&&e.standalone}(t),new te(405,!1);let o;o=r?t:this._injector.get(wg).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function N8(n){return n.isBoundToModule}(o)?void 0:this._injector.get(tl),c=o.create(Pn.NULL,[],i||o.selector,a),u=c.location.nativeElement,d=c.injector.get(hI,null);return d?.registerApplication(u),c.onDestroy(()=>{this.detachView(c.hostView),kg(this.components,c),d?.unregisterApplication(u)}),this._loadComponent(c),c}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick=()=>{if(null!==this.tracingSnapshot){const i=this.tracingSnapshot;return this.tracingSnapshot=null,i.run(M0.CHANGE_DETECTION,this._tick),void i.dispose()}if(this._runningTick)throw new te(101,!1);const t=ht(null);try{this._runningTick=!0,this.synchronize()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1,ht(t),this.afterTick.next()}};synchronize(){null===this._rendererFactory&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Dx,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let t=0;for(;0!==this.dirtyFlags&&t++<10;)this.synchronizeOnce()}synchronizeOnce(){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,16&this.dirtyFlags&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),7&this.dirtyFlags){const t=!!(1&this.dirtyFlags);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i,notifyErrorHandler:r}of this.allViews)O8(i,r,t,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),23&this.dirtyFlags)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();8&this.dirtyFlags&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){this.allViews.some(({_lView:t})=>Sp(t))?this.dirtyFlags|=2:this.dirtyFlags&=-8}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;kg(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(jc,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>kg(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new te(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function kg(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function O8(n,e,t,i){(t||Sp(n))&&pg(n,e,t&&!i?0:1)}function iw(n,e,t,i){const r=U();return Tn(r,Nr(),e)&&(tt(),ws(Qt(),r,n,e,t,i)),iw}function qc(n,e,t,i,r,s){const a=nl(n,function js(){return rt.lFrame.bindingIndex}(),t,r);return $s(2),a?e+lt(t)+i+lt(r)+s:ct}function Ug(n,e){return n<<17|e<<2}function Yo(n){return n>>17&32767}function rw(n){return 2|n}function rl(n){return(131068&n)>>2}function sw(n,e){return-131069&n|e<<2}function ow(n){return 1|n}function NI(n,e,t,i){const r=n[t+1],s=null===e;let o=i?Yo(r):rl(r),a=!1;for(;0!==o&&(!1===a||s);){const c=n[o+1];_G(n[o],e)&&(a=!0,n[o+1]=i?ow(c):rw(c)),o=i?Yo(c):rl(c)}a&&(n[t+1]=i?rw(r):ow(r))}function _G(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&oc(n,e)>=0}function It(n,e,t){const i=U();return Tn(i,Nr(),e)&&function Yi(n,e,t,i,r,s,o,a){const l=_i(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(sx(n,t,u,i,r),Po(e)&&function Zz(n,e){const t=ur(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function Yz(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,s.setProperty(l,i,r))}(tt(),Qt(),i,n,e,i[11],t,!1),It}function aw(n,e,t,i,r){const o=r?"class":"style";sx(n,t,e.inputs[o],o,i)}function lw(n,e,t){return Yr(n,e,t,!1),lw}function cw(n,e){return Yr(n,e,null,!0),cw}function Yr(n,e,t,i){const r=U(),s=tt(),o=$s(2);s.firstUpdatePass&&function VI(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[fi()],o=function BI(n,e){return e>=n.expandoStartIndex}(n,t);(function jI(n,e){return!!(n.flags&(e?8:16))})(s,i)&&null===e&&!o&&(e=!1),e=function DG(n,e,t,i){const r=function z_(n){const e=rt.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=vh(t=uw(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=uw(r,n,e,t,i),null===s){let l=function AG(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==rl(i))return n[Yo(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=uw(null,n,e,l[1],i),l=vh(l,e.attrs,i),function IG(n,e,t,i){n[Yo(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function RG(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=vh(i,n[s].hostAttrs,t);return vh(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function vG(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Yo(o),l=rl(o);n[i]=t;let u,c=!1;if(Array.isArray(t)?(u=t[1],(null===u||oc(t,u)>0)&&(c=!0)):u=t,r)if(0!==l){const h=Yo(n[a+1]);n[i+1]=Ug(h,a),0!==h&&(n[h+1]=sw(n[h+1],i)),n[a+1]=function gG(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=Ug(a,0),0!==a&&(n[a+1]=sw(n[a+1],i)),a=i;else n[i+1]=Ug(l,0),0===a?a=i:n[l+1]=sw(n[l+1],i),l=i;c&&(n[i+1]=rw(n[i+1])),NI(n,u,i,!0),NI(n,u,i,!1),function yG(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&oc(s,e)>=0&&(t[i+1]=ow(t[i+1]))}(e,u,n,i,s),o=Ug(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}(s,n,o,i),e!==ct&&Tn(r,o,e)&&function HI(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1],u=function mG(n){return!(1&~n)}(c)?GI(l,e,t,r,rl(c),o):void 0;Bg(u)||(Bg(s)||function pG(n){return!(2&~n)}(c)&&(s=GI(l,null,t,r,a,o)),function w4(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:Go.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Go.Important),n.setStyle(t,i,r,s))}}(i,o,gc(fi(),t),r,s))}(s,s.data[fi()],r,r[11],n,r[o+1]=function OG(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=jn(dr(n)))),n}(e,t),i,o)}function uw(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=vh(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function vh(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),cr(n,o,!!t||e[++s]))}return void 0===n?null:n}function GI(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let h=t[r+1];h===ct&&(h=d?Bt:void 0);let f=d?y_(h,i):u===i?h:void 0;if(c&&!Bg(f)&&(f=y_(l,i)),Bg(f)&&(a=f,o))return a;const p=n[r+1];r=o?Yo(p):rl(p)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=y_(l,i))}return a}function Bg(n){return void 0!==n}function ae(n,e,t,i){const r=U(),s=tt(),o=25+n,a=r[11],l=s.firstCreatePass?function rj(n,e,t,i,r,s){const o=e.consts,l=Ja(e,n,2,i,Rr(o,r));return tx(e,t,l,Rr(o,s)),null!==l.attrs&&Eg(l,l.attrs,!1),null!==l.mergedAttrs&&Eg(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,e,t,i):s.data[o],c=XI(s,r,l,a,e,n);r[o]=c;const u=Mp(l);return qr(l,!0),LA(a,c,l),!function zc(n){return!(32&~n.flags)}(l)&&Td()&&hg(s,r,c,l),0===function IU(){return rt.lFrame.elementDepthCount}()&&xi(c,r),function RU(){rt.lFrame.elementDepthCount++}(),u&&(J0(s,r,l),U0(s,l,r)),null!==i&&K0(r,l),ae}function ue(){let n=xt();U_()?B_():(n=n.parent,qr(n,!1));const e=n;(function PU(n){return rt.skipHydrationRootTNode===n})(e)&&function kU(){rt.skipHydrationRootTNode=null}(),function NU(){rt.lFrame.elementDepthCount--}();const t=tt();return t.firstCreatePass&&(Ip(t,n),A_(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function JU(n){return!!(8&n.flags)}(e)&&aw(t,e,U(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function KU(n){return!!(16&n.flags)}(e)&&aw(t,e,U(),e.stylesWithoutHost,!1),ue}function $t(n,e,t,i){return ae(n,e,t,i),ue(),$t}let XI=(n,e,t,i,r,s)=>(ps(!0),lg(i,r,function iC(){return rt.lFrame.currentNamespace}()));const sl=void 0;var hj=["en",[["a","p"],["AM","PM"],sl],[["AM","PM"],sl,sl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],sl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],sl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",sl,"{1} 'at' {0}",sl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function dj(n){const t=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let tu={};function Ni(n){const e=function fj(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=eR(e);if(t)return t;const i=e.split("-")[0];if(t=eR(i),t)return t;if("en"===i)return hj;throw new te(701,!1)}function eR(n){return n in tu||(tu[n]=hn.ng&&hn.ng.common&&hn.ng.common.locales&&hn.ng.common.locales[n]),tu[n]}var cn=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(cn||{});const zg="en-US";let tR=zg;function Mh(n,e,t,i){const r=U(),s=tt(),o=xt();return function yw(n,e,t,i,r,s,o){const a=Mp(i),c=n.firstCreatePass&&jT(n),u=e[8],d=GT(e);let h=!0;if(3&i.type||o){const v=_i(i,e),m=o?o(v):v,g=d.length,y=o?x=>o(Pt(x[i.index])):i.index;let _=null;if(!o&&a&&(_=function t$(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==_)(_.__ngLastListenerFn__||_).__ngNextListenerFn__=s,_.__ngLastListenerFn__=s,h=!1;else{s=MR(i,e,u,s);const x=t.listen(m,r,s);d.push(s,x),c&&c.push(r,y,g,g+1)}}else s=MR(i,e,u,s);const f=i.outputs;let p;if(h&&null!==f&&(p=f[r])){const v=p.length;if(v)for(let m=0;m<v;m+=2){const T=e[p[m]][p[m+1]].subscribe(s),E=d.length;d.push(s,T),c&&c.push(r,i.index,E,-(E+1))}}}(s,r,r[11],o,n,e,i),Mh}function bR(n,e,t,i){const r=ht(null);try{return!1!==t(i)}catch(s){return ug(n,s),!1}finally{ht(r)}}function MR(n,e,t,i){return function r(s){if(s===Function)return i;eh(n.componentOffset>-1?ur(n.index,e):e,5);let a=bR(e,0,i,s),l=r.__ngNextListenerFn__;for(;l;)a=bR(e,0,l,s)&&a,l=l.__ngNextListenerFn__;return a}}function Ji(n=1){return function jU(n){return(rt.lFrame.contextLView=function HT(n,e){for(;n>0;)e=e[14],n--;return e}(n,rt.lFrame.contextLView))[8]}(n)}function n$(n,e){let t=null;const i=function Oz(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?aA(n,s,!0):Uz(i,s))return r}else t=r}return t}function Ze(n,e=""){const t=U(),i=tt(),r=n+25,s=i.firstCreatePass?Ja(i,r,1,e,null):i.data[r],o=WR(i,t,s,e,n);t[r]=o,Td()&&hg(i,t,o,s),qr(s,!1)}let WR=(n,e,t,i,r)=>(ps(!0),function X0(n,e){return n.createText(e)}(e[11],i));function Zn(n){return Dn("",n,""),Zn}function Dn(n,e,t){const i=U(),r=function Wc(n,e,t,i){return Tn(n,Nr(),t)?e+lt(t)+i:ct}(i,n,e,t);return r!==ct&&Js(i,fi(),r),Dn}function Eh(n,e,t,i,r){const s=U(),o=qc(s,n,e,t,i,r);return o!==ct&&Js(s,fi(),o),Eh}function Js(n,e,t){const i=gc(e,n);!function hA(n,e,t){n.setValue(e,t)}(n[11],i,t)}function Cw(n,e,t,i){return oN(U(),Ai(),n,e,t,i)}function Sh(n,e){const t=n[e];return t===ct?void 0:t}function oN(n,e,t,i,r,s){const o=e+t;return Tn(n,o,r)?bs(n,o+1,s?i.call(s,r):i(r)):Sh(n,o+1)}function gt(n,e){const t=tt();let i;const r=n+25;t.firstCreatePass?(i=function V$(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=Na(i.type)),a=ji(Be);try{const l=Pp(!1),c=s();return Pp(l),function bw(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,U(),r,c),c}finally{ji(a)}}function Et(n,e,t){const i=n+25,r=U(),s=Va(r,i);return Th(r,i)?oN(r,Ai(),e,s.transform,t,s):s.transform(t)}function Wg(n,e,t,i){const r=n+25,s=U(),o=Va(s,r);return Th(s,r)?function aN(n,e,t,i,r,s,o){const a=e+t;return nl(n,a,r,s)?bs(n,a+2,o?i.call(o,r,s):i(r,s)):Sh(n,a+2)}(s,Ai(),e,o.transform,t,i,o):o.transform(t,i)}function Th(n,e){return n[1].data[e].pure}class v6{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let TN=(()=>{class n{compileModuleSync(t){return new Hx(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=hr(vi(t).declarations).reduce((o,a)=>{const l=_t(a);return l&&o.push(new dh(l)),o},[]);return new v6(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),x6=(()=>{class n{zone=W(Ot);changeDetectionScheduler=W(qs);applicationRef=W(pr);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const w6=new oe("",{factory:()=>!1});function Nw({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new Ot({...Pw(),scheduleInRootZone:t}),[{provide:Ot,useFactory:n},{provide:Dr,multi:!0,useFactory:()=>{const i=W(x6,{optional:!0});return()=>i.initialize()}},{provide:Dr,multi:!0,useFactory:()=>{const i=W(M6);return()=>{i.initialize()}}},!0===e?{provide:DC,useValue:!0}:[],{provide:t0,useValue:t??TC}]}function Pw(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}let M6=(()=>{class n{subscription=new Ut;initialized=!1;zone=W(Ot);pendingTasks=W(ms);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Ot.assertNotInAngularZone(),queueMicrotask(()=>{null!==t&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Ot.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Dh=(()=>{class n{appRef=W(pr);taskService=W(ms);ngZone=W(Ot);zonelessEnabled=W(Rd);tracing=W(bc,{optional:!0});disableScheduling=W(DC,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Ut;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Up):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(W(t0,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof o0||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&5===t)return;let i=!1;switch(t){case 0:this.appRef.dirtyFlags|=2;break;case 3:case 2:case 4:case 5:case 1:this.appRef.dirtyFlags|=4;break;case 8:this.appRef.deferredDirtyFlags|=8;break;case 6:case 14:this.appRef.dirtyFlags|=2,i=!0;break;case 13:this.appRef.dirtyFlags|=16,i=!0;break;case 12:i=!0;break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;const r=this.useMicrotaskScheduler?IC:AC;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>r(()=>this.tick())):this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Up+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(0===this.appRef.dirtyFlags)return void this.cleanup();!this.zonelessEnabled&&7&this.appRef.dirtyFlags&&(this.appRef.dirtyFlags|=1);const t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){throw this.taskService.remove(t),i}finally{this.cleanup()}this.useMicrotaskScheduler=!0,IC(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Zo=new oe("",{providedIn:"root",factory:()=>W(Zo,Dt.Optional|Dt.SkipSelf)||function E6(){return typeof $localize<"u"&&$localize.locale||zg}()}),Zg=new oe(""),I6=new oe("");function Ah(n){return!n.moduleRef}let Jo=null;let Ih=(()=>class n{static __NG_ELEMENT_ID__=O6})();function O6(n){return function F6(n,e,t){if(Po(n)&&!t){const i=ur(n.index,e);return new th(i,i)}return 175&n.type?new th(e[15],e):null}(xt(),U(),!(16&~n))}class VN{constructor(){}supports(e){return Ag(e)}create(e){return new z6(e)}}const V6=(n,e)=>e;class z6{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||V6}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<HN(i,r,s)?t:i,a=HN(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let h=0;h<c;h++){const f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<c&&(s[h]=f+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Ag(e))throw new te(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function I5(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new H6(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new zN),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new zN),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class H6{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}}class G6{_head=null;_tail=null;add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class zN{map=new Map;put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new G6,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function HN(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}function jN(){return new Vw([new VN])}let Vw=(()=>{class n{factories;static \u0275prov=xe({token:n,providedIn:"root",factory:jN});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||jN()),deps:[[n,new m_,new g_]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new te(901,!1)}}return n})();function sW(n){try{const{rootComponent:e,appProviders:t,platformProviders:i}=n,r=function L6(n=[]){if(Jo)return Jo;const e=function LN(n=[],e){return Pn.create({name:e,providers:[{provide:M_,useValue:"platform"},{provide:Zg,useValue:new Set([()=>Jo=null])},...n]})}(n);return Jo=e,function mI(){!function QS(n){Qf=n}(()=>{throw new te(600,!1)})}(),function ON(n){const e=n.get(h0,null);Ar(n,()=>{e?.forEach(t=>t())})}(e),e}(i),s=[Nw({}),{provide:qs,useExisting:Dh},...t||[]];return function RN(n){const e=Ah(n)?n.r3Injector:n.moduleRef.injector,t=e.get(Ot);return t.run(()=>{Ah(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();const i=e.get(vs,null);let r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:s=>{i.handleError(s)}})}),Ah(n)){const s=()=>e.destroy(),o=n.platformInjector.get(Zg);o.add(s),e.onDestroy(()=>{r.unsubscribe(),o.delete(s)})}else{const s=()=>n.moduleRef.destroy(),o=n.platformInjector.get(Zg);o.add(s),n.moduleRef.onDestroy(()=>{kg(n.allPlatformModules,n.moduleRef),r.unsubscribe(),o.delete(s)})}return function L8(n,e,t){try{const i=t();return Og(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(i,t,()=>{const s=e.get(pI);return s.runInitializers(),s.donePromise.then(()=>{if(function vj(n){"string"==typeof n&&(tR=n.toLowerCase().replace(/_/g,"-"))}(e.get(Zo,zg)||zg),!e.get(I6,!0))return Ah(n)?e.get(pr):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Ah(n)){const l=e.get(pr);return void 0!==n.rootComponent&&l.bootstrap(n.rootComponent),l}return function R6(n,e){const t=n.injector.get(pr);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>t.bootstrap(i));else{if(!n.instance.ngDoBootstrap)throw new te(-403,!1);n.instance.ngDoBootstrap(t)}e.push(n)}(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}({r3Injector:new V1({providers:s,parent:r,debugName:"",runEnvironmentInitializers:!1}).injector,platformInjector:r,rootComponent:e})}catch(e){return Promise.reject(e)}}function jw(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function Ks(n){const e=ht(null);try{return n()}finally{ht(e)}}let bP=null;function ru(){return bP}class e9{}const Ki=new oe("");let Xw=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:()=>W(n9),providedIn:"platform"})}return n})();const t9=new oe("");let n9=(()=>{class n extends Xw{_location;_history;_doc=W(Ki);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ru().getBaseHref(this._doc)}onPopState(t){const i=ru().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=ru().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function Yw(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function MP(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Qs(n){return n&&"?"!==n[0]?"?"+n:n}let al=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:()=>W(SP),providedIn:"root"})}return n})();const EP=new oe("");let SP=(()=>{class n extends al{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??W(Ki).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Yw(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Qs(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Qs(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Qs(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(_e(Xw),_e(EP,8))};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),i9=(()=>{class n extends al{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){const i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=Yw(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+Qs(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+Qs(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||n)(_e(Xw),_e(EP,8))};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})(),Oh=(()=>{class n{_subject=new ii;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function o9(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(MP(TP(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Qs(i))}normalize(t){return n.stripTrailingSlash(function s9(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,TP(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Qs(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Qs(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=Qs;static joinWithSlash=Yw;static stripTrailingSlash=MP;static \u0275fac=function(i){return new(i||n)(_e(al))};static \u0275prov=xe({token:n,factory:()=>function r9(){return new Oh(_e(al))}(),providedIn:"root"})}return n})();function TP(n){return n.replace(/\/index.html$/,"")}var Li=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(Li||{}),on=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(on||{}),gr=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(gr||{});function dm(n,e){return Fr(Ni(n)[cn.DateFormat],e)}function hm(n,e){return Fr(Ni(n)[cn.TimeFormat],e)}function fm(n,e){return Fr(Ni(n)[cn.DateTimeFormat],e)}function Or(n,e){const t=Ni(n),i=t[cn.NumberSymbols][e];if(typeof i>"u"){if(12===e)return t[cn.NumberSymbols][0];if(13===e)return t[cn.NumberSymbols][1]}return i}function DP(n){if(!n[cn.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[cn.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Fr(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function Jw(n){const[e,t]=n.split(":");return{hours:+e,minutes:+t}}const x9=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,pm={},w9=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function b9(n,e,t,i){let r=function R9(n){if(RP(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[r,s=1,o=1]=n.split("-").map(a=>+a);return gm(r,s-1,o)}const t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(x9))return function N9(n){const e=new Date(0);let t=0,i=0;const r=n[8]?e.setUTCFullYear:e.setFullYear,s=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));const o=Number(n[4]||0)-t,a=Number(n[5]||0)-i,l=Number(n[6]||0),c=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return s.call(e,o,a,l,c),e}(i)}const e=new Date(n);if(!RP(e))throw new Error(`Unable to convert "${n}" into a date`);return e}(n);e=eo(t,e)||e;let a,o=[];for(;e;){if(a=w9.exec(e),!a){o.push(e);break}{o=o.concat(a.slice(1));const u=o.pop();if(!u)break;e=u}}let l=r.getTimezoneOffset();i&&(l=IP(i,l),r=function I9(n,e,t){const i=t?-1:1,r=n.getTimezoneOffset();return function A9(n,e){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+e),n}(n,i*(IP(e,r)-r))}(r,i,!0));let c="";return o.forEach(u=>{const d=function D9(n){if(Qw[n])return Qw[n];let e;switch(n){case"G":case"GG":case"GGG":e=un(3,on.Abbreviated);break;case"GGGG":e=un(3,on.Wide);break;case"GGGGG":e=un(3,on.Narrow);break;case"y":e=Vn(0,1,0,!1,!0);break;case"yy":e=Vn(0,2,0,!0,!0);break;case"yyy":e=Vn(0,3,0,!1,!0);break;case"yyyy":e=Vn(0,4,0,!1,!0);break;case"Y":e=_m(1);break;case"YY":e=_m(2,!0);break;case"YYY":e=_m(3);break;case"YYYY":e=_m(4);break;case"M":case"L":e=Vn(1,1,1);break;case"MM":case"LL":e=Vn(1,2,1);break;case"MMM":e=un(2,on.Abbreviated);break;case"MMMM":e=un(2,on.Wide);break;case"MMMMM":e=un(2,on.Narrow);break;case"LLL":e=un(2,on.Abbreviated,Li.Standalone);break;case"LLLL":e=un(2,on.Wide,Li.Standalone);break;case"LLLLL":e=un(2,on.Narrow,Li.Standalone);break;case"w":e=Kw(1);break;case"ww":e=Kw(2);break;case"W":e=Kw(1,!0);break;case"d":e=Vn(2,1);break;case"dd":e=Vn(2,2);break;case"c":case"cc":e=Vn(7,1);break;case"ccc":e=un(1,on.Abbreviated,Li.Standalone);break;case"cccc":e=un(1,on.Wide,Li.Standalone);break;case"ccccc":e=un(1,on.Narrow,Li.Standalone);break;case"cccccc":e=un(1,on.Short,Li.Standalone);break;case"E":case"EE":case"EEE":e=un(1,on.Abbreviated);break;case"EEEE":e=un(1,on.Wide);break;case"EEEEE":e=un(1,on.Narrow);break;case"EEEEEE":e=un(1,on.Short);break;case"a":case"aa":case"aaa":e=un(0,on.Abbreviated);break;case"aaaa":e=un(0,on.Wide);break;case"aaaaa":e=un(0,on.Narrow);break;case"b":case"bb":case"bbb":e=un(0,on.Abbreviated,Li.Standalone,!0);break;case"bbbb":e=un(0,on.Wide,Li.Standalone,!0);break;case"bbbbb":e=un(0,on.Narrow,Li.Standalone,!0);break;case"B":case"BB":case"BBB":e=un(0,on.Abbreviated,Li.Format,!0);break;case"BBBB":e=un(0,on.Wide,Li.Format,!0);break;case"BBBBB":e=un(0,on.Narrow,Li.Format,!0);break;case"h":e=Vn(3,1,-12);break;case"hh":e=Vn(3,2,-12);break;case"H":e=Vn(3,1);break;case"HH":e=Vn(3,2);break;case"m":e=Vn(4,1);break;case"mm":e=Vn(4,2);break;case"s":e=Vn(5,1);break;case"ss":e=Vn(5,2);break;case"S":e=Vn(6,1);break;case"SS":e=Vn(6,2);break;case"SSS":e=Vn(6,3);break;case"Z":case"ZZ":case"ZZZ":e=vm(0);break;case"ZZZZZ":e=vm(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=vm(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=vm(2);break;default:return null}return Qw[n]=e,e}(u);c+=d?d(r,t,l):"''"===u?"'":u.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function gm(n,e,t){const i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function eo(n,e){const t=function l9(n){return Ni(n)[cn.LocaleId]}(n);if(pm[t]??={},pm[t][e])return pm[t][e];let i="";switch(e){case"shortDate":i=dm(n,gr.Short);break;case"mediumDate":i=dm(n,gr.Medium);break;case"longDate":i=dm(n,gr.Long);break;case"fullDate":i=dm(n,gr.Full);break;case"shortTime":i=hm(n,gr.Short);break;case"mediumTime":i=hm(n,gr.Medium);break;case"longTime":i=hm(n,gr.Long);break;case"fullTime":i=hm(n,gr.Full);break;case"short":const r=eo(n,"shortTime"),s=eo(n,"shortDate");i=mm(fm(n,gr.Short),[r,s]);break;case"medium":const o=eo(n,"mediumTime"),a=eo(n,"mediumDate");i=mm(fm(n,gr.Medium),[o,a]);break;case"long":const l=eo(n,"longTime"),c=eo(n,"longDate");i=mm(fm(n,gr.Long),[l,c]);break;case"full":const u=eo(n,"fullTime"),d=eo(n,"fullDate");i=mm(fm(n,gr.Full),[u,d])}return i&&(pm[t][e]=i),i}function mm(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return null!=e&&i in e?e[i]:t})),n}function Jr(n,e,t="-",i,r){let s="";(n<0||r&&n<=0)&&(r?n=1-n:(n=-n,s=t));let o=String(n);for(;o.length<e;)o="0"+o;return i&&(o=o.slice(o.length-e)),s+o}function Vn(n,e,t=0,i=!1,r=!1){return function(s,o){let a=function E9(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,s);if((t>0||a>-t)&&(a+=t),3===n)0===a&&-12===t&&(a=12);else if(6===n)return function M9(n,e){return Jr(n,3).substring(0,e)}(a,e);const l=Or(o,5);return Jr(a,e,l,i,r)}}function un(n,e,t=Li.Format,i=!1){return function(r,s){return function S9(n,e,t,i,r,s){switch(t){case 2:return function d9(n,e,t){const i=Ni(n),s=Fr([i[cn.MonthsFormat],i[cn.MonthsStandalone]],e);return Fr(s,t)}(e,r,i)[n.getMonth()];case 1:return function u9(n,e,t){const i=Ni(n),s=Fr([i[cn.DaysFormat],i[cn.DaysStandalone]],e);return Fr(s,t)}(e,r,i)[n.getDay()];case 0:const o=n.getHours(),a=n.getMinutes();if(s){const c=function g9(n){const e=Ni(n);return DP(e),(e[cn.ExtraData][2]||[]).map(i=>"string"==typeof i?Jw(i):[Jw(i[0]),Jw(i[1])])}(e),u=function m9(n,e,t){const i=Ni(n);DP(i);const s=Fr([i[cn.ExtraData][0],i[cn.ExtraData][1]],e)||[];return Fr(s,t)||[]}(e,r,i),d=c.findIndex(h=>{if(Array.isArray(h)){const[f,p]=h,v=o>=f.hours&&a>=f.minutes,m=o<p.hours||o===p.hours&&a<p.minutes;if(f.hours<p.hours){if(v&&m)return!0}else if(v||m)return!0}else if(h.hours===o&&h.minutes===a)return!0;return!1});if(-1!==d)return u[d]}return function c9(n,e,t){const i=Ni(n),s=Fr([i[cn.DayPeriodsFormat],i[cn.DayPeriodsStandalone]],e);return Fr(s,t)}(e,r,i)[o<12?0:1];case 3:return function h9(n,e){return Fr(Ni(n)[cn.Eras],e)}(e,i)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(r,s,n,e,t,i)}}function vm(n){return function(e,t,i){const r=-1*i,s=Or(t,5),o=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+Jr(o,2,s)+Jr(Math.abs(r%60),2,s);case 1:return"GMT"+(r>=0?"+":"")+Jr(o,1,s);case 2:return"GMT"+(r>=0?"+":"")+Jr(o,2,s)+":"+Jr(Math.abs(r%60),2,s);case 3:return 0===i?"Z":(r>=0?"+":"")+Jr(o,2,s)+":"+Jr(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}const T9=0,ym=4;function AP(n){const e=n.getDay(),t=0===e?-3:ym-e;return gm(n.getFullYear(),n.getMonth(),n.getDate()+t)}function Kw(n,e=!1){return function(t,i){let r;if(e){const s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();r=1+Math.floor((o+s)/7)}else{const s=AP(t),o=function C9(n){const e=gm(n,T9,1).getDay();return gm(n,0,1+(e<=ym?ym:ym+7)-e)}(s.getFullYear()),a=s.getTime()-o.getTime();r=1+Math.round(a/6048e5)}return Jr(r,n,Or(i,5))}}function _m(n,e=!1){return function(t,i){return Jr(AP(t).getFullYear(),n,Or(i,5),e)}}const Qw={};function IP(n,e){n=n.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function RP(n){return n instanceof Date&&!isNaN(n.valueOf())}function OP(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}class W9{$implicit;ngForOf;index;count;constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ob=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new W9(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),UP(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{UP(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(Be(fr),Be(Ys),Be(Vw))};static \u0275dir=Ri({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function UP(n,e){n.context.$implicit=e.item}let ab=(()=>{class n{_viewContainer;_context=new q9;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){BP("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){BP("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||n)(Be(fr),Be(Ys))};static \u0275dir=Ri({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})();class q9{$implicit=null;ngIf=null}function BP(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${jn(e)}'.`)}function Kr(n,e){return new te(2100,!1)}class Z9{createSubscription(e,t){return Ks(()=>e.subscribe({next:t,error:i=>{throw i}}))}dispose(e){Ks(()=>e.unsubscribe())}}class J9{createSubscription(e,t){return e.then(t,i=>{throw i})}dispose(e){}}const K9=new J9,Q9=new Z9;let zP=(()=>{class n{_ref;_latestValue=null;markForCheckOnValueUpdate=!0;_subscription=null;_obj=null;_strategy=null;constructor(t){this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){if(!this._obj){if(t)try{this.markForCheckOnValueUpdate=!1,this._subscribe(t)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,i=>this._updateLatestValue(t,i))}_selectStrategy(t){if(Og(t))return K9;if(fI(t))return Q9;throw Kr()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,i){t===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static \u0275fac=function(i){return new(i||n)(Be(Ih,16))};static \u0275pipe=li({name:"async",type:n,pure:!1})}return n})();const s7=new oe(""),o7=new oe("");let HP=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,i,r){this.locale=t,this.defaultTimezone=i,this.defaultOptions=r}transform(t,i,r,s){if(null==t||""===t||t!=t)return null;try{return b9(t,i??this.defaultOptions?.dateFormat??"mediumDate",s||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(o){throw Kr()}}static \u0275fac=function(i){return new(i||n)(Be(Zo,16),Be(s7,24),Be(o7,24))};static \u0275pipe=li({name:"date",type:n,pure:!0})}return n})(),wm=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Vc({type:n});static \u0275inj=Ra({})}return n})();const jP="browser";function ou(n){return n===jP}function $P(n){return"server"===n}let v7=(()=>{class n{static \u0275prov=xe({token:n,providedIn:"root",factory:()=>new y7(W(Ki),window)})}return n})();class y7{document;window;offset=()=>[0,0];constructor(e,t){this.document=e,this.window=t}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){const t=function _7(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}}class WP{}class q7 extends e9{supportsDOMEvents=!0}class gb extends q7{static makeCurrent(){!function QW(n){bP??=n}(new gb)}onAndCancel(e,t,i,r){return e.addEventListener(t,i,r),()=>{e.removeEventListener(t,i,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function X7(){return Bh=Bh||document.querySelector("base"),Bh?Bh.getAttribute("href"):null}();return null==t?null:function Y7(n){return new URL(n,document.baseURI).pathname}(t)}resetBaseElement(){Bh=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return OP(document.cookie,e)}}let Bh=null,J7=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();const mb=new oe("");let iL=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r,s){return this._findPluginFor(i).addEventListener(t,i,r,s)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new te(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||n)(_e(mb),_e(Ot))};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();class rL{_doc;constructor(e){this._doc=e}manager}const Sm="ng-app-id";function sL(n){for(const e of n)e.remove()}function oL(n,e){const t=e.createElement("style");return t.textContent=n,t}function vb(n,e){const t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}let aL=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.isServer=$P(s),function K7(n,e,t,i){const r=n.head?.querySelectorAll(`style[${Sm}="${e}"],link[${Sm}="${e}"]`);if(r)for(const s of r)s.removeAttribute(Sm),s instanceof HTMLLinkElement?i.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(const r of t)this.addUsage(r,this.inline,oL);i?.forEach(r=>this.addUsage(r,this.external,vb))}removeStyles(t,i){for(const r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){const s=i.get(t);s?s.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,r(t,this.doc)))})}removeUsage(t,i){const r=i.get(t);r&&(r.usage--,r.usage<=0&&(sL(r.elements),i.delete(t)))}ngOnDestroy(){for(const[,{elements:t}]of[...this.inline,...this.external])sL(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(const[i,{elements:r}]of this.inline)r.push(this.addElement(t,oL(i,this.doc)));for(const[i,{elements:r}]of this.external)r.push(this.addElement(t,vb(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),this.isServer&&i.setAttribute(Sm,this.appId),t.appendChild(i)}static \u0275fac=function(i){return new(i||n)(_e(Ki),_e(Wa),_e(sD,8),_e(ko))};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();const yb={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},_b=/%COMP%/g,nq=new oe("",{providedIn:"root",factory:()=>!0});function cL(n,e){return e.map(t=>t.replace(_b,n))}let uL=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,i,r,s,o,a,l,c=null,u=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=c,this.tracingService=u,this.platformIsServer=$P(a),this.defaultRenderer=new xb(t,o,l,this.platformIsServer,this.tracingService)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Pr.ShadowDom&&(i={...i,encapsulation:Pr.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof hL?r.applyToHost(t):r instanceof wb&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const o=this.doc,a=this.ngZone,l=this.eventManager,c=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case Pr.Emulated:s=new hL(l,c,i,this.appId,u,o,a,d,this.tracingService);break;case Pr.ShadowDom:return new oq(l,c,t,i,o,a,this.nonce,d,this.tracingService);default:s=new wb(l,c,i,u,o,a,d,this.tracingService)}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||n)(_e(iL),_e(aL),_e(Wa),_e(nq),_e(Ki),_e(ko),_e(Ot),_e(sD),_e(bc,8))};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();class xb{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,i,r,s){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.tracingService=s}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(yb[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(dL(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(dL(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){t.remove()}selectRootElement(e,t){let i="string"==typeof e?this.doc.querySelector(e):e;if(!i)throw new te(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=yb[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=yb[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Go.DashCase|Go.Important)?e.style.setProperty(t,i,r&Go.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Go.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){null!=e&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i,r){if("string"==typeof e&&!(e=ru().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);let s=this.decoratePreventDefault(i);return null!==this.tracingService&&this.tracingService.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,r)}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function dL(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class oq extends xb{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,i,r,s,o,a,l,c){super(e,s,o,l,c),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=cL(r.id,r.styles);for(const h of u){const f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=h,this.shadowRoot.appendChild(f)}const d=r.getExternalStyles?.();if(d)for(const h of d){const f=vb(h,s);a&&f.setAttribute("nonce",a),this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class wb extends xb{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,i,r,s,o,a,l,c){super(e,s,o,a,l),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=c?cL(c,i.styles):i.styles,this.styleUrls=i.getExternalStyles?.(c)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}}class hL extends wb{contentAttr;hostAttr;constructor(e,t,i,r,s,o,a,l,c){const u=r+"-"+i.id;super(e,t,i,s,o,a,l,c,u),this.contentAttr=function iq(n){return"_ngcontent-%COMP%".replace(_b,n)}(u),this.hostAttr=function rq(n){return"_nghost-%COMP%".replace(_b,n)}(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}const fL=["alt","control","meta","shift"],lq={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},cq={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};function pL(n){return{appProviders:[...vq,...n?.providers??[]],platformProviders:gq}}const gq=[{provide:ko,useValue:jP},{provide:h0,useValue:function hq(){gb.makeCurrent()},multi:!0},{provide:Ki,useFactory:function pq(){return function QB(n){d0=n}(document),document},deps:[]}],vq=[{provide:M_,useValue:"root"},{provide:vs,useFactory:function fq(){return new vs},deps:[]},{provide:mb,useClass:(()=>{class n extends rL{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r,s){return t.addEventListener(i,r,s),()=>this.removeEventListener(t,i,r,s)}removeEventListener(t,i,r,s){return t.removeEventListener(i,r,s)}static \u0275fac=function(i){return new(i||n)(_e(Ki))};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})(),multi:!0,deps:[Ki,Ot,ko]},{provide:mb,useClass:(()=>{class n extends rL{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r,s){const o=n.parseEventName(i),a=n.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ru().onAndCancel(t,o.domEventName,a,s))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),o="code."),fL.forEach(c=>{const u=i.indexOf(c);u>-1&&(i.splice(u,1),o+=c+".")}),o+=s,0!=i.length||0===s.length)return null;const l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=lq[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),fL.forEach(o=>{o!==r&&(0,cq[o])(t)&&(s+=o+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static \u0275fac=function(i){return new(i||n)(_e(Ki))};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})(),multi:!0,deps:[Ki]},uL,aL,iL,{provide:Dx,useExisting:uL},{provide:WP,useClass:J7,deps:[]},[]];let yq=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||n)(_e(Ki))};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Vh=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:function(i){let r=null;return r=i?new(i||n):_e(bq),r},providedIn:"root"})}return n})(),bq=(()=>{class n extends Vh{_doc;constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case Xi.NONE:return i;case Xi.HTML:return xs(i,"HTML")?dr(i):ZD(this._doc,String(i)).toString();case Xi.STYLE:return xs(i,"Style")?dr(i):i;case Xi.SCRIPT:if(xs(i,"Script"))return dr(i);throw new te(5200,!1);case Xi.URL:return xs(i,"URL")?dr(i):rg(String(i));case Xi.RESOURCE_URL:if(xs(i,"ResourceURL"))return dr(i);throw new te(5201,!1);default:throw new te(5202,!1)}}bypassSecurityTrustHtml(t){return function XV(n){return new HV(n)}(t)}bypassSecurityTrustStyle(t){return function YV(n){return new GV(n)}(t)}bypassSecurityTrustScript(t){return function ZV(n){return new jV(n)}(t)}bypassSecurityTrustUrl(t){return function JV(n){return new $V(n)}(t)}bypassSecurityTrustResourceUrl(t){return function KV(n){return new WV(n)}(t)}static \u0275fac=function(i){return new(i||n)(_e(Ki))};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function lu(n){return!!n&&(n instanceof Nn||ye(n.lift)&&ye(n.subscribe))}function Qo(n){return this instanceof Qo?(this.v=n,this):new Qo(n)}function xL(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function Sb(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const wL=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function bL(n){return ye(n?.then)}function ML(n){return ye(n[t_])}function EL(n){return Symbol.asyncIterator&&ye(n?.[Symbol.asyncIterator])}function SL(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const TL=function Yq(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function CL(n){return ye(n?.[TL])}function DL(n){return function _L(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function o(f){return function(p){return Promise.resolve(p).then(f,d)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(f,p){i[f]&&(r[f]=function(v){return new Promise(function(m,g){s.push([f,v,m,g])>1||l(f,v)})},p&&(r[f]=p(r[f])))}function l(f,p){try{!function c(f){f.value instanceof Qo?Promise.resolve(f.value.v).then(u,d):h(s[0][2],f)}(i[f](p))}catch(v){h(s[0][3],v)}}function u(f){l("next",f)}function d(f){l("throw",f)}function h(f,p){f(p),s.shift(),s.length&&l(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield Qo(t.read());if(r)return yield Qo(void 0);yield yield Qo(i)}}finally{t.releaseLock()}})}function AL(n){return ye(n?.getReader)}function mr(n){if(n instanceof Nn)return n;if(null!=n){if(ML(n))return function Zq(n){return new Nn(e=>{const t=n[t_]();if(ye(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(wL(n))return function Jq(n){return new Nn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(bL(n))return function Kq(n){return new Nn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Ca)})}(n);if(EL(n))return IL(n);if(CL(n))return function Qq(n){return new Nn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(AL(n))return function eX(n){return IL(DL(n))}(n)}throw SL(n)}function IL(n){return new Nn(e=>{(function tX(n,e){var t,i,r,s;return function vL(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=xL(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function to(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function RL(n,e=0){return Gn((t,i)=>{t.subscribe(Un(i,r=>to(i,n,()=>i.next(r),e),()=>to(i,n,()=>i.complete(),e),r=>to(i,n,()=>i.error(r),e)))})}function NL(n,e=0){return Gn((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function PL(n,e){if(!n)throw new Error("Iterable cannot be null");return new Nn(t=>{to(t,e,()=>{const i=n[Symbol.asyncIterator]();to(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function Kn(n,e){return e?function aX(n,e){if(null!=n){if(ML(n))return function nX(n,e){return mr(n).pipe(NL(e),RL(e))}(n,e);if(wL(n))return function rX(n,e){return new Nn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(bL(n))return function iX(n,e){return mr(n).pipe(NL(e),RL(e))}(n,e);if(EL(n))return PL(n,e);if(CL(n))return function sX(n,e){return new Nn(t=>{let i;return to(t,e,()=>{i=n[TL](),to(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>ye(i?.return)&&i.return()})}(n,e);if(AL(n))return function oX(n,e){return PL(DL(n),e)}(n,e)}throw SL(n)}(n,e):mr(n)}function LL(n){return n&&ye(n.schedule)}function Cb(n){return n[n.length-1]}function OL(n){return ye(Cb(n))?n.pop():void 0}function Hh(n){return LL(Cb(n))?n.pop():void 0}function Xe(...n){return Kn(n,Hh(n))}const{isArray:cX}=Array,{getPrototypeOf:uX,prototype:dX,keys:hX}=Object;function FL(n){if(1===n.length){const e=n[0];if(cX(e))return{args:e,keys:null};if(function fX(n){return n&&"object"==typeof n&&uX(n)===dX}(e)){const t=hX(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:pX}=Array;function kL(n){return Ct(e=>function gX(n,e){return pX(e)?n(...e):n(e)}(n,e))}function UL(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function Db(...n){const e=Hh(n),t=OL(n),{args:i,keys:r}=FL(n);if(0===i.length)return Kn([],e);const s=new Nn(function mX(n,e,t=Do){return i=>{BL(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)BL(e,()=>{const c=Kn(n[l],e);let u=!1;c.subscribe(Un(i,d=>{s[l]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>UL(r,o):Do));return t?s.pipe(kL(t)):s}function BL(n,e,t){n?to(t,n,e):e()}const Tm=ni(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function wi(n,e,t=1/0){return ye(e)?wi((i,r)=>Ct((s,o)=>e(i,s,r,o))(mr(n(i,r))),t):("number"==typeof e&&(t=e),Gn((i,r)=>function vX(n,e,t,i,r,s,o,a){const l=[];let c=0,u=0,d=!1;const h=()=>{d&&!l.length&&!c&&e.complete()},f=v=>c<i?p(v):l.push(v),p=v=>{s&&e.next(v),c++;let m=!1;mr(t(v,u++)).subscribe(Un(e,g=>{r?.(g),s?f(g):e.next(g)},()=>{m=!0},void 0,()=>{if(m)try{for(c--;l.length&&c<i;){const g=l.shift();o?to(e,o,()=>p(g)):p(g)}h()}catch(g){e.error(g)}}))};return n.subscribe(Un(e,f,()=>{d=!0,h()})),()=>{a?.()}}(i,r,n,t)))}function cu(n=1/0){return wi(Do,n)}function Gh(...n){return function yX(){return cu(1)}()(Kn(n,Hh(n)))}function Cm(n){return new Nn(e=>{mr(n()).subscribe(e)})}function Dm(n,e){const t=ye(n)?n:()=>n,i=r=>r.error(t());return new Nn(e?r=>e.schedule(i,0,r):i)}const Qr=new Nn(n=>n.complete());function Ab(){return Gn((n,e)=>{let t=null;n._refCount++;const i=Un(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class VL extends Nn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,rT(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ut;const t=this.getSubject();e.add(this.source.subscribe(Un(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ut.EMPTY)}return e}refCount(){return Ab()(this)}}function Qi(n,e){return Gn((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(Un(i,l=>{r?.unsubscribe();let c=0;const u=s++;mr(n(l,u)).subscribe(r=Un(i,d=>i.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Ss(n){return n<=0?()=>Qr:Gn((e,t)=>{let i=0;e.subscribe(Un(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function zL(...n){const e=Hh(n);return Gn((t,i)=>{(e?Gh(n,t,e):Gh(n,t)).subscribe(i)})}function no(n,e){return Gn((t,i)=>{let r=0;t.subscribe(Un(i,s=>n.call(e,s,r++)&&i.next(s)))})}function Am(n){return Gn((e,t)=>{let i=!1;e.subscribe(Un(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function HL(n=xX){return Gn((e,t)=>{let i=!1;e.subscribe(Un(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function xX(){return new Tm}function ea(n,e){const t=arguments.length>=2;return i=>i.pipe(n?no((r,s)=>n(r,s,i)):Do,Ss(1),t?Am(e):HL(()=>new Tm))}function ll(n,e){return ye(e)?wi(n,e,1):wi(n,1)}function Oi(n,e,t){const i=ye(n)||e||t?{next:n,error:e,complete:t}:n;return i?Gn((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(Un(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):Do}function uu(n){return Gn((e,t)=>{let s,i=null,r=!1;i=e.subscribe(Un(t,void 0,void 0,o=>{s=mr(n(o,uu(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function Ib(n){return n<=0?()=>Qr:Gn((e,t)=>{let i=[];e.subscribe(Un(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function Im(n){return Gn((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function GL(n){return Gn((e,t)=>{mr(n).subscribe(Un(t,()=>t.complete(),Mn)),!t.closed&&e.subscribe(t)})}const wt="primary",jh=Symbol("RouteTitle");class EX{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function du(n){return new EX(n)}function SX(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(":"===o[0])r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Ts(n,e){const t=n?Rb(n):void 0,i=e?Rb(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!jL(n[r],e[r]))return!1;return!0}function Rb(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function jL(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function $L(n){return n.length>0?n[n.length-1]:null}function ta(n){return lu(n)?n:Og(n)?Kn(Promise.resolve(n)):Xe(n)}const CX={exact:function XL(n,e,t){if(!ul(n.segments,e.segments)||!Rm(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!XL(n.children[i],e.children[i],t))return!1;return!0},subset:YL},WL={exact:function DX(n,e){return Ts(n,e)},subset:function AX(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>jL(n[t],e[t]))},ignored:()=>!0};function qL(n,e,t){return CX[t.paths](n.root,e.root,t.matrixParams)&&WL[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function YL(n,e,t){return ZL(n,e,e.segments,t)}function ZL(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!ul(r,t)||e.hasChildren()||!Rm(r,t,i))}if(n.segments.length===t.length){if(!ul(n.segments,t)||!Rm(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!YL(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(ul(n.segments,r)&&Rm(n.segments,r,i)&&n.children[wt])&&ZL(n.children[wt],e,s,i)}}function Rm(n,e,t){return e.every((i,r)=>WL[t](n[r].parameters,i.parameters))}class cl{root;queryParams;fragment;_queryParamMap;constructor(e=new en([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=du(this.queryParams),this._queryParamMap}toString(){return NX.serialize(this)}}class en{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Pm(this)}}class $h{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=du(this.parameters),this._parameterMap}toString(){return QL(this)}}function ul(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let hu=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:()=>new Nm,providedIn:"root"})}return n})();class Nm{parse(e){const t=new GX(e);return new cl(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Wh(e.root,!0)}`,i=function OX(n){const e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${Lm(t)}=${Lm(r)}`).join("&"):`${Lm(t)}=${Lm(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function PX(n){return encodeURI(n)}(e.fragment)}`:""}`}}const NX=new Nm;function Pm(n){return n.segments.map(e=>QL(e)).join("/")}function Wh(n,e){if(!n.hasChildren())return Pm(n);if(e){const t=n.children[wt]?Wh(n.children[wt],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==wt&&i.push(`${r}:${Wh(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function RX(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===wt&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==wt&&(t=t.concat(e(r,i)))}),t}(n,(i,r)=>r===wt?[Wh(n.children[wt],!1)]:[`${r}:${Wh(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[wt]?`${Pm(n)}/${t[0]}`:`${Pm(n)}/(${t.join("//")})`}}function JL(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Lm(n){return JL(n).replace(/%3B/gi,";")}function Nb(n){return JL(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Om(n){return decodeURIComponent(n)}function KL(n){return Om(n.replace(/\+/g,"%20"))}function QL(n){return`${Nb(n.path)}${function LX(n){return Object.entries(n).map(([e,t])=>`;${Nb(e)}=${Nb(t)}`).join("")}(n.parameters)}`}const FX=/^[^\/()?;#]+/;function Pb(n){const e=n.match(FX);return e?e[0]:""}const kX=/^[^\/()?;=#]+/,BX=/^[^=?&#]+/,zX=/^[^&#]+/;class GX{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new en([],{}):new en([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[wt]=new en(e,t)),i}parseSegment(){const e=Pb(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new te(4009,!1);return this.capture(e),new $h(Om(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function UX(n){const e=n.match(kX);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=Pb(this.remaining);r&&(i=r,this.capture(i))}e[Om(t)]=Om(i)}parseQueryParam(e){const t=function VX(n){const e=n.match(BX);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function HX(n){const e=n.match(zX);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=KL(t),s=KL(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Pb(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new te(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=wt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[wt]:new en([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new te(4011,!1)}}function e2(n){return n.segments.length>0?new en([],{[wt]:n}):n}function t2(n){const e={};for(const[i,r]of Object.entries(n.children)){const s=t2(r);if(i===wt&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function jX(n){if(1===n.numberOfChildren&&n.children[wt]){const e=n.children[wt];return new en(n.segments.concat(e.segments),e.children)}return n}(new en(n.segments,e))}function dl(n){return n instanceof cl}function n2(n){let e;const r=e2(function t(s){const o={};for(const l of s.children){const c=t(l);o[l.outlet]=c}const a=new en(s.url,o);return s===n&&(e=a),a}(n.root));return e??r}function i2(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(0===e.length)return Lb(r,r,r,t,i);const s=function WX(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new s2(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]="string"==typeof c?c.split("/"):c}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new s2(t,e,i)}(e);if(s.toRoot())return Lb(r,r,new en([],{}),t,i);const o=function qX(n,e,t){if(n.isAbsolute)return new km(e,!0,0);if(!t)return new km(e,!1,NaN);if(null===t.parent)return new km(t,!0,0);const i=Fm(n.commands[0])?0:1;return function XX(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new te(4005,!1);r=i.segments.length}return new km(i,!1,r-s)}(t,t.segments.length-1+i,n.numberOfDoubleDots)}(s,r,n),a=o.processChildren?Xh(o.segmentGroup,o.index,s.commands):o2(o.segmentGroup,o.index,s.commands);return Lb(r,o.segmentGroup,a,t,i)}function Fm(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function qh(n){return"object"==typeof n&&null!=n&&n.outlets}function Lb(n,e,t,i,r){let o,s={};i&&Object.entries(i).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`}),o=n===e?t:r2(n,e,t);const a=e2(t2(o));return new cl(a,s,r)}function r2(n,e,t){const i={};return Object.entries(n.children).forEach(([r,s])=>{i[r]=s===e?t:r2(s,e,t)}),new en(n.segments,i)}class s2{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Fm(i[0]))throw new te(4003,!1);const r=i.find(qh);if(r&&r!==$L(i))throw new te(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class km{segmentGroup;processChildren;index;constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function o2(n,e,t){if(n??=new en([],{}),0===n.segments.length&&n.hasChildren())return Xh(n,e,t);const i=function ZX(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(qh(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!l2(l,c,o))return s;i+=2}else{if(!l2(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new en(n.segments.slice(0,i.pathIndex),{});return s.children[wt]=new en(n.segments.slice(i.pathIndex),n.children),Xh(s,0,r)}return i.match&&0===r.length?new en(n.segments,{}):i.match&&!n.hasChildren()?Ob(n,e,t):i.match?Xh(n,0,r):Ob(n,e,t)}function Xh(n,e,t){if(0===t.length)return new en(n.segments,{});{const i=function YX(n){return qh(n[0])?n[0].outlets:{[wt]:n}}(t),r={};if(Object.keys(i).some(s=>s!==wt)&&n.children[wt]&&1===n.numberOfChildren&&0===n.children[wt].segments.length){const s=Xh(n.children[wt],e,t);return new en(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(r[s]=o2(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===i[s]&&(r[s]=o)}),new en(n.segments,r)}}function Ob(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(qh(s)){const l=JX(s.outlets);return new en(i,l)}if(0===r&&Fm(t[0])){i.push(new $h(n.segments[e].path,a2(t[0]))),r++;continue}const o=qh(s)?s.outlets[wt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Fm(a)?(i.push(new $h(o,a2(a))),r+=2):(i.push(new $h(o,{})),r++)}return new en(i,{})}function JX(n){const e={};return Object.entries(n).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(e[t]=Ob(new en([],{}),0,i))}),e}function a2(n){const e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function l2(n,e,t){return n==t.path&&Ts(e,t.parameters)}const Yh="imperative";var Rt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Rt||{});class Cs{id;url;constructor(e,t){this.id=e,this.url=t}}class Um extends Cs{type=Rt.NavigationStart;navigationTrigger;restoredState;constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class io extends Cs{urlAfterRedirects;type=Rt.NavigationEnd;constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var vr=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(vr||{}),Bm=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Bm||{});class hl extends Cs{reason;code;type=Rt.NavigationCancel;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class fu extends Cs{reason;code;type=Rt.NavigationSkipped;constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r}}class Fb extends Cs{error;target;type=Rt.NavigationError;constructor(e,t,i,r){super(e,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class c2 extends Cs{urlAfterRedirects;state;type=Rt.RoutesRecognized;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class KX extends Cs{urlAfterRedirects;state;type=Rt.GuardsCheckStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class QX extends Cs{urlAfterRedirects;state;shouldActivate;type=Rt.GuardsCheckEnd;constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class eY extends Cs{urlAfterRedirects;state;type=Rt.ResolveStart;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class tY extends Cs{urlAfterRedirects;state;type=Rt.ResolveEnd;constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class nY{route;type=Rt.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class iY{route;type=Rt.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class rY{snapshot;type=Rt.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class sY{snapshot;type=Rt.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class oY{snapshot;type=Rt.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class aY{snapshot;type=Rt.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class u2{routerEvent;position;anchor;type=Rt.Scroll;constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class kb{}class Vm{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}}function es(n){return n.outlet||wt}function Zh(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class fY{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Zh(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Jh(this.rootInjector)}}let Jh=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new fY(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||n)(_e(Ci))};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class d2{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Ub(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=Ub(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Bb(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Bb(e,this._root).map(t=>t.value)}}function Ub(n,e){if(n===e.value)return e;for(const t of e.children){const i=Ub(n,t);if(i)return i}return null}function Bb(n,e){if(n===e.value)return[e];for(const t of e.children){const i=Bb(n,t);if(i.length)return i.unshift(e),i}return[]}class ts{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function pu(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class h2 extends d2{snapshot;constructor(e,t){super(e),this.snapshot=t,Vb(this,e)}toString(){return this.snapshot.toString()}}function f2(n){const e=function pY(n){const s=new Hm([],{},{},"",{},wt,n,null,{});return new p2("",new ts(s,[]))}(n),t=new Cr([new $h("",{})]),i=new Cr({}),r=new Cr({}),s=new Cr({}),o=new Cr(""),a=new fl(t,i,s,o,r,wt,n,e.root);return a.snapshot=e.root,new h2(new ts(a,[]),e)}class fl{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,i,r,s,o,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(Ct(c=>c[jh]))??Xe(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Ct(e=>du(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Ct(e=>du(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function zm(n,e,t="emptyOnly"){let i;const{routeConfig:r}=n;return i=null===e||"always"!==t&&""!==r?.path&&(e.component||e.routeConfig?.loadComponent)?{params:{...n.params},data:{...n.data},resolve:{...n.data,...n._resolvedData??{}}}:{params:{...e.params,...n.params},data:{...e.data,...n.data},resolve:{...n.data,...e.data,...r?.data,...n._resolvedData}},r&&m2(r)&&(i.resolve[jh]=r.title),i}class Hm{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[jh]}constructor(e,t,i,r,s,o,a,l,c){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=du(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=du(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class p2 extends d2{url;constructor(e,t){super(t),this.url=e,Vb(this,t)}toString(){return g2(this._root)}}function Vb(n,e){e.value._routerState=n,e.children.forEach(t=>Vb(n,t))}function g2(n){const e=n.children.length>0?` { ${n.children.map(g2).join(", ")} } `:"";return`${n.value}${e}`}function zb(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Ts(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Ts(e.params,t.params)||n.paramsSubject.next(t.params),function TX(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Ts(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),Ts(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Hb(n,e){const t=Ts(n.params,e.params)&&function IX(n,e){return ul(n,e)&&n.every((t,i)=>Ts(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||Hb(n.parent,e.parent))}function m2(n){return"string"==typeof n.title||null===n.title}const gY=new oe("");let Gb=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=wt;activateEvents=new Xn;deactivateEvents=new Xn;attachEvents=new Xn;detachEvents=new Xn;routerOutletData=AB(void 0);parentContexts=W(Jh);location=W(fr);changeDetector=W(Ih);inputBinder=W(Gm,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new te(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new te(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new te(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new te(4013,!1);this._activatedRoute=t;const r=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new jb(t,a,r.injector,this.routerOutletData);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Ri({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Ua]})}return n})();class jb{route;childContexts;parent;outletData;__ngOutletInjector(e){return new jb(this.route,this.childContexts,e,this.outletData)}constructor(e,t,i,r){this.route=e,this.childContexts=t,this.parent=i,this.outletData=r}get(e,t){return e===fl?this.route:e===Jh?this.childContexts:e===gY?this.outletData:this.parent.get(e,t)}}const Gm=new oe("");let v2=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=Db([i.queryParams,i.params,i.data]).pipe(Qi(([s,o,a],l)=>(a={...s,...o,...a},0===l?Xe(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const o=function KW(n){const e=_t(n);if(!e)return null;const t=new dh(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(o)for(const{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();function Kh(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function vY(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Kh(n,i,r);return Kh(n,i)})}(n,e,t);return new ts(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Kh(n,a)),o}}const i=function yY(n){return new fl(new Cr(n.url),new Cr(n.params),new Cr(n.queryParams),new Cr(n.fragment),new Cr(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>Kh(n,s));return new ts(i,r)}}class $b{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}}const y2="ngNavigationCancelingError";function jm(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=dl(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=_2(!1,vr.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function _2(n,e){const t=new Error(`NavigationCancelingError: ${n||""}`);return t[y2]=!0,t.cancellationCode=e,t}function x2(n){return!!n&&n[y2]}class wY{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),zb(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=pu(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=pu(e);for(const o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=pu(e);for(const o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){const r=pu(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new aY(s.value.snapshot))}),e.children.length&&this.forwardEvent(new sY(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(zb(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),zb(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=r,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,i)}}class w2{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class $m{component;route;constructor(e,t){this.component=e,this.route=t}}function bY(n,e,t){const i=n._root;return Qh(i,e?e._root:null,t,[i.value])}function gu(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function k3(n){return null!==op(n)}(n)?e.get(n):n:i}function Qh(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=pu(e);return n.children.forEach(o=>{(function EY(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function SY(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!ul(n.url,e.url);case"pathParamsOrQueryParamsChange":return!ul(n.url,e.url)||!Ts(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Hb(n,e)||!Ts(n.queryParams,e.queryParams);default:return!Hb(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new w2(i)):(s.data=o.data,s._resolvedData=o._resolvedData),Qh(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new $m(a.outlet.component,o))}else o&&ef(e,a,r),r.canActivateChecks.push(new w2(i)),Qh(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>ef(a,t.getContext(o),r)),r}function ef(n,e,t){const i=pu(n),r=n.value;Object.entries(i).forEach(([s,o])=>{ef(o,r.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new $m(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function tf(n){return"function"==typeof n}function b2(n){return n instanceof Tm||"EmptyError"===n?.name}const Wm=Symbol("INITIAL_VALUE");function mu(){return Qi(n=>Db(n.map(e=>e.pipe(Ss(1),zL(Wm)))).pipe(Ct(e=>{for(const t of e)if(!0!==t){if(t===Wm)return Wm;if(!1===t||NY(t))return t}return!0}),no(e=>e!==Wm),Ss(1)))}function NY(n){return dl(n)||n instanceof $b}function M2(n){return function C3(...n){return tT(n)}(Oi(e=>{if("boolean"!=typeof e)throw jm(0,e)}),Ct(e=>!0===e))}class Wb{segmentGroup;constructor(e){this.segmentGroup=e||null}}class qm extends Error{urlTree;constructor(e){super(),this.urlTree=e}}function vu(n){return Dm(new Wb(n))}class $Y{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Xe(i);if(r.numberOfChildren>1||!r.children[wt])return Dm(new te(4e3,!1));r=r.children[wt]}}applyRedirectCommands(e,t,i,r,s){if("string"!=typeof t){const a=t,{queryParams:l,fragment:c,routeConfig:u,url:d,outlet:h,params:f,data:p,title:v}=r,m=Ar(s,()=>a({params:f,data:p,queryParams:l,fragment:c,routeConfig:u,url:d,outlet:h,title:v}));if(m instanceof cl)throw new qm(m);t=m}const o=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if("/"===t[0])throw new qm(o);return o}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new cl(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Object.entries(e).forEach(([r,s])=>{if("string"==typeof s&&":"===s[0]){const a=s.substring(1);i[r]=t[a]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Object.entries(t.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,i,r)}),new en(s,o)}createSegments(e,t,i,r){return t.map(s=>":"===s.path[0]?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new te(4001,!1);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}const qb={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function WY(n,e,t,i,r){const s=E2(n,e,t);return s.matched?(i=function lY(n,e){return n.providers&&!n._injector&&(n._injector=Tg(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,i),function HY(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?Xe(r.map(o=>{const a=gu(o,n);return ta(function RY(n){return n&&tf(n.canMatch)}(a)?a.canMatch(e,t):Ar(n,()=>a(e,t)))})).pipe(mu(),M2()):Xe(!0)}(i,e,t).pipe(Ct(o=>!0===o?s:{...qb}))):Xe(s)}function E2(n,e,t){if("**"===e.path)return function qY(n){return{matched:!0,parameters:n.length>0?$L(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}(t);if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...qb}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||SX)(t,n,e);if(!r)return{...qb};const s={};Object.entries(r.posParams??{}).forEach(([a,l])=>{s[a]=l.path});const o=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function S2(n,e,t,i){return t.length>0&&function ZY(n,e,t){return t.some(i=>Xm(n,e,i)&&es(i)!==wt)}(n,t,i)?{segmentGroup:new en(e,YY(i,new en(t,n.children))),slicedSegments:[]}:0===t.length&&function JY(n,e,t){return t.some(i=>Xm(n,e,i))}(n,t,i)?{segmentGroup:new en(n.segments,XY(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new en(n.segments,n.children),slicedSegments:t}}function XY(n,e,t,i){const r={};for(const s of t)if(Xm(n,e,s)&&!i[es(s)]){const o=new en([],{});r[es(s)]=o}return{...i,...r}}function YY(n,e){const t={};t[wt]=e;for(const i of n)if(""===i.path&&es(i)!==wt){const r=new en([],{});t[es(i)]=r}return t}function Xm(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class QY{}class nZ{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,i,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new $Y(this.urlSerializer,this.urlTree)}noMatchError(e){return new te(4002,`'${e.segmentGroup}'`)}recognize(){const e=S2(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(Ct(({children:t,rootSnapshot:i})=>{const r=new ts(i,t),s=new p2("",r),o=function $X(n,e,t=null,i=null){return i2(n2(n),e,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}))}match(e){const t=new Hm([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Object.freeze({}),wt,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,wt,t).pipe(Ct(i=>({children:i,rootSnapshot:t})),uu(i=>{if(i instanceof qm)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof Wb?this.noMatchError(i):i}))}processSegmentGroup(e,t,i,r,s){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i,s):this.processSegment(e,t,i,i.segments,r,!0,s).pipe(Ct(o=>o instanceof ts?[o]:[]))}processChildren(e,t,i,r){const s=[];for(const o of Object.keys(i.children))"primary"===o?s.unshift(o):s.push(o);return Kn(s).pipe(ll(o=>{const a=i.children[o],l=function hY(n,e){const t=n.filter(i=>es(i)===e);return t.push(...n.filter(i=>es(i)!==e)),t}(t,o);return this.processSegmentGroup(e,l,a,o,r)}),function bX(n,e){return Gn(function wX(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(Un(o,u=>{const d=c++;l=a?n(l,u,d):(a=!0,u),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}(n,e,arguments.length>=2,!0))}((o,a)=>(o.push(...a),o)),Am(null),function MX(n,e){const t=arguments.length>=2;return i=>i.pipe(n?no((r,s)=>n(r,s,i)):Do,Ib(1),t?Am(e):HL(()=>new Tm))}(),wi(o=>{if(null===o)return vu(i);const a=T2(o);return function iZ(n){n.sort((e,t)=>e.value.outlet===wt?-1:t.value.outlet===wt?1:e.value.outlet.localeCompare(t.value.outlet))}(a),Xe(a)}))}processSegment(e,t,i,r,s,o,a){return Kn(t).pipe(ll(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,i,r,s,o,a).pipe(uu(c=>{if(c instanceof Wb)return Xe(null);throw c}))),ea(l=>!!l),uu(l=>{if(b2(l))return function KY(n,e,t){return 0===e.length&&!n.children[t]}(i,r,s)?Xe(new QY):vu(i);throw l}))}processSegmentAgainstRoute(e,t,i,r,s,o,a,l){return es(i)===o||o!==wt&&Xm(r,s,i)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,r,i,s,o,l):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o,l):vu(r):vu(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o,a){const{matched:l,parameters:c,consumedSegments:u,positionalParamSegments:d,remainingSegments:h}=E2(t,r,s);if(!l)return vu(t);"string"==typeof r.redirectTo&&"/"===r.redirectTo[0]&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const f=new Hm(s,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,C2(r),es(r),r.component??r._loadedComponent??null,r,D2(r)),p=zm(f,a,this.paramsInheritanceStrategy);f.params=Object.freeze(p.params),f.data=Object.freeze(p.data);const v=this.applyRedirects.applyRedirectCommands(u,r.redirectTo,d,f,e);return this.applyRedirects.lineralizeSegments(r,v).pipe(wi(m=>this.processSegment(e,i,t,m.concat(h),o,!1,a)))}matchSegmentAgainstRoute(e,t,i,r,s,o){const a=WY(t,i,r,e);return"**"===i.path&&(t.children={}),a.pipe(Qi(l=>l.matched?this.getChildConfig(e=i._injector??e,i,r).pipe(Qi(({routes:c})=>{const u=i._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:f}=l,p=new Hm(h,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,C2(i),es(i),i.component??i._loadedComponent??null,i,D2(i)),v=zm(p,o,this.paramsInheritanceStrategy);p.params=Object.freeze(v.params),p.data=Object.freeze(v.data);const{segmentGroup:m,slicedSegments:g}=S2(t,h,f,c);if(0===g.length&&m.hasChildren())return this.processChildren(u,c,m,p).pipe(Ct(_=>new ts(p,_)));if(0===c.length&&0===g.length)return Xe(new ts(p,[]));const y=es(i)===s;return this.processSegment(u,c,m,g,y?wt:s,!0,p).pipe(Ct(_=>new ts(p,_ instanceof ts?[_]:[])))})):vu(t)))}getChildConfig(e,t,i){return t.children?Xe({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Xe({routes:t._loadedRoutes,injector:t._loadedInjector}):function zY(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?Xe(!0):Xe(r.map(o=>{const a=gu(o,n);return ta(function CY(n){return n&&tf(n.canLoad)}(a)?a.canLoad(e,t):Ar(n,()=>a(e,t)))})).pipe(mu(),M2())}(e,t,i).pipe(wi(r=>r?this.configLoader.loadChildren(e,t).pipe(Oi(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function jY(){return Dm(_2(!1,vr.GuardRejected))}())):Xe({routes:[],injector:e})}}function rZ(n){const e=n.value.routeConfig;return e&&""===e.path}function T2(n){const e=[],t=new Set;for(const i of n){if(!rZ(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=T2(i.children);e.push(new ts(i.value,r))}return e.filter(i=>!t.has(i))}function C2(n){return n.data||{}}function D2(n){return n.resolve||{}}function A2(n){const e=n.children.map(t=>A2(t)).flat();return[n,...e]}function Xb(n){return Qi(e=>{const t=n(e);return t?Kn(t).pipe(Ct(()=>e)):Xe(e)})}let I2=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===wt);return i}getResolvedTitleForRoute(t){return t.data[jh]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:()=>W(uZ),providedIn:"root"})}return n})(),uZ=(()=>{class n extends I2{title;constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(_e(yq))};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const yu=new oe("",{providedIn:"root",factory:()=>({})});let R2=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zs({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){1&i&&$t(0,"router-outlet")},dependencies:[Gb],encapsulation:2})}return n})();function Yb(n){const e=n.children&&n.children.map(Yb),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==wt&&(t.component=R2),t}const _u=new oe("");let Zb=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=W(TN);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Xe(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=ta(t.loadComponent()).pipe(Ct(N2),Oi(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Im(()=>{this.componentLoaders.delete(t)})),r=new VL(i,()=>new ii).pipe(Ab());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Xe({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=function dZ(n,e,t,i){return ta(n.loadChildren()).pipe(Ct(N2),wi(r=>r instanceof B1||Array.isArray(r)?Xe(r):Kn(e.compileModuleAsync(r))),Ct(r=>{i&&i(n);let s,o,a=!1;return Array.isArray(r)?(o=r,!0):(s=r.create(t).injector,o=s.get(_u,[],{optional:!0,self:!0}).flat()),{routes:o.map(Yb),injector:s}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(Im(()=>{this.childrenLoaders.delete(i)})),o=new VL(s,()=>new ii).pipe(Ab());return this.childrenLoaders.set(i,o),o}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function N2(n){return function hZ(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let Jb=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:()=>W(fZ),providedIn:"root"})}return n})(),fZ=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const P2=new oe(""),L2=new oe("");function pZ(n,e,t){const i=n.get(L2),r=n.get(Ki);return n.get(Ot).runOutsideAngular(()=>{if(!r.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,new Promise(c=>setTimeout(c));let s;const o=new Promise(c=>{s=c}),a=r.startViewTransition(()=>(s(),function gZ(n){return new Promise(e=>{Ud({read:()=>setTimeout(e)},{injector:n})})}(n))),{onViewTransitionCreated:l}=i;return l&&Ar(n,()=>l({transition:a,from:e,to:t})),o})}const Kb=new oe("");let Ym=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new ii;transitionAbortSubject=new ii;configLoader=W(Zb);environmentInjector=W(Ci);urlSerializer=W(hu);rootContexts=W(Jh);location=W(Oh);inputBindingEnabled=null!==W(Gm,{optional:!0});titleStrategy=W(I2);options=W(yu,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=W(Jb);createViewTransition=W(P2,{optional:!0});navigationErrorHandler=W(Kb,{optional:!0});navigationId=0;get hasRequestedNavigation(){return 0!==this.navigationId}transitions;afterPreactivation=()=>Xe(void 0);rootComponentType=null;constructor(){this.configLoader.onLoadEndListener=r=>this.events.next(new iY(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new nY(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new Cr({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Yh,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(no(s=>0!==s.id),Ct(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Qi(s=>{let o=!1,a=!1;return Xe(s).pipe(Qi(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",vr.SupersededByNewNavigation),Qr;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:"string"==typeof l.extras.browserUrl?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null};const c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!c&&"reload"!==(l.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const d="";return this.events.next(new fu(l.id,this.urlSerializer.serialize(l.rawUrl),d,Bm.IgnoredSameUrlNavigation)),l.resolve(!1),Qr}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return Xe(l).pipe(Qi(d=>{const h=this.transitions?.getValue();return this.events.next(new Um(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),h!==this.transitions?.getValue()?Qr:Promise.resolve(d)}),function sZ(n,e,t,i,r,s){return wi(o=>function eZ(n,e,t,i,r,s,o="emptyOnly"){return new nZ(n,e,t,i,r,o,s).recognize()}(n,e,t,i,o.extractedUrl,r,s).pipe(Ct(({state:a,tree:l})=>({...o,targetSnapshot:a,urlAfterRedirects:l}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Oi(d=>{s.targetSnapshot=d.targetSnapshot,s.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects};const h=new c2(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){const{id:d,extractedUrl:h,source:f,restoredState:p,extras:v}=l,m=new Um(d,this.urlSerializer.serialize(h),f,p);this.events.next(m);const g=f2(this.rootComponentType).snapshot;return this.currentTransition=s={...l,targetSnapshot:g,urlAfterRedirects:h,extras:{...v,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=h,Xe(s)}{const d="";return this.events.next(new fu(l.id,this.urlSerializer.serialize(l.extractedUrl),d,Bm.IgnoredByUrlHandlingStrategy)),l.resolve(!1),Qr}}),Oi(l=>{const c=new KX(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),Ct(l=>(this.currentTransition=s={...l,guards:bY(l.targetSnapshot,l.currentSnapshot,this.rootContexts)},s)),function PY(n,e){return wi(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Xe({...t,guardsResult:!0}):function LY(n,e,t,i){return Kn(n).pipe(wi(r=>function VY(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Xe(s.map(a=>{const l=Zh(e)??r,c=gu(a,l);return ta(function IY(n){return n&&tf(n.canDeactivate)}(c)?c.canDeactivate(n,e,t,i):Ar(l,()=>c(n,e,t,i))).pipe(ea())})).pipe(mu()):Xe(!0)}(r.component,r.route,t,e,i)),ea(r=>!0!==r,!0))}(o,i,r,n).pipe(wi(a=>a&&function TY(n){return"boolean"==typeof n}(a)?function OY(n,e,t,i){return Kn(e).pipe(ll(r=>Gh(function kY(n,e){return null!==n&&e&&e(new rY(n)),Xe(!0)}(r.route.parent,i),function FY(n,e){return null!==n&&e&&e(new oY(n)),Xe(!0)}(r.route,i),function BY(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function MY(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>Cm(()=>Xe(o.guards.map(l=>{const c=Zh(o.node)??t,u=gu(l,c);return ta(function AY(n){return n&&tf(n.canActivateChild)}(u)?u.canActivateChild(i,n):Ar(c,()=>u(i,n))).pipe(ea())})).pipe(mu())));return Xe(s).pipe(mu())}(n,r.path,t),function UY(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return Xe(!0);const r=i.map(s=>Cm(()=>{const o=Zh(e)??t,a=gu(s,o);return ta(function DY(n){return n&&tf(n.canActivate)}(a)?a.canActivate(e,n):Ar(o,()=>a(e,n))).pipe(ea())}));return Xe(r).pipe(mu())}(n,r.route,t))),ea(r=>!0!==r,!0))}(i,s,n,e):Xe(a)),Ct(a=>({...t,guardsResult:a})))})}(this.environmentInjector,l=>this.events.next(l)),Oi(l=>{if(s.guardsResult=l.guardsResult,l.guardsResult&&"boolean"!=typeof l.guardsResult)throw jm(0,l.guardsResult);const c=new QX(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),no(l=>!!l.guardsResult||(this.cancelNavigationTransition(l,"",vr.GuardRejected),!1)),Xb(l=>{if(l.guards.canActivateChecks.length)return Xe(l).pipe(Oi(c=>{const u=new eY(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),Qi(c=>{let u=!1;return Xe(c).pipe(function oZ(n,e){return wi(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Xe(t);const s=new Set(r.map(l=>l.route)),o=new Set;for(const l of s)if(!o.has(l))for(const c of A2(l))o.add(c);let a=0;return Kn(o).pipe(ll(l=>s.has(l)?function aZ(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!m2(r)&&(s[jh]=r.title),function lZ(n,e,t,i){const r=Rb(n);if(0===r.length)return Xe({});const s={};return Kn(r).pipe(wi(o=>function cZ(n,e,t,i){const r=Zh(e)??i,s=gu(n,r);return ta(s.resolve?s.resolve(e,t):Ar(r,()=>s(e,t)))}(n[o],e,t,i).pipe(ea(),Oi(a=>{if(a instanceof $b)throw jm(new Nm,a);s[o]=a}))),Ib(1),Ct(()=>s),uu(o=>b2(o)?Qr:Dm(o)))}(s,n,e,i).pipe(Ct(o=>(n._resolvedData=o,n.data=zm(n,n.parent,t).resolve,null)))}(l,i,n,e):(l.data=zm(l,l.parent,n).resolve,Xe(void 0))),Oi(()=>a++),Ib(1),wi(l=>a===o.size?Xe(t):Qr))})}(this.paramsInheritanceStrategy,this.environmentInjector),Oi({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(c,"",vr.NoDataFromResolver)}}))}),Oi(c=>{const u=new tY(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}))}),Xb(l=>{const c=u=>{const d=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(u.routeConfig).pipe(Oi(h=>{u.component=h}),Ct(()=>{})));for(const h of u.children)d.push(...c(h));return d};return Db(c(l.targetSnapshot.root)).pipe(Am(null),Ss(1))}),Xb(()=>this.afterPreactivation()),Qi(()=>{const{currentSnapshot:l,targetSnapshot:c}=s,u=this.createViewTransition?.(this.environmentInjector,l.root,c.root);return u?Kn(u).pipe(Ct(()=>s)):Xe(s)}),Ct(l=>{const c=function mY(n,e,t){const i=Kh(n,e._root,t?t._root:void 0);return new h2(i,e)}(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s={...l,targetRouterState:c},this.currentNavigation.targetRouterState=c,s}),Oi(()=>{this.events.next(new kb)}),((n,e,t,i)=>Ct(r=>(new wY(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)))(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Ss(1),Oi({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new io(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),GL(this.transitionAbortSubject.pipe(Oi(l=>{throw l}))),Im(()=>{!o&&!a&&this.cancelNavigationTransition(s,"",vr.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),uu(l=>{if(a=!0,x2(l))this.events.next(new hl(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),function _Y(n){return x2(n)&&dl(n.url)}(l)?this.events.next(new Vm(l.url,l.navigationBehaviorOptions)):s.resolve(!1);else{const c=new Fb(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0);try{const u=Ar(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(!(u instanceof $b))throw this.events.next(c),l;{const{message:d,cancellationCode:h}=jm(0,u);this.events.next(new hl(s.id,this.urlSerializer.serialize(s.extractedUrl),d,h)),this.events.next(new Vm(u.redirectTo,u.navigationBehaviorOptions))}}catch(u){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(u)}}return Qr}))}))}cancelNavigationTransition(t,i,r){const s=new hl(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){const t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function mZ(n){return n!==Yh}let vZ=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:()=>W(_Z),providedIn:"root"})}return n})();class yZ{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let _Z=(()=>{class n extends yZ{static \u0275fac=(()=>{let t;return function(r){return(t||(t=yc(n)))(r||n)}})();static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),O2=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:()=>W(xZ),providedIn:"root"})}return n})(),xZ=(()=>{class n extends O2{location=W(Oh);urlSerializer=W(hu);options=W(yu,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=W(Jb);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new cl;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=f2(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{"popstate"===i.type&&t(i.url,i.state)})}handleRouterEvent(t,i){if(t instanceof Um)this.stateMemento=this.createStateMemento();else if(t instanceof fu)this.rawUrlTree=i.initialUrl;else if(t instanceof c2){if("eager"===this.urlUpdateStrategy&&!i.extras.skipLocationChange){const r=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(i.targetBrowserUrl??r,i)}}else t instanceof kb?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,"deferred"===this.urlUpdateStrategy&&!i.extras.skipLocationChange&&this.setBrowserUrl(i.targetBrowserUrl??this.rawUrlTree,i)):t instanceof hl&&(t.code===vr.GuardRejected||t.code===vr.NoDataFromResolver)?this.restoreHistory(i):t instanceof Fb?this.restoreHistory(i,!0):t instanceof io&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,i){const r=t instanceof cl?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",o)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&0===s&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=yc(n)))(r||n)}})();static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function F2(n,e){n.events.pipe(no(t=>t instanceof io||t instanceof hl||t instanceof Fb||t instanceof fu),Ct(t=>t instanceof io||t instanceof fu?0:t instanceof hl&&(t.code===vr.Redirect||t.code===vr.SupersededByNewNavigation)?2:1),no(t=>2!==t),Ss(1)).subscribe(()=>{e()})}const wZ={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},bZ={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ro=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=W(sI);stateManager=W(O2);options=W(yu,{optional:!0})||{};pendingTasks=W(ms);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=W(Ym);urlSerializer=W(hu);location=W(Oh);urlHandlingStrategy=W(Jb);_events=new ii;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=W(vZ);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=W(_u,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!W(Gm,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Ut;subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(null!==r&&null!==s)if(this.stateManager.handleRouterEvent(i,s),i instanceof hl&&i.code!==vr.Redirect&&i.code!==vr.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof io)this.navigated=!0;else if(i instanceof Vm){const o=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l={browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||"eager"===this.urlUpdateStrategy||mZ(r.source),...o};this.scheduleNavigation(a,Yh,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}(function EZ(n){return!(n instanceof kb||n instanceof Vm)})(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Yh,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",i)},0)})}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){const l={...r};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Yb),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=l?this.currentUrlTree.fragment:o;let d,u=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":u={...this.currentUrlTree.queryParams,...s};break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}null!==u&&(u=this.removeEmptyProps(u));try{d=n2(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||"/"!==t[0][0])&&(t=[]),d=this.currentUrlTree.root}return i2(d,t,u,c??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=dl(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,Yh,null,i)}navigate(t,i={skipLocationChange:!1}){return function MZ(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new te(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let r;if(r=!0===i?{...wZ}:!1===i?{...bZ}:i,dl(t))return qL(this.currentUrlTree,t,r);const s=this.parseUrl(t);return qL(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,s])=>(null!=s&&(i[r]=s),i),{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,c;o?(a=o.resolve,l=o.reject,c=o.promise):c=new Promise((d,h)=>{a=d,l=h});const u=this.pendingTasks.add();return F2(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(d=>Promise.reject(d))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),nf=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new ii;constructor(t,i,r,s,o,a){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=s,this.el=o,this.locationStrategy=a;const l=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=t.events.subscribe(c=>{c instanceof io&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){null==t?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(this.routerLinkInput=dl(t)||Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,s,o){const a=this.urlTree;return!!(null===a||this.isAnchorElement&&(0!==t||i||r||s||o||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(a,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const t=this.urlTree;this.href=null!==t&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;const i=null===this.href?null:function JD(n,e,t){return function mz(n,e){return"src"===e&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===e&&("base"===n||"link"===n)?j0:zo}(e,t)(n)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(t,i){const r=this.renderer,s=this.el.nativeElement;null!==i?r.setAttribute(s,t,i):r.removeAttribute(s,t)}get urlTree(){return null===this.routerLinkInput?null:dl(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(Be(ro),Be(fl),function Id(n){return function rB(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(aC(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(xt(),n)}("tabindex"),Be(bg),Be(ys),Be(al))};static \u0275dir=Ri({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,r){1&i&&Mh("click",function(o){return r.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&i&&iw("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",jw],skipLocationChange:[2,"skipLocationChange","skipLocationChange",jw],replaceUrl:[2,"replaceUrl","replaceUrl",jw],routerLink:"routerLink"},features:[Z1,Ua]})}return n})();class k2{}let CZ=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(t,i,r,s,o){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(no(t=>t instanceof io),ll(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=Tg(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(a,s.children??s._loadedRoutes))}return Kn(r).pipe(cu())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):Xe(null);const s=r.pipe(wi(o=>null===o?Xe(void 0):(i._loadedRoutes=o.routes,i._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return i.loadComponent&&!i._loadedComponent?Kn([s,this.loader.loadComponent(i)]).pipe(cu()):s})}static \u0275fac=function(i){return new(i||n)(_e(ro),_e(TN),_e(Ci),_e(k2),_e(Zb))};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Qb=new oe("");let U2=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(t,i,r,s,o={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=o,o.scrollPositionRestoration||="disabled",o.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Um?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof io?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof fu&&t.code===Bm.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof u2&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new u2(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(i){!function uA(){throw new Error("invalid")}()};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();function B2(n){return n.routerState.root}function Ds(n,e){return{\u0275kind:n,\u0275providers:e}}function V2(){const n=W(Pn);return e=>{const t=n.get(pr);if(e!==t.components[0])return;const i=n.get(ro),r=n.get(z2);1===n.get(eM)&&i.initialNavigation(),n.get(H2,null,Dt.Optional)?.setUpPreloading(),n.get(Qb,null,Dt.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const z2=new oe("",{factory:()=>new ii}),eM=new oe("",{providedIn:"root",factory:()=>1}),H2=new oe("");function NZ(n){return Ds(0,[{provide:H2,useExisting:CZ},{provide:k2,useExisting:n}])}function LZ(n){return Ds(9,[{provide:P2,useValue:pZ},{provide:L2,useValue:{skipNextTransition:!!n?.skipInitialTransition,...n}}])}const OZ=[Oh,{provide:hu,useClass:Nm},ro,Jh,{provide:fl,useFactory:B2,deps:[ro]},Zb,[]];let tM=(()=>{class n{constructor(){}static forRoot(t,i){return{ngModule:n,providers:[OZ,[],{provide:_u,multi:!0,useValue:t},[],i?.errorHandler?{provide:Kb,useValue:i.errorHandler}:[],{provide:yu,useValue:i||{}},i?.useHash?{provide:al,useClass:i9}:{provide:al,useClass:SP},{provide:Qb,useFactory:()=>{const n=W(v7),e=W(Ot),t=W(yu),i=W(Ym),r=W(hu);return t.scrollOffset&&n.setOffset(t.scrollOffset),new U2(r,i,n,e,t)}},i?.preloadingStrategy?NZ(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?BZ(i):[],i?.bindToComponentInputs?Ds(8,[v2,{provide:Gm,useExisting:v2}]).\u0275providers:[],i?.enableViewTransitions?LZ().\u0275providers:[],[{provide:G2,useFactory:V2},{provide:jc,multi:!0,useExisting:G2}]]}}static forChild(t){return{ngModule:n,providers:[{provide:_u,multi:!0,useValue:t}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=Vc({type:n});static \u0275inj=Ra({})}return n})();function BZ(n){return["disabled"===n.initialNavigation?Ds(3,[{provide:Fg,multi:!0,useFactory:()=>{const e=W(ro);return()=>{e.setUpLocationChangeListener()}}},{provide:eM,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?Ds(2,[{provide:eM,useValue:0},{provide:Fg,multi:!0,deps:[Pn],useFactory:e=>{const t=e.get(t9,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(ro),s=e.get(z2);F2(r,()=>{i(!0)}),e.get(Ym).afterPreactivation=()=>(i(!0),s.closed?Xe(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const G2=new oe("");class Zm{}class Jm{}class kr{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=t.slice(i+1).trim();this.addHeaderEntry(r,s)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof kr?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new kr;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof kr?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}addHeaderEntry(e,t){const i=e.toLowerCase();this.maybeSetNormalizedName(e,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(e,t){const i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class HZ{encodeKey(e){return j2(e)}encodeValue(e){return j2(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const jZ=/%(\d[a-f0-9])/gi,$Z={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function j2(n){return encodeURIComponent(n).replace(jZ,(e,t)=>$Z[t]??e)}function Km(n){return`${n}`}class na{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new HZ,e.fromString){if(e.fromObject)throw new te(2805,!1);this.map=function GZ(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(Km):[Km(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new na({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Km(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(Km(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class WZ{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function $2(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function W2(n){return typeof Blob<"u"&&n instanceof Blob}function q2(n){return typeof FormData<"u"&&n instanceof FormData}const rf="Content-Type",nM="X-Request-URL",X2="text/plain",Y2="application/json",Z2=`${Y2}, ${X2}, */*`;class sf{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(e,t,i,r){let s;if(this.url=t,this.method=e.toUpperCase(),function qZ(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new kr,this.context??=new WZ,this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new na,this.urlWithParams=t}serializeBody(){return null===this.body?null:"string"==typeof this.body||$2(this.body)||W2(this.body)||q2(this.body)||function XZ(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)?this.body:this.body instanceof na?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||q2(this.body)?null:W2(this.body)?this.body.type||null:$2(this.body)?null:"string"==typeof this.body?X2:this.body instanceof na?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?Y2:null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=void 0!==e.body?e.body:this.body,a=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress;let c=e.headers||this.headers,u=e.params||this.params;const d=e.context??this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((h,f)=>h.set(f,e.setHeaders[f]),c)),e.setParams&&(u=Object.keys(e.setParams).reduce((h,f)=>h.set(f,e.setParams[f]),u)),new sf(t,i,o,{params:u,headers:c,context:d,reportProgress:l,responseType:r,withCredentials:a,transferCache:s})}}var ia=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(ia||{});class iM{headers;status;statusText;url;ok;type;constructor(e,t=200,i="OK"){this.headers=e.headers||new kr,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class Qm extends iM{constructor(e={}){super(e)}type=ia.ResponseHeader;clone(e={}){return new Qm({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class pl extends iM{body;constructor(e={}){super(e),this.body=void 0!==e.body?e.body:null}type=ia.Response;clone(e={}){return new pl({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class xu extends iM{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function rM(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}let ev=(()=>{class n{handler;constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof sf)s=t;else{let l,c;l=r.headers instanceof kr?r.headers:new kr(r.headers),r.params&&(c=r.params instanceof na?r.params:new na({fromObject:r.params})),s=new sf(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}const o=Xe(s).pipe(ll(l=>this.handler.handle(l)));if(t instanceof sf||"events"===r.observe)return o;const a=o.pipe(no(l=>l instanceof pl));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(Ct(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(Ct(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(Ct(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(Ct(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new na).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,rM(r,i))}post(t,i,r={}){return this.request("POST",t,rM(r,i))}put(t,i,r={}){return this.request("PUT",t,rM(r,i))}static \u0275fac=function(i){return new(i||n)(_e(Zm))};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();const Q2=new oe("");function eO(n,e){return e(n)}const af=new oe(""),tO=new oe(""),nO=new oe("",{providedIn:"root",factory:()=>!0});let iO=(()=>{class n extends Zm{backend;injector;chain=null;pendingTasks=W(ms);contributeToStability=W(nO);constructor(t,i){super(),this.backend=t,this.injector=i}handle(t){if(null===this.chain){const i=Array.from(new Set([...this.injector.get(af),...this.injector.get(tO,[])]));this.chain=i.reduceRight((r,s)=>function tJ(n,e,t){return(i,r)=>Ar(t,()=>e(i,s=>n(s,r)))}(r,s,this.injector),eO)}if(this.contributeToStability){const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(Im(()=>this.pendingTasks.remove(i)))}return this.chain(t,i=>this.backend.handle(i))}static \u0275fac=function(i){return new(i||n)(_e(Jm),_e(Ci))};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();const lJ=/^\)\]\}',?\n/,cJ=RegExp(`^${nM}:`,"m");let sO=(()=>{class n{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new te(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?Kn(i.\u0275loadImpl()):Xe(null)).pipe(Qi(()=>new Nn(s=>{const o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((v,m)=>o.setRequestHeader(v,m.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept",Z2),!t.headers.has(rf)){const v=t.detectContentTypeHeader();null!==v&&o.setRequestHeader(rf,v)}if(t.responseType){const v=t.responseType.toLowerCase();o.responseType="json"!==v?v:"text"}const a=t.serializeBody();let l=null;const c=()=>{if(null!==l)return l;const v=o.statusText||"OK",m=new kr(o.getAllResponseHeaders()),g=function uJ(n){return"responseURL"in n&&n.responseURL?n.responseURL:cJ.test(n.getAllResponseHeaders())?n.getResponseHeader(nM):null}(o)||t.url;return l=new Qm({headers:m,status:o.status,statusText:v,url:g}),l},u=()=>{let{headers:v,status:m,statusText:g,url:y}=c(),_=null;204!==m&&(_=typeof o.response>"u"?o.responseText:o.response),0===m&&(m=_?200:0);let x=m>=200&&m<300;if("json"===t.responseType&&"string"==typeof _){const T=_;_=_.replace(lJ,"");try{_=""!==_?JSON.parse(_):null}catch(E){_=T,x&&(x=!1,_={error:E,text:_})}}x?(s.next(new pl({body:_,headers:v,status:m,statusText:g,url:y||void 0})),s.complete()):s.error(new xu({error:_,headers:v,status:m,statusText:g,url:y||void 0}))},d=v=>{const{url:m}=c(),g=new xu({error:v,status:o.status||0,statusText:o.statusText||"Unknown Error",url:m||void 0});s.error(g)};let h=!1;const f=v=>{h||(s.next(c()),h=!0);let m={type:ia.DownloadProgress,loaded:v.loaded};v.lengthComputable&&(m.total=v.total),"text"===t.responseType&&o.responseText&&(m.partialText=o.responseText),s.next(m)},p=v=>{let m={type:ia.UploadProgress,loaded:v.loaded};v.lengthComputable&&(m.total=v.total),s.next(m)};return o.addEventListener("load",u),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),t.reportProgress&&(o.addEventListener("progress",f),null!==a&&o.upload&&o.upload.addEventListener("progress",p)),o.send(a),s.next({type:ia.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",u),o.removeEventListener("timeout",d),t.reportProgress&&(o.removeEventListener("progress",f),null!==a&&o.upload&&o.upload.removeEventListener("progress",p)),o.readyState!==o.DONE&&o.abort()}})))}static \u0275fac=function(i){return new(i||n)(_e(WP))};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();const aM=new oe(""),oO=new oe("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),aO=new oe("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class lO{}let fJ=(()=>{class n{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=OP(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(i){return new(i||n)(_e(Ki),_e(ko),_e(oO))};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();function pJ(n,e){const t=n.url.toLowerCase();if(!W(aM)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=W(lO).getToken(),r=W(aO);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}let DJ=(()=>{class n{http;prefix;suffix;constructor(t,i="/assets/i18n/",r=".json"){this.http=t,this.prefix=i,this.suffix=r}getTranslation(t){return this.http.get(`${this.prefix}${t}${this.suffix}`)}static \u0275fac=function(i){return new(i||n)(_e(ev),_e(String),_e(String))};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();const lM=[{id:"metal-tales-overkill",name:"projects.metal-tales-overkill.name",shortDescription:"projects.metal-tales-overkill.shortDescription",fullDescription:"projects.metal-tales-overkill.fullDescription",technologies:["projects.metal-tales-overkill.technologies.tech1","projects.metal-tales-overkill.technologies.tech2","projects.metal-tales-overkill.technologies.tech3","projects.metal-tales-overkill.technologies.tech4"],imageUrl:"../../assets/imgs/projects/Metal-Tales/metal-tales-splash.jpg",startDate:"2021-01-21",endDate:"2022-03-14",features:["projects.metal-tales-overkill.features.feature1","projects.metal-tales-overkill.features.feature2","projects.metal-tales-overkill.features.feature3","projects.metal-tales-overkill.features.feature4","projects.metal-tales-overkill.features.feature5"],challenges:["projects.metal-tales-overkill.challenges.challenge1","projects.metal-tales-overkill.challenges.challenge2","projects.metal-tales-overkill.challenges.challenge3"],screenshots:["../../assets/imgs/projects/Metal-Tales/metal-tales-screenshot1.jpg","../../assets/imgs/projects/Metal-Tales/metal-tales-screenshot2.jpg","../../assets/imgs/projects/Metal-Tales/metal-tales-screenshot3.webp","../../assets/imgs/projects/Metal-Tales/metal-tales-screenshot4.webp"],videos:[{url:"https://www.youtube.com/embed/a12fO7KuPgA?si=Lie3X1eb94_kj-Jl",poster:"../../assets/imgs/projects/Metal-Tales/metal-tales-splash.jpg",title:"Metal Tales: Overkill - Gameplay PS4"}]},{id:"sonar-beat",name:"projects.sonar-beat.name",shortDescription:"projects.sonar-beat.shortDescription",fullDescription:"projects.sonar-beat.fullDescription",technologies:["PS4 Port","Switch Port","Unity","C#"],imageUrl:"../../assets/imgs/projects/Sonar-Beat/sonar-beat-splash.jpg",startDate:"2022-04-14",endDate:"2024-05-24",features:["projects.sonar-beat.features.feature1","projects.sonar-beat.features.feature2","projects.sonar-beat.features.feature3","projects.sonar-beat.features.feature4"],challenges:["projects.sonar-beat.challenges.challenge1","projects.sonar-beat.challenges.challenge2","projects.sonar-beat.challenges.challenge3"],screenshots:["../../assets/imgs/projects/Sonar-Beat/sonar-beat-screenshot1.avif","../../assets/imgs/projects/Sonar-Beat/sonar-beat-screenshot2.jpg"],videos:[{url:"https://www.youtube.com/embed/fjjEnQlarcU?si=x4qqOwYqrBzKlMua",poster:"../../assets/imgs/projects/Sonar-Beat/sonar-beat-splash.jpg",title:"Sonar Beat Trailer (PS4 Asia)"}]}];let AJ=(()=>{class n{sanitizer;constructor(t){this.sanitizer=t}transform(t,i){switch(i){case"html":default:return this.sanitizer.bypassSecurityTrustHtml(t);case"style":return this.sanitizer.bypassSecurityTrustStyle(t);case"script":return this.sanitizer.bypassSecurityTrustScript(t);case"url":return this.sanitizer.bypassSecurityTrustUrl(t);case"resourceUrl":return this.sanitizer.bypassSecurityTrustResourceUrl(t)}}static \u0275fac=function(i){return new(i||n)(Be(Vh,16))};static \u0275pipe=li({name:"safe",type:n,pure:!0})}return n})();const cM={now:()=>(cM.delegate||Date).now(),delegate:void 0};class RJ extends ii{constructor(e=1/0,t=1/0,i=cM){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:o}=this;t||(i.push(e),!r&&i.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:i,_buffer:r}=this,s=r.slice();for(let o=0;o<s.length&&!e.closed;o+=i?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<i.length&&i.splice(0,i.length-s),!r){const o=t.now();let a=0;for(let l=1;l<i.length&&i[l]<=o;l+=2)a=l;a&&i.splice(0,a+1)}}}function uM(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new md({next:()=>{i.unsubscribe(),n()}});return mr(e(...t)).subscribe(i)}function dM(n,e,t){let i,r=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=n):i=n??1/0,function NJ(n={}){const{connector:e=()=>new ii,resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,a,l,c=0,u=!1,d=!1;const h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=l=void 0,u=d=!1},p=()=>{const v=o;f(),v?.unsubscribe()};return Gn((v,m)=>{c++,!d&&!u&&h();const g=l=l??e();m.add(()=>{c--,0===c&&!d&&!u&&(a=uM(p,r))}),g.subscribe(m),!o&&c>0&&(o=new md({next:y=>g.next(y),error:y=>{d=!0,h(),a=uM(f,t,y),g.error(y)},complete:()=>{u=!0,h(),a=uM(f,i),g.complete()}}),mr(v).subscribe(o))})(s)}}({connector:()=>new RJ(i,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}class wu{}let hM=(()=>{class n extends wu{getTranslation(t){return Xe({})}static \u0275fac=(()=>{let t;return function(r){return(t||(t=yc(n)))(r||n)}})();static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();class nv{}let fM=(()=>{class n{handle(t){return t.key}static \u0275fac=function(i){return new(i||n)};static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();function iv(n,e){if(n===e)return!0;if(null===n||null===e)return!1;if(n!=n&&e!=e)return!0;const t=typeof n;let r,s,o;if(t==typeof e&&"object"==t){if(!Array.isArray(n)){if(Array.isArray(e))return!1;for(s in o=Object.create(null),n){if(!iv(n[s],e[s]))return!1;o[s]=!0}for(s in e)if(!(s in o)&&typeof e[s]<"u")return!1;return!0}if(!Array.isArray(e))return!1;if((r=n.length)==e.length){for(s=0;s<r;s++)if(!iv(n[s],e[s]))return!1;return!0}}return!1}function sa(n){return typeof n<"u"&&null!==n}function lf(n){return rv(n)&&!pM(n)&&null!==n}function rv(n){return"object"==typeof n}function pM(n){return Array.isArray(n)}function gM(n){return"string"==typeof n}function mM(n,e){const t=Object.assign({},n);return rv(n)?(rv(n)&&rv(e)&&Object.keys(e).forEach(i=>{lf(e[i])?i in n?t[i]=mM(n[i],e[i]):Object.assign(t,{[i]:e[i]}):Object.assign(t,{[i]:e[i]})}),t):mM({},e)}function vM(n,e){const t=e.split(".");e="";do{e+=t.shift(),sa(n)&&sa(n[e])&&(lf(n[e])||pM(n[e])||!t.length)?(n=n[e],e=""):t.length?e+=".":n=void 0}while(t.length);return n}class cf{}let yM=(()=>{class n extends cf{templateMatcher=/{{\s?([^{}\s]*)\s?}}/g;interpolate(t,i){return gM(t)?this.interpolateString(t,i):function PJ(n){return"function"==typeof n}(t)?this.interpolateFunction(t,i):void 0}interpolateFunction(t,i){return t(i)}interpolateString(t,i){return i?t.replace(this.templateMatcher,(r,s)=>{const o=vM(i,s);return sa(o)?o:r}):t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=yc(n)))(r||n)}})();static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();class uf{}let _M=(()=>{class n extends uf{compile(t,i){return t}compileTranslations(t,i){return t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=yc(n)))(r||n)}})();static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})();class sv{defaultLang;currentLang=this.defaultLang;translations={};langs=[];onTranslationChange=new Xn;onLangChange=new Xn;onDefaultLangChange=new Xn}const ov=new oe("ISOLATE_TRANSLATE_SERVICE"),av=new oe("USE_DEFAULT_LANG"),lv=new oe("DEFAULT_LANGUAGE"),cv=new oe("USE_EXTEND"),df=n=>lu(n)?n:Xe(n);let bu=(()=>{class n{store;currentLoader;compiler;parser;missingTranslationHandler;useDefaultLang;extend;loadingTranslations;pending=!1;_translationRequests={};lastUseLanguage=null;get onTranslationChange(){return this.store.onTranslationChange}get onLangChange(){return this.store.onLangChange}get onDefaultLangChange(){return this.store.onDefaultLangChange}get defaultLang(){return this.store.defaultLang}set defaultLang(t){this.store.defaultLang=t}get currentLang(){return this.store.currentLang}set currentLang(t){this.store.currentLang=t}get langs(){return this.store.langs}set langs(t){this.store.langs=t}get translations(){return this.store.translations}set translations(t){this.store.translations=t}constructor(t,i,r,s,o,a=!0,l=!1,c=!1,u){this.store=t,this.currentLoader=i,this.compiler=r,this.parser=s,this.missingTranslationHandler=o,this.useDefaultLang=a,this.extend=c,l&&(this.store=new sv),u&&this.setDefaultLang(u)}setDefaultLang(t){if(t===this.defaultLang)return;const i=this.retrieveTranslations(t);typeof i<"u"?(null==this.defaultLang&&(this.defaultLang=t),i.pipe(Ss(1)).subscribe(()=>{this.changeDefaultLang(t)})):this.changeDefaultLang(t)}getDefaultLang(){return this.defaultLang}use(t){if(this.lastUseLanguage=t,t===this.currentLang)return Xe(this.translations[t]);this.currentLang||(this.currentLang=t);const i=this.retrieveTranslations(t);return lu(i)?(i.pipe(Ss(1)).subscribe(()=>{this.changeLang(t)}),i):(this.changeLang(t),Xe(this.translations[t]))}changeLang(t){t===this.lastUseLanguage&&(this.currentLang=t,this.onLangChange.emit({lang:t,translations:this.translations[t]}),null==this.defaultLang&&this.changeDefaultLang(t))}retrieveTranslations(t){if(typeof this.translations[t]>"u"||this.extend)return this._translationRequests[t]=this._translationRequests[t]||this.loadAndCompileTranslations(t),this._translationRequests[t]}getTranslation(t){return this.loadAndCompileTranslations(t)}loadAndCompileTranslations(t){this.pending=!0;const i=this.currentLoader.getTranslation(t).pipe(dM(1),Ss(1));return this.loadingTranslations=i.pipe(Ct(r=>this.compiler.compileTranslations(r,t)),dM(1),Ss(1)),this.loadingTranslations.subscribe({next:r=>{this.translations[t]=this.extend&&this.translations[t]?{...r,...this.translations[t]}:r,this.updateLangs(),this.pending=!1},error:r=>{this.pending=!1}}),i}setTranslation(t,i,r=!1){const s=this.compiler.compileTranslations(i,t);this.translations[t]=(r||this.extend)&&this.translations[t]?mM(this.translations[t],s):s,this.updateLangs(),this.onTranslationChange.emit({lang:t,translations:this.translations[t]})}getLangs(){return this.langs}addLangs(t){const i=t.filter(r=>!this.langs.includes(r));i.length>0&&(this.langs=[...this.langs,...i])}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResultForKey(t,i,r){let s;if(t&&(s=this.runInterpolation(vM(t,i),r)),void 0===s&&null!=this.defaultLang&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(s=this.runInterpolation(vM(this.translations[this.defaultLang],i),r)),void 0===s){const o={key:i,translateService:this};typeof r<"u"&&(o.interpolateParams=r),s=this.missingTranslationHandler.handle(o)}return void 0!==s?s:i}runInterpolation(t,i){if(pM(t))return t.map(r=>this.runInterpolation(r,i));if(lf(t)){const r={};for(const s in t){const o=this.runInterpolation(t[s],i);void 0!==o&&(r[s]=o)}return r}return this.parser.interpolate(t,i)}getParsedResult(t,i,r){if(i instanceof Array){const s={};let o=!1;for(const l of i)s[l]=this.getParsedResultForKey(t,l,r),o=o||lu(s[l]);return o?function IJ(...n){const e=OL(n),{args:t,keys:i}=FL(n),r=new Nn(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,c=o;for(let u=0;u<o;u++){let d=!1;mr(t[u]).subscribe(Un(s,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||s.next(i?UL(i,a):a),s.complete())}))}});return e?r.pipe(kL(e)):r}(i.map(l=>df(s[l]))).pipe(Ct(l=>{const c={};return l.forEach((u,d)=>{c[i[d]]=u}),c})):s}return this.getParsedResultForKey(t,i,r)}get(t,i){if(!sa(t)||!t.length)throw new Error('Parameter "key" is required and cannot be empty');return this.pending?this.loadingTranslations.pipe(ll(r=>df(this.getParsedResult(r,t,i)))):df(this.getParsedResult(this.translations[this.currentLang],t,i))}getStreamOnTranslationChange(t,i){if(!sa(t)||!t.length)throw new Error('Parameter "key" is required and cannot be empty');return Gh(Cm(()=>this.get(t,i)),this.onTranslationChange.pipe(Qi(r=>{const s=this.getParsedResult(r.translations,t,i);return df(s)})))}stream(t,i){if(!sa(t)||!t.length)throw new Error('Parameter "key" required');return Gh(Cm(()=>this.get(t,i)),this.onLangChange.pipe(Qi(r=>{const s=this.getParsedResult(r.translations,t,i);return df(s)})))}instant(t,i){if(!sa(t)||0===t.length)throw new Error('Parameter "key" is required and cannot be empty');const r=this.getParsedResult(this.translations[this.currentLang],t,i);return lu(r)?Array.isArray(t)?t.reduce((s,o)=>(s[o]=o,s),{}):t:r}set(t,i,r=this.currentLang){(function LJ(n,e,t){const i=e.split(".");let r=n;for(let s=0;s<i.length;s++){const o=i[s];s===i.length-1?r[o]=t:((!r[o]||!lf(r[o]))&&(r[o]={}),r=r[o])}})(this.translations[r],t,gM(i)?this.compiler.compile(i,r):this.compiler.compileTranslations(i,r)),this.updateLangs(),this.onTranslationChange.emit({lang:r,translations:this.translations[r]})}changeDefaultLang(t){this.defaultLang=t,this.onDefaultLangChange.emit({lang:t,translations:this.translations[t]})}reloadLang(t){return this.resetLang(t),this.loadAndCompileTranslations(t)}resetLang(t){delete this._translationRequests[t],delete this.translations[t]}getBrowserLang(){if(typeof window>"u"||!window.navigator)return;const t=this.getBrowserCultureLang();return t?t.split(/[-_]/)[0]:void 0}getBrowserCultureLang(){if(!(typeof window>"u"||typeof window.navigator>"u"))return window.navigator.languages?window.navigator.languages[0]:window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage}static \u0275fac=function(i){return new(i||n)(_e(sv),_e(wu),_e(uf),_e(cf),_e(nv),_e(av),_e(ov),_e(cv),_e(lv))};static \u0275prov=xe({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),dO=(()=>{class n{translate;_ref;value="";lastKey=null;lastParams=[];onTranslationChange;onLangChange;onDefaultLangChange;constructor(t,i){this.translate=t,this._ref=i}updateValue(t,i,r){const s=o=>{this.value=void 0!==o?o:t,this.lastKey=t,this._ref.markForCheck()};if(r){const o=this.translate.getParsedResult(r,t,i);lu(o)?o.subscribe(s):s(o)}this.translate.get(t,i).subscribe(s)}transform(t,...i){if(!t||!t.length)return t;if(iv(t,this.lastKey)&&iv(i,this.lastParams))return this.value;let r;if(sa(i[0])&&i.length)if(gM(i[0])&&i[0].length){const s=i[0].replace(/(')?([a-zA-Z0-9_]+)(')?(\s)?:/g,'"$2":').replace(/:(\s)?(')(.*?)(')/g,':"$3"');try{r=JSON.parse(s)}catch(o){throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${i[0]}`)}}else lf(i[0])&&(r=i[0]);return this.lastKey=t,this.lastParams=i,this.updateValue(t,r),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(s=>{this.lastKey&&s.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(t,r,s.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(s=>{this.lastKey&&(this.lastKey=null,this.updateValue(t,r,s.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(t,r))})),this.value}_dispose(){typeof this.onTranslationChange<"u"&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),typeof this.onLangChange<"u"&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),typeof this.onDefaultLangChange<"u"&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}static \u0275fac=function(i){return new(i||n)(Be(bu,16),Be(Ih,16))};static \u0275pipe=li({name:"translate",type:n,pure:!1});static \u0275prov=xe({token:n,factory:n.\u0275fac})}return n})(),uv=(()=>{class n{static forRoot(t={}){return{ngModule:n,providers:[t.loader||{provide:wu,useClass:hM},t.compiler||{provide:uf,useClass:_M},t.parser||{provide:cf,useClass:yM},t.missingTranslationHandler||{provide:nv,useClass:fM},sv,{provide:ov,useValue:t.isolate},{provide:av,useValue:t.useDefaultLang},{provide:cv,useValue:t.extend},{provide:lv,useValue:t.defaultLanguage},bu]}}static forChild(t={}){return{ngModule:n,providers:[t.loader||{provide:wu,useClass:hM},t.compiler||{provide:uf,useClass:_M},t.parser||{provide:cf,useClass:yM},t.missingTranslationHandler||{provide:nv,useClass:fM},{provide:ov,useValue:t.isolate},{provide:av,useValue:t.useDefaultLang},{provide:cv,useValue:t.extend},{provide:lv,useValue:t.defaultLanguage},bu]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=Vc({type:n});static \u0275inj=Ra({})}return n})();class FJ extends Ut{constructor(e,t){super()}schedule(e,t=0){return this}}const dv={setInterval(n,e,...t){const{delegate:i}=dv;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=dv;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class hf{constructor(e,t=hf.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}hf.now=cM.now;const BJ=new class UJ extends hf{constructor(e,t=hf.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}(class kJ extends FJ{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return dv.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&dv.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,jt(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}});function jJ(n,e){return n===e}let ml={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function hO(n){ml=n}const ff={exec:()=>null};function tn(n,e=""){let t="string"==typeof n?n:n.source;const i={replace:(r,s)=>{let o="string"==typeof s?s:s.source;return o=o.replace(Fi.caret,"$1"),t=t.replace(r,o),i},getRegex:()=>new RegExp(t,e)};return i}const Fi={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[\t ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},pf=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,fO=/(?:[*+-]|\d{1,9}[.)])/,pO=tn(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,fO).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),wM=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,bM=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ZJ=tn(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",bM).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),JJ=tn(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,fO).getRegex(),hv="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",MM=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,KJ=tn("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",MM).replace("tag",hv).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),gO=tn(wM).replace("hr",pf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hv).getRegex(),EM={blockquote:tn(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",gO).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:ZJ,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:pf,html:KJ,lheading:pO,list:JJ,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:gO,table:ff,text:/^[^\n]+/},mO=tn("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",pf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hv).getRegex(),QJ={...EM,table:mO,paragraph:tn(wM).replace("hr",pf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",mO).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hv).getRegex()},eK={...EM,html:tn("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",MM).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ff,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:tn(wM).replace("hr",pf).replace("heading"," *#{1,6} *[^\n]").replace("lheading",pO).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},vO=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,yO=/^( {2,}|\\)\n(?!\s*$)/,gf="\\p{P}\\p{S}",iK=tn(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,gf).getRegex(),sK=tn(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,gf).getRegex(),oK=tn("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,gf).getRegex(),aK=tn("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,gf).getRegex(),lK=tn(/\\([punct])/,"gu").replace(/punct/g,gf).getRegex(),cK=tn(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),uK=tn(MM).replace("(?:--\x3e|$)","--\x3e").getRegex(),dK=tn("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",uK).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),fv=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,hK=tn(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",fv).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),_O=tn(/^!?\[(label)\]\[(ref)\]/).replace("label",fv).replace("ref",bM).getRegex(),xO=tn(/^!?\[(ref)\](?:\[\])?/).replace("ref",bM).getRegex(),SM={_backpedal:ff,anyPunctuation:lK,autolink:cK,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:yO,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:ff,emStrongLDelim:sK,emStrongRDelimAst:oK,emStrongRDelimUnd:aK,escape:vO,link:hK,nolink:xO,punctuation:iK,reflink:_O,reflinkSearch:tn("reflink|nolink(?!\\()","g").replace("reflink",_O).replace("nolink",xO).getRegex(),tag:dK,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:ff},pK={...SM,link:tn(/^!?\[(label)\]\((.*?)\)/).replace("label",fv).getRegex(),reflink:tn(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",fv).getRegex()},TM={...SM,escape:tn(vO).replace("])","~|])").getRegex(),url:tn(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},gK={...TM,br:tn(yO).replace("{2,}","*").getRegex(),text:tn(TM.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},pv={normal:EM,gfm:QJ,pedantic:eK},mf={normal:SM,gfm:TM,breaks:gK,pedantic:pK},mK={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},wO=n=>mK[n];function As(n,e){if(e){if(Fi.escapeTest.test(n))return n.replace(Fi.escapeReplace,wO)}else if(Fi.escapeTestNoEncode.test(n))return n.replace(Fi.escapeReplaceNoEncode,wO);return n}function bO(n){try{n=encodeURI(n).replace(Fi.percentDecode,"%")}catch{return null}return n}function MO(n,e){const i=n.replace(Fi.findPipe,(s,o,a)=>{let l=!1,c=o;for(;--c>=0&&"\\"===a[c];)l=!l;return l?"|":" |"}).split(Fi.splitPipe);let r=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(Fi.slashPipe,"|");return i}function vf(n,e,t){const i=n.length;if(0===i)return"";let r=0;for(;r<i;){const s=n.charAt(i-r-1);if(s!==e||t){if(s===e||!t)break;r++}else r++}return n.slice(0,i-r)}function EO(n,e,t,i,r){const s=e.href,o=e.title||null,a=n[1].replace(r.other.outputLinkReplace,"$1");if("!"!==n[0].charAt(0)){i.state.inLink=!0;const l={type:"link",raw:t,href:s,title:o,text:a,tokens:i.inlineTokens(a)};return i.state.inLink=!1,l}return{type:"image",raw:t,href:s,title:o,text:a}}class gv{options;rules;lexer;constructor(e){this.options=e||ml}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const i=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:vf(i,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const i=t[0],r=function yK(n,e,t){const i=n.match(t.other.indentCodeCompensation);if(null===i)return e;const r=i[1];return e.split("\n").map(s=>{const o=s.match(t.other.beginningSpace);if(null===o)return s;const[a]=o;return a.length>=r.length?s.slice(r.length):s}).join("\n")}(i,t[3]||"",this.rules);return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let i=t[2].trim();if(this.rules.other.endingHash.test(i)){const r=vf(i,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(i=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:vf(t[0],"\n")}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let i=vf(t[0],"\n").split("\n"),r="",s="";const o=[];for(;i.length>0;){let a=!1;const l=[];let c;for(c=0;c<i.length;c++)if(this.rules.other.blockquoteStart.test(i[c]))l.push(i[c]),a=!0;else{if(a)break;l.push(i[c])}i=i.slice(c);const u=l.join("\n"),d=u.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}\n${u}`:u,s=s?`${s}\n${d}`:d;const h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,o,!0),this.lexer.state.top=h,0===i.length)break;const f=o[o.length-1];if("code"===f?.type)break;if("blockquote"===f?.type){const p=f,v=p.raw+"\n"+i.join("\n"),m=this.blockquote(v);o[o.length-1]=m,r=r.substring(0,r.length-p.raw.length)+m.raw,s=s.substring(0,s.length-p.text.length)+m.text;break}if("list"!==f?.type);else{const p=f,v=p.raw+"\n"+i.join("\n"),m=this.list(v);o[o.length-1]=m,r=r.substring(0,r.length-f.raw.length)+m.raw,s=s.substring(0,s.length-p.raw.length)+m.raw,i=v.substring(o[o.length-1].raw.length).split("\n")}}return{type:"blockquote",raw:r,tokens:o,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let i=t[1].trim();const r=i.length>1,s={type:"list",raw:"",ordered:r,start:r?+i.slice(0,-1):"",loose:!1,items:[]};i=r?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=r?i:"[*+-]");const o=this.rules.other.listItemRegex(i);let a=!1;for(;e;){let l=!1,c="",u="";if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,g=>" ".repeat(3*g.length)),h=e.split("\n",1)[0],f=!d.trim(),p=0;if(this.options.pedantic?(p=2,u=d.trimStart()):f?p=t[1].length+1:(p=t[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,u=d.slice(p),p+=t[1].length),f&&this.rules.other.blankLine.test(h)&&(c+=h+"\n",e=e.substring(h.length+1),l=!0),!l){const g=this.rules.other.nextBulletRegex(p),y=this.rules.other.hrRegex(p),_=this.rules.other.fencesBeginRegex(p),x=this.rules.other.headingBeginRegex(p),T=this.rules.other.htmlBeginRegex(p);for(;e;){const E=e.split("\n",1)[0];let C;if(h=E,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),C=h):C=h.replace(this.rules.other.tabCharGlobal,"    "),_.test(h)||x.test(h)||T.test(h)||g.test(h)||y.test(h))break;if(C.search(this.rules.other.nonSpaceChar)>=p||!h.trim())u+="\n"+C.slice(p);else{if(f||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||_.test(d)||x.test(d)||y.test(d))break;u+="\n"+h}!f&&!h.trim()&&(f=!0),c+=E+"\n",e=e.substring(E.length+1),d=C.slice(p)}}s.loose||(a?s.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(a=!0));let m,v=null;this.options.gfm&&(v=this.rules.other.listIsTask.exec(u),v&&(m="[ ] "!==v[0],u=u.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:c,task:!!v,checked:m,loose:!1,text:u,tokens:[]}),s.raw+=c}s.items[s.items.length-1].raw=s.items[s.items.length-1].raw.trimEnd(),s.items[s.items.length-1].text=s.items[s.items.length-1].text.trimEnd(),s.raw=s.raw.trimEnd();for(let l=0;l<s.items.length;l++)if(this.lexer.state.top=!1,s.items[l].tokens=this.lexer.blockTokens(s.items[l].text,[]),!s.loose){const c=s.items[l].tokens.filter(d=>"space"===d.type),u=c.length>0&&c.some(d=>this.rules.other.anyLine.test(d.raw));s.loose=u}if(s.loose)for(let l=0;l<s.items.length;l++)s.items[l].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const i=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:r,title:s}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const i=MO(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=t[3]&&t[3].trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===r.length){for(const a of r)this.rules.other.tableAlignRight.test(a)?o.align.push("right"):this.rules.other.tableAlignCenter.test(a)?o.align.push("center"):this.rules.other.tableAlignLeft.test(a)?o.align.push("left"):o.align.push(null);for(let a=0;a<i.length;a++)o.header.push({text:i[a],tokens:this.lexer.inline(i[a]),header:!0,align:o.align[a]});for(const a of s)o.rows.push(MO(a,o.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:o.align[c]})));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const i="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const i=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(i)){if(!this.rules.other.endAngleBracket.test(i))return;const o=vf(i.slice(0,-1),"\\");if((i.length-o.length)%2==0)return}else{const o=function vK(n,e){if(-1===n.indexOf(e[1]))return-1;let t=0;for(let i=0;i<n.length;i++)if("\\"===n[i])i++;else if(n[i]===e[0])t++;else if(n[i]===e[1]&&(t--,t<0))return i;return-1}(t[2],"()");if(o>-1){const l=(0===t[0].indexOf("!")?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const o=this.rules.other.pedanticHrefTitle.exec(r);o&&(r=o[1],s=o[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(r=this.options.pedantic&&!this.rules.other.endAngleBracket.test(i)?r.slice(1):r.slice(1,-1)),EO(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){const s=t[(i[2]||i[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!s){const o=i[0].charAt(0);return{type:"text",raw:o,text:o}}return EO(i,s,i[0],this.lexer,this.rules)}}emStrong(e,t,i=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!(!r||r[3]&&i.match(this.rules.other.unicodeAlphaNumeric))&&(!r[1]&&!r[2]||!i||this.rules.inline.punctuation.exec(i))){const o=[...r[0]].length-1;let a,l,c=o,u=0;const d="*"===r[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+o);null!=(r=d.exec(t));){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(l=[...a].length,r[3]||r[4]){c+=l;continue}if((r[5]||r[6])&&o%3&&!((o+l)%3)){u+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+u);const h=[...r[0]][0].length,f=e.slice(0,o+r.index+h+l);if(Math.min(o,l)%2){const v=f.slice(1,-1);return{type:"em",raw:f,text:v,tokens:this.lexer.inlineTokens(v)}}const p=f.slice(2,-2);return{type:"strong",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let i=t[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(i),s=this.rules.other.startingSpaceChar.test(i)&&this.rules.other.endingSpaceChar.test(i);return r&&s&&(i=i.substring(1,i.length-1)),{type:"codespan",raw:t[0],text:i}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let i,r;return"@"===t[2]?(i=t[1],r="mailto:"+i):(i=t[1],r=i),{type:"link",raw:t[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let i,r;if("@"===t[2])i=t[0],r="mailto:"+i;else{let s;do{s=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(s!==t[0]);i=t[0],r="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],escaped:this.lexer.state.inRawBlock}}}class Ur{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||ml,this.options.tokenizer=this.options.tokenizer||new gv,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:Fi,block:pv.normal,inline:mf.normal};this.options.pedantic?(t.block=pv.pedantic,t.inline=mf.pedantic):this.options.gfm&&(t.block=pv.gfm,t.inline=this.options.breaks?mf.breaks:mf.gfm),this.tokenizer.rules=t}static get rules(){return{block:pv,inline:mf}}static lex(e,t){return new Ur(t).lex(e)}static lexInline(e,t){return new Ur(t).inlineTokens(e)}lex(e){e=e.replace(Fi.carriageReturn,"\n"),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const i=this.inlineQueue[t];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],i=!1){let r,s,o;for(this.options.pedantic&&(e=e.replace(Fi.tabCharGlobal,"    ").replace(Fi.spaceLine,""));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>!!(r=a.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0)))){if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length),1===r.raw.length&&t.length>0?t[t.length-1].raw+="\n":t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length),s=t[t.length-1],!s||"paragraph"!==s.type&&"text"!==s.type?t.push(r):(s.raw+="\n"+r.raw,s.text+="\n"+r.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length),s=t[t.length-1],!s||"paragraph"!==s.type&&"text"!==s.type?this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title}):(s.raw+="\n"+r.raw,s.text+="\n"+r.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text);continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(o=e,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=e.slice(1);let c;this.options.extensions.startBlock.forEach(u=>{c=u.call({lexer:this},l),"number"==typeof c&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(o=e.substring(0,a+1))}if(this.state.top&&(r=this.tokenizer.paragraph(o))){s=t[t.length-1],i&&"paragraph"===s?.type?(s.raw+="\n"+r.raw,s.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r),i=o.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length),s=t[t.length-1],s&&"text"===s.type?(s.raw+="\n"+r.raw,s.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):t.push(r);continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let i,r,s,a,l,c,o=e;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;null!=(a=this.tokenizer.rules.inline.reflinkSearch.exec(o));)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(a=this.tokenizer.rules.inline.blockSkip.exec(o));)o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(a=this.tokenizer.rules.inline.anyPunctuation.exec(o));)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>!!(i=u.call({lexer:this},e,t))&&(e=e.substring(i.raw.length),t.push(i),!0)))){if(i=this.tokenizer.escape(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.tag(e)){e=e.substring(i.raw.length),r=t[t.length-1],t.push(i);continue}if(i=this.tokenizer.link(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(i.raw.length),r=t[t.length-1],r&&"text"===i.type&&"text"===r.type?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(i=this.tokenizer.emStrong(e,o,c)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.codespan(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.br(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.del(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.autolink(e)){e=e.substring(i.raw.length),t.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(e))){e=e.substring(i.raw.length),t.push(i);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=e.slice(1);let h;this.options.extensions.startInline.forEach(f=>{h=f.call({lexer:this},d),"number"==typeof h&&h>=0&&(u=Math.min(u,h))}),u<1/0&&u>=0&&(s=e.substring(0,u+1))}if(i=this.tokenizer.inlineText(s)){e=e.substring(i.raw.length),"_"!==i.raw.slice(-1)&&(c=i.raw.slice(-1)),l=!0,r=t[t.length-1],r&&"text"===r.type?(r.raw+=i.raw,r.text+=i.text):t.push(i);continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}throw new Error(u)}}return t}}class vl{options;parser;constructor(e){this.options=e||ml}space(e){return""}code({text:e,lang:t,escaped:i}){const r=(t||"").match(Fi.notSpaceStart)?.[0],s=e.replace(Fi.endingNewline,"")+"\n";return r?'<pre><code class="language-'+As(r)+'">'+(i?s:As(s,!0))+"</code></pre>\n":"<pre><code>"+(i?s:As(s,!0))+"</code></pre>\n"}blockquote({tokens:e}){return`<blockquote>\n${this.parser.parse(e)}</blockquote>\n`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return"<hr>\n"}list(e){const t=e.ordered,i=e.start;let r="";for(let a=0;a<e.items.length;a++)r+=this.listitem(e.items[a]);const s=t?"ol":"ul";return"<"+s+(t&&1!==i?' start="'+i+'"':"")+">\n"+r+"</"+s+">\n"}listitem(e){let t="";if(e.task){const i=this.checkbox({checked:!!e.checked});e.loose?e.tokens.length>0&&"paragraph"===e.tokens[0].type?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&"text"===e.tokens[0].tokens[0].type&&(e.tokens[0].tokens[0].text=i+" "+As(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>\n`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t="",i="";for(let s=0;s<e.header.length;s++)i+=this.tablecell(e.header[s]);t+=this.tablerow({text:i});let r="";for(let s=0;s<e.rows.length;s++){const o=e.rows[s];i="";for(let a=0;a<o.length;a++)i+=this.tablecell(o[a]);r+=this.tablerow({text:i})}return r&&(r=`<tbody>${r}</tbody>`),"<table>\n<thead>\n"+t+"</thead>\n"+r+"</table>\n"}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){const t=this.parser.parseInline(e.tokens),i=e.header?"th":"td";return(e.align?`<${i} align="${e.align}">`:`<${i}>`)+t+`</${i}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${As(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:i}){const r=this.parser.parseInline(i),s=bO(e);if(null===s)return r;let o='<a href="'+(e=s)+'"';return t&&(o+=' title="'+As(t)+'"'),o+=">"+r+"</a>",o}image({href:e,title:t,text:i}){const r=bO(e);if(null===r)return As(i);let s=`<img src="${e=r}" alt="${i}"`;return t&&(s+=` title="${As(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:As(e.text)}}class CM{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class Br{options;renderer;textRenderer;constructor(e){this.options=e||ml,this.options.renderer=this.options.renderer||new vl,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new CM}static parse(e,t){return new Br(t).parse(e)}static parseInline(e,t){return new Br(t).parseInline(e)}parse(e,t=!0){let i="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const a=s,l=this.options.extensions.renderers[a.type].call({parser:this},a);if(!1!==l||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){i+=l||"";continue}}const o=s;switch(o.type){case"space":i+=this.renderer.space(o);continue;case"hr":i+=this.renderer.hr(o);continue;case"heading":i+=this.renderer.heading(o);continue;case"code":i+=this.renderer.code(o);continue;case"table":i+=this.renderer.table(o);continue;case"blockquote":i+=this.renderer.blockquote(o);continue;case"list":i+=this.renderer.list(o);continue;case"html":i+=this.renderer.html(o);continue;case"paragraph":i+=this.renderer.paragraph(o);continue;case"text":{let a=o,l=this.renderer.text(a);for(;r+1<e.length&&"text"===e[r+1].type;)a=e[++r],l+="\n"+this.renderer.text(a);i+=t?this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l,escaped:!0}]}):l;continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return i}parseInline(e,t){t=t||this.renderer;let i="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const a=this.options.extensions.renderers[s.type].call({parser:this},s);if(!1!==a||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){i+=a||"";continue}}const o=s;switch(o.type){case"escape":case"text":i+=t.text(o);break;case"html":i+=t.html(o);break;case"link":i+=t.link(o);break;case"image":i+=t.image(o);break;case"strong":i+=t.strong(o);break;case"em":i+=t.em(o);break;case"codespan":i+=t.codespan(o);break;case"br":i+=t.br(o);break;case"del":i+=t.del(o);break;default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return i}}class mv{options;block;constructor(e){this.options=e||ml}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Ur.lex:Ur.lexInline}provideParser(){return this.block?Br.parse:Br.parseInline}}const yl=new class _K{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=Br;Renderer=vl;TextRenderer=CM;Lexer=Ur;Tokenizer=gv;Hooks=mv;constructor(...e){this.use(...e)}walkTokens(e,t){let i=[];for(const r of e)switch(i=i.concat(t.call(this,r)),r.type){case"table":{const s=r;for(const o of s.header)i=i.concat(this.walkTokens(o.tokens,t));for(const o of s.rows)for(const a of o)i=i.concat(this.walkTokens(a.tokens,t));break}case"list":i=i.concat(this.walkTokens(r.items,t));break;default:{const s=r;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(o=>{const a=s[o].flat(1/0);i=i.concat(this.walkTokens(a,t))}):s.tokens&&(i=i.concat(this.walkTokens(s.tokens,t)))}}return i}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(i=>{const r={...i};if(r.async=this.defaults.async||r.async||!1,i.extensions&&(i.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const o=t.renderers[s.name];t.renderers[s.name]=o?function(...a){let l=s.renderer.apply(this,a);return!1===l&&(l=o.apply(this,a)),l}:s.renderer}if("tokenizer"in s){if(!s.level||"block"!==s.level&&"inline"!==s.level)throw new Error("extension level must be 'block' or 'inline'");const o=t[s.level];o?o.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&("block"===s.level?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:"inline"===s.level&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),i.renderer){const s=this.defaults.renderer||new vl(this.defaults);for(const o in i.renderer){if(!(o in s))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const l=i.renderer[o],c=s[o];s[o]=(...u)=>{let d=l.apply(s,u);return!1===d&&(d=c.apply(s,u)),d||""}}r.renderer=s}if(i.tokenizer){const s=this.defaults.tokenizer||new gv(this.defaults);for(const o in i.tokenizer){if(!(o in s))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const l=i.tokenizer[o],c=s[o];s[o]=(...u)=>{let d=l.apply(s,u);return!1===d&&(d=c.apply(s,u)),d}}r.tokenizer=s}if(i.hooks){const s=this.defaults.hooks||new mv;for(const o in i.hooks){if(!(o in s))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;const l=i.hooks[o],c=s[o];s[o]=mv.passThroughHooks.has(o)?u=>{if(this.defaults.async)return Promise.resolve(l.call(s,u)).then(h=>c.call(s,h));const d=l.call(s,u);return c.call(s,d)}:(...u)=>{let d=l.apply(s,u);return!1===d&&(d=c.apply(s,u)),d}}r.hooks=s}if(i.walkTokens){const s=this.defaults.walkTokens,o=i.walkTokens;r.walkTokens=function(a){let l=[];return l.push(o.call(this,a)),s&&(l=l.concat(s.call(this,a))),l}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Ur.lex(e,t??this.defaults)}parser(e,t){return Br.parse(e,t??this.defaults)}parseMarkdown(e){return(i,r)=>{const s={...r},o={...this.defaults,...s},a=this.onError(!!o.silent,!!o.async);if(!0===this.defaults.async&&!1===s.async)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof i>"u"||null===i)return a(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof i)return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=e);const l=o.hooks?o.hooks.provideLexer():e?Ur.lex:Ur.lexInline,c=o.hooks?o.hooks.provideParser():e?Br.parse:Br.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(i):i).then(u=>l(u,o)).then(u=>o.hooks?o.hooks.processAllTokens(u):u).then(u=>o.walkTokens?Promise.all(this.walkTokens(u,o.walkTokens)).then(()=>u):u).then(u=>c(u,o)).then(u=>o.hooks?o.hooks.postprocess(u):u).catch(a);try{o.hooks&&(i=o.hooks.preprocess(i));let u=l(i,o);o.hooks&&(u=o.hooks.processAllTokens(u)),o.walkTokens&&this.walkTokens(u,o.walkTokens);let d=c(u,o);return o.hooks&&(d=o.hooks.postprocess(d)),d}catch(u){return a(u)}}}onError(e,t){return i=>{if(i.message+="\nPlease report this to https://github.com/markedjs/marked.",e){const r="<p>An error occurred:</p><pre>"+As(i.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(i);throw i}}};function Vt(n,e){return yl.parse(n,e)}Vt.options=Vt.setOptions=function(n){return yl.setOptions(n),hO(Vt.defaults=yl.defaults),Vt},Vt.getDefaults=function xM(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}},Vt.defaults=ml,Vt.use=function(...n){return yl.use(...n),hO(Vt.defaults=yl.defaults),Vt},Vt.walkTokens=function(n,e){return yl.walkTokens(n,e)},Vt.parseInline=yl.parseInline,Vt.Parser=Br,Vt.parser=Br.parse,Vt.Renderer=vl,Vt.TextRenderer=CM,Vt.Lexer=Ur,Vt.lexer=Ur.lex,Vt.Tokenizer=gv,Vt.Hooks=mv,Vt.parse=Vt;const xK=["*"];let SO=(()=>{class n{constructor(){this._buttonClick$=new ii,this.copied$=this._buttonClick$.pipe(Qi(()=>function OJ(...n){const e=Hh(n),t=function lX(n,e){return"number"==typeof Cb(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?mr(i[0]):cu(t)(Kn(i,e)):Qr}(Xe(!0),function zJ(n=0,e,t=BJ){let i=-1;return null!=e&&(LL(e)?t=e:i=e),new Nn(r=>{let s=function VJ(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(3e3).pipe(function HJ(n){return Ct(()=>n)}(!1)))),function GJ(n,e=Do){return n=n??jJ,Gn((t,i)=>{let r,s=!0;t.subscribe(Un(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}(),dM(1)),this.copiedText$=this.copied$.pipe(zL(!1),Ct(t=>t?"Copied":"Copy"))}onCopyToClipboardClick(){this._buttonClick$.next()}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=Zs({type:n,selectors:[["markdown-clipboard"]],decls:4,vars:7,consts:[[1,"markdown-clipboard-button",3,"click"]],template:function(i,r){1&i&&(ae(0,"button",0),gt(1,"async"),Mh("click",function(){return r.onCopyToClipboardClick()}),Ze(2),gt(3,"async"),ue()),2&i&&(cw("copied",Et(1,3,r.copied$)),Te(2),Zn(Et(3,5,r.copiedText$)))},dependencies:[zP],encapsulation:2,changeDetection:0})}}return n})();const MK=new oe("CLIPBOARD_OPTIONS");var DM=function(n){return n.CommandLine="command-line",n.LineHighlight="line-highlight",n.LineNumbers="line-numbers",n}(DM||{});const TO=new oe("MARKED_EXTENSIONS"),SK=new oe("MARKED_OPTIONS"),TK=new oe("MERMAID_OPTIONS"),CO=new oe("SECURITY_CONTEXT");let AM=(()=>{class n{get options(){return this._options}set options(t){this._options={...this.DEFAULT_MARKED_OPTIONS,...t}}get renderer(){return this.options.renderer}set renderer(t){this.options.renderer=t}constructor(t,i,r,s,o,a,l,c){this.clipboardOptions=t,this.extensions=i,this.mermaidOptions=s,this.platform=o,this.securityContext=a,this.http=l,this.sanitizer=c,this.DEFAULT_MARKED_OPTIONS={renderer:new vl},this.DEFAULT_KATEX_OPTIONS={delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\begin{CD}",right:"\\end{CD}",display:!0},{left:"\\[",right:"\\]",display:!0}]},this.DEFAULT_MERMAID_OPTIONS={startOnLoad:!1},this.DEFAULT_CLIPBOARD_OPTIONS={buttonComponent:void 0},this.DEFAULT_PARSE_OPTIONS={decodeHtml:!1,inline:!1,emoji:!1,mermaid:!1,markedOptions:void 0,disableSanitizer:!1},this.DEFAULT_RENDER_OPTIONS={clipboard:!1,clipboardOptions:void 0,katex:!1,katexOptions:void 0,mermaid:!1,mermaidOptions:void 0},this._reload$=new ii,this.reload$=this._reload$.asObservable(),this.options=r}parse(t,i=this.DEFAULT_PARSE_OPTIONS){const{decodeHtml:r,inline:s,emoji:o,mermaid:a,disableSanitizer:l}=i,c={...this.options,...i.markedOptions},u=c.renderer||this.renderer||new vl;this.extensions&&(this.renderer=this.extendsRendererForExtensions(u)),a&&(this.renderer=this.extendsRendererForMermaid(u));const d=this.trimIndentation(t),h=r?this.decodeHtml(d):d,f=o?this.parseEmoji(h):h,p=this.parseMarked(f,c,s);return(l?p:this.sanitizer.sanitize(this.securityContext,p))||""}render(t,i=this.DEFAULT_RENDER_OPTIONS,r){const{clipboard:s,clipboardOptions:o,katex:a,katexOptions:l,mermaid:c,mermaidOptions:u}=i;a&&this.renderKatex(t,{...this.DEFAULT_KATEX_OPTIONS,...l}),c&&this.renderMermaid(t,{...this.DEFAULT_MERMAID_OPTIONS,...this.mermaidOptions,...u}),s&&this.renderClipboard(t,r,{...this.DEFAULT_CLIPBOARD_OPTIONS,...this.clipboardOptions,...o}),this.highlight(t)}reload(){this._reload$.next()}getSource(t){if(!this.http)throw new Error("[ngx-markdown] When using the `src` attribute you *have to* pass the `HttpClient` as a parameter of the `forRoot` method. See README for more information");return this.http.get(t,{responseType:"text"}).pipe(Ct(i=>this.handleExtension(t,i)))}highlight(t){if(!ou(this.platform)||typeof Prism>"u"||typeof Prism.highlightAllUnder>"u")return;t||(t=document);const i=t.querySelectorAll('pre code:not([class*="language-"])');Array.prototype.forEach.call(i,r=>r.classList.add("language-none")),Prism.highlightAllUnder(t)}decodeHtml(t){if(!ou(this.platform))return t;const i=document.createElement("textarea");return i.innerHTML=t,i.value}extendsRendererForExtensions(t){const i=t;return!0===i.\u0275NgxMarkdownRendererExtendedForExtensions||(this.extensions?.length>0&&Vt.use(...this.extensions),i.\u0275NgxMarkdownRendererExtendedForExtensions=!0),t}extendsRendererForMermaid(t){const i=t;if(!0===i.\u0275NgxMarkdownRendererExtendedForMermaid)return t;const r=t.code;return t.code=s=>"mermaid"===s.lang?`<div class="mermaid">${s.text}</div>`:r(s),i.\u0275NgxMarkdownRendererExtendedForMermaid=!0,t}handleExtension(t,i){const r=t.lastIndexOf("://"),s=r>-1?t.substring(r+4):t,o=s.lastIndexOf("/"),a=o>-1?s.substring(o+1).split("?")[0]:"",l=a.lastIndexOf("."),c=l>-1?a.substring(l+1):"";return c&&"md"!==c?"```"+c+"\n"+i+"\n```":i}parseMarked(t,i,r=!1){if(i.renderer){const s={...i.renderer};delete s.\u0275NgxMarkdownRendererExtendedForExtensions,delete s.\u0275NgxMarkdownRendererExtendedForMermaid,delete i.renderer,Vt.use({renderer:s})}return r?Vt.parseInline(t,i):Vt.parse(t,i)}parseEmoji(t){if(!ou(this.platform))return t;if(typeof joypixels>"u"||typeof joypixels.shortnameToUnicode>"u")throw new Error("[ngx-markdown] When using the `emoji` attribute you *have to* include Emoji-Toolkit files to `angular.json` or use imports. See README for more information");return joypixels.shortnameToUnicode(t)}renderKatex(t,i){if(ou(this.platform)){if(typeof katex>"u"||typeof renderMathInElement>"u")throw new Error("[ngx-markdown] When using the `katex` attribute you *have to* include KaTeX files to `angular.json` or use imports. See README for more information");renderMathInElement(t,i)}}renderClipboard(t,i,r){if(!ou(this.platform))return;if(typeof ClipboardJS>"u")throw new Error("[ngx-markdown] When using the `clipboard` attribute you *have to* include Clipboard files to `angular.json` or use imports. See README for more information");if(!i)throw new Error("[ngx-markdown] When using the `clipboard` attribute you *have to* provide the `viewContainerRef` parameter to `MarkdownService.render()` function");const{buttonComponent:s,buttonTemplate:o}=r,a=t.querySelectorAll("pre");for(let l=0;l<a.length;l++){const c=a.item(l),u=document.createElement("div");u.style.position="relative",c.parentNode.insertBefore(u,c),u.appendChild(c);const d=document.createElement("div");let h,f;if(d.classList.add("markdown-clipboard-toolbar"),d.style.position="absolute",d.style.top=".5em",d.style.right=".5em",d.style.zIndex="1",u.insertAdjacentElement("beforeend",d),u.onmouseenter=()=>d.classList.add("hover"),u.onmouseleave=()=>d.classList.remove("hover"),s){const p=i.createComponent(s);h=p.hostView,p.changeDetectorRef.markForCheck()}else if(o)h=i.createEmbeddedView(o);else{const p=i.createComponent(SO);h=p.hostView,p.changeDetectorRef.markForCheck()}h.rootNodes.forEach(p=>{d.appendChild(p),f=new ClipboardJS(p,{text:()=>c.innerText})}),h.onDestroy(()=>f.destroy())}}renderMermaid(t,i=this.DEFAULT_MERMAID_OPTIONS){if(!ou(this.platform))return;if(typeof mermaid>"u"||typeof mermaid.initialize>"u")throw new Error("[ngx-markdown] When using the `mermaid` attribute you *have to* include Mermaid files to `angular.json` or use imports. See README for more information");const r=t.querySelectorAll(".mermaid");0!==r.length&&(mermaid.initialize(i),mermaid.run({nodes:r}))}trimIndentation(t){if(!t)return"";let i;return t.split("\n").map(r=>{let s=i;return r.length>0&&(s=isNaN(s)?r.search(/\S|$/):Math.min(r.search(/\S|$/),s)),isNaN(i)&&(i=s),s?r.substring(s):r}).join("\n")}static{this.\u0275fac=function(i){return new(i||n)(_e(MK,8),_e(TO,8),_e(SK,8),_e(TK,8),_e(ko),_e(CO),_e(ev,8),_e(Vh))}}static{this.\u0275prov=xe({token:n,factory:n.\u0275fac})}}return n})(),DO=(()=>{class n{get disableSanitizer(){return this._disableSanitizer}set disableSanitizer(t){this._disableSanitizer=this.coerceBooleanProperty(t)}get inline(){return this._inline}set inline(t){this._inline=this.coerceBooleanProperty(t)}get clipboard(){return this._clipboard}set clipboard(t){this._clipboard=this.coerceBooleanProperty(t)}get emoji(){return this._emoji}set emoji(t){this._emoji=this.coerceBooleanProperty(t)}get katex(){return this._katex}set katex(t){this._katex=this.coerceBooleanProperty(t)}get mermaid(){return this._mermaid}set mermaid(t){this._mermaid=this.coerceBooleanProperty(t)}get lineHighlight(){return this._lineHighlight}set lineHighlight(t){this._lineHighlight=this.coerceBooleanProperty(t)}get lineNumbers(){return this._lineNumbers}set lineNumbers(t){this._lineNumbers=this.coerceBooleanProperty(t)}get commandLine(){return this._commandLine}set commandLine(t){this._commandLine=this.coerceBooleanProperty(t)}constructor(t,i,r){this.element=t,this.markdownService=i,this.viewContainerRef=r,this.error=new Xn,this.load=new Xn,this.ready=new Xn,this._clipboard=!1,this._commandLine=!1,this._disableSanitizer=!1,this._emoji=!1,this._inline=!1,this._katex=!1,this._lineHighlight=!1,this._lineNumbers=!1,this._mermaid=!1,this.destroyed$=new ii}ngOnChanges(){this.loadContent()}loadContent(){null==this.data?null==this.src||this.handleSrc():this.handleData()}ngAfterViewInit(){!this.data&&!this.src&&this.handleTransclusion(),this.markdownService.reload$.pipe(GL(this.destroyed$)).subscribe(()=>this.loadContent())}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}render(t,i=!1){var r=this;return Hn(function*(){const s={decodeHtml:i,inline:r.inline,emoji:r.emoji,mermaid:r.mermaid,disableSanitizer:r.disableSanitizer},o={clipboard:r.clipboard,clipboardOptions:r.getClipboardOptions(),katex:r.katex,katexOptions:r.katexOptions,mermaid:r.mermaid,mermaidOptions:r.mermaidOptions},a=yield r.markdownService.parse(t,s);r.element.nativeElement.innerHTML=a,r.handlePlugins(),r.markdownService.render(r.element.nativeElement,o,r.viewContainerRef),r.ready.emit()})()}coerceBooleanProperty(t){return null!=t&&"false"!=`${String(t)}`}getClipboardOptions(){if(this.clipboardButtonComponent||this.clipboardButtonTemplate)return{buttonComponent:this.clipboardButtonComponent,buttonTemplate:this.clipboardButtonTemplate}}handleData(){this.render(this.data)}handleSrc(){this.markdownService.getSource(this.src).subscribe({next:t=>{this.render(t).then(()=>{this.load.emit(t)})},error:t=>this.error.emit(t)})}handleTransclusion(){this.render(this.element.nativeElement.innerHTML,!0)}handlePlugins(){this.commandLine&&(this.setPluginClass(this.element.nativeElement,DM.CommandLine),this.setPluginOptions(this.element.nativeElement,{dataFilterOutput:this.filterOutput,dataHost:this.host,dataPrompt:this.prompt,dataOutput:this.output,dataUser:this.user})),this.lineHighlight&&this.setPluginOptions(this.element.nativeElement,{dataLine:this.line,dataLineOffset:this.lineOffset}),this.lineNumbers&&(this.setPluginClass(this.element.nativeElement,DM.LineNumbers),this.setPluginOptions(this.element.nativeElement,{dataStart:this.start}))}setPluginClass(t,i){const r=t.querySelectorAll("pre");for(let s=0;s<r.length;s++){const o=i instanceof Array?i:[i];r.item(s).classList.add(...o)}}setPluginOptions(t,i){const r=t.querySelectorAll("pre");for(let s=0;s<r.length;s++)Object.keys(i).forEach(o=>{const a=i[o];if(a){const l=this.toLispCase(o);r.item(s).setAttribute(l,a.toString())}})}toLispCase(t){const i=t.match(/([A-Z])/g);if(!i)return t;let r=t.toString();for(let s=0,o=i.length;s<o;s++)r=r.replace(new RegExp(i[s]),"-"+i[s].toLowerCase());return"-"===r.slice(0,1)&&(r=r.slice(1)),r}static{this.\u0275fac=function(i){return new(i||n)(Be(ys),Be(AM),Be(fr))}}static{this.\u0275cmp=Zs({type:n,selectors:[["markdown"],["","markdown",""]],inputs:{data:"data",src:"src",disableSanitizer:"disableSanitizer",inline:"inline",clipboard:"clipboard",clipboardButtonComponent:"clipboardButtonComponent",clipboardButtonTemplate:"clipboardButtonTemplate",emoji:"emoji",katex:"katex",katexOptions:"katexOptions",mermaid:"mermaid",mermaidOptions:"mermaidOptions",lineHighlight:"lineHighlight",line:"line",lineOffset:"lineOffset",lineNumbers:"lineNumbers",start:"start",commandLine:"commandLine",filterOutput:"filterOutput",host:"host",prompt:"prompt",output:"output",user:"user"},outputs:{error:"error",load:"load",ready:"ready"},features:[Ua],ngContentSelectors:xK,decls:1,vars:0,template:function(i,r){1&i&&(function ER(n){const e=U()[15][5];if(!e.projection){const i=e.projection=function pp(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){if(128!==s.type){const o=n?n$(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s)}s=s.next}}}(),function SR(n,e=0,t,i,r,s){const o=U(),a=tt(),l=i?n+1:null;null!==l&&ph(o,a,l,i,r,s,null,t);const c=Ja(a,25+n,16,null,t||null);null===c.projection&&(c.projection=e),B_();const d=!o[6]||za();null===o[15][5].projection[c.projection]&&null!==l?function i$(n,e,t){const i=25+t,r=e.data[i];Oc(n[i],Lc(n,r,void 0,{dehydratedView:null}),0,Qa(r,null))}(o,a,l):d&&32&~c.flags&&function _4(n,e,t){PA(e[11],0,e,t,ux(n,t,e),DA(t.parent||e[5],t,e))}(a,o,c)}(0))},encapsulation:2})}}return n})();function AO(n){return[AM,n?.loader??[],n?.clipboardOptions??[],n?.markedOptions??[],n?.mermaidOptions??[],{provide:TO,useValue:n?.markedExtensions??[]},{provide:CO,useValue:n?.sanitize??Xi.HTML}]}let IO=(()=>{class n{static forRoot(t){return{ngModule:n,providers:[AO(t)]}}static forChild(){return{ngModule:n}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=Vc({type:n})}static{this.\u0275inj=Ra({imports:[wm]})}}return n})();function LK(n,e){if(1&n&&(ae(0,"div"),Ze(1),gt(2,"translate"),gt(3,"date"),ue()),2&n){const t=Ji(2);Te(),Eh("",Et(2,2,"projectDetails.beginDate")," ",Wg(3,4,null==t.project?null:t.project.startDate,"dd-M-yyyy"),"")}}function OK(n,e){if(1&n&&(ae(0,"div"),Ze(1),gt(2,"translate"),gt(3,"date"),ue()),2&n){const t=Ji(2);Te(),Eh(" ",Et(2,2,"projectDetails.date")," ",Wg(3,4,null==t.project?null:t.project.endDate,"dd-M-yyyy"),"")}}function FK(n,e){if(1&n&&(ae(0,"div",6),si(),ae(1,"svg",2),$t(2,"path",7),ue(),ci(3,LK,4,7,"div",8)(4,OK,4,7,"div",8),ue()),2&n){const t=Ji();Te(3),It("ngIf",null==t.project?null:t.project.startDate),Te(),It("ngIf",null==t.project?null:t.project.endDate)}}function kK(n,e){if(1&n&&(ae(0,"span",28),Ze(1),gt(2,"translate"),ue()),2&n){const t=e.$implicit;Te(),Dn(" ",Et(2,1,t)," ")}}function UK(n,e){if(1&n&&(ae(0,"div",29)(1,"a",30),si(),ae(2,"svg",2),$t(3,"path",31),ue(),Ze(4," Visit Project "),ue()()),2&n){const t=Ji(2);Te(),It("href",t.project.projectUrl,zo)}}function BK(n,e){if(1&n&&(ae(0,"div",33)(1,"a",34),si(),ae(2,"svg",35),$t(3,"path",36)(4,"path",37),ue(),Ze(5," Play on itch.io "),ue()()),2&n){const t=Ji(3);Te(),It("href",t.project.itchIoUrl,zo)}}function VK(n,e){if(1&n&&(ae(0,"div",10)(1,"h2",17),Ze(2,"Play the Game"),ue(),ci(3,BK,6,1,"div",32),ue()),2&n){const t=Ji(2);Te(3),It("ngIf",t.project.itchIoUrl)}}function zK(n,e){if(1&n&&(ae(0,"div",26)(1,"h3",40),Ze(2),ue(),ae(3,"div",41),$t(4,"iframe",42),gt(5,"safe"),ue()()),2&n){const t=e.$implicit;Te(2),Zn(t.title),Te(2),It("src",Wg(5,3,t.url,"resourceUrl"),j0)("title",t.title)}}function HK(n,e){if(1&n&&(ae(0,"div",9)(1,"h2",17),Ze(2),gt(3,"translate"),ue(),ae(4,"div",38),ci(5,zK,6,6,"div",39),ue()()),2&n){const t=Ji(2);Te(2),Dn(" ",Et(3,2,"projectDetails.Videos"),""),Te(3),It("ngForOf",t.project.videos)}}function GK(n,e){if(1&n&&(ae(0,"div",43),$t(1,"img",44),ue()),2&n){const t=e.$implicit,i=Ji(2);Te(),It("src",t,zo)("alt",i.project.name+" screenshot")}}function jK(n,e){1&n&&(ae(0,"a",30),si(),ae(1,"svg",45),$t(2,"path",46),ue(),Ze(3," View on GitHub "),ue()),2&n&&It("href",Ji(2).project.githubUrl,zo)}function $K(n,e){1&n&&(ae(0,"a",30),si(),ae(1,"svg",35),$t(2,"path",47),ue(),Ze(3," View on GitLab "),ue()),2&n&&It("href",Ji(2).project.gitlabUrl,zo)}function WK(n,e){if(1&n&&(ae(0,"li",48),si(),ae(1,"svg",49),$t(2,"path",50),ue(),Ze(3),gt(4,"translate"),ue()),2&n){const t=e.$implicit;Te(3),Dn(" ",Et(4,1,t)," ")}}function qK(n,e){if(1&n&&(ae(0,"li",48),si(),ae(1,"svg",49),$t(2,"path",51),ue(),Ze(3),gt(4,"translate"),ue()),2&n){const t=e.$implicit;Te(3),Dn(" ",Et(4,1,t)," ")}}function XK(n,e){if(1&n&&(ae(0,"div",9)(1,"header",10)(2,"h1",11)(3,"span",12),Ze(4),gt(5,"translate"),ue()(),ae(6,"div",13),ci(7,kK,3,3,"span",14),ue()(),ci(8,UK,5,1,"div",15)(9,VK,4,1,"div",16)(10,HK,6,4,"div",5),ae(11,"div",10)(12,"h2",17),Ze(13),gt(14,"translate"),ue(),ae(15,"div",18),ci(16,GK,2,2,"div",19),ue()(),ae(17,"div",20)(18,"div",21)(19,"h1",22),Ze(20),gt(21,"translate"),ue(),$t(22,"markdown",23),gt(23,"translate"),ue(),ae(24,"div",24),ci(25,jK,4,1,"a",25)(26,$K,4,1,"a",25),ue()(),ae(27,"div",18)(28,"div",10)(29,"h2",17),Ze(30),gt(31,"translate"),ue(),ae(32,"ul",26),ci(33,WK,5,3,"li",27),ue()(),ae(34,"div",10)(35,"h2",17),Ze(36),gt(37,"translate"),ue(),ae(38,"ul",26),ci(39,qK,5,3,"li",27),ue()()()()),2&n){const t=Ji();Te(4),Zn(Et(5,15,t.project.name)),Te(3),It("ngForOf",t.project.technologies),Te(),It("ngIf",t.project.projectUrl),Te(),It("ngIf",t.project.itchIoUrl),Te(),It("ngIf",t.project.videos&&t.project.videos.length>0),Te(3),Zn(Et(14,17,"projectDetails.Screenshoots")),Te(3),It("ngForOf",t.project.screenshots),Te(4),Dn(" ",Et(21,19,"projectDetails.Description")," "),Te(2),It("data",Et(23,21,t.project.fullDescription)),Te(3),It("ngIf",t.project.githubUrl),Te(),It("ngIf",t.project.gitlabUrl),Te(4),Zn(Et(31,23,"projectDetails.KeyFeatures")),Te(3),It("ngForOf",t.project.features),Te(3),Zn(Et(37,25,"projectDetails.TechnicalChallenges")),Te(3),It("ngForOf",t.project.challenges)}}let YK=(()=>{class n{route;sanitizer;project;loadingProgress=0;constructor(t,i){this.route=t,this.sanitizer=i}ngOnInit(){const t=this.route.snapshot.paramMap.get("id");this.project=lM.find(i=>i.id===t)}static \u0275fac=function(i){return new(i||n)(Be(fl),Be(Vh))};static \u0275cmp=Zs({type:n,selectors:[["app-project-details"]],decls:8,vars:5,consts:[[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-12"],["routerLink","/",1,"inline-flex","items-center","gap-2","text-text-secondary","hover:text-accent","transition-colors","mb-8"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5"],["fill-rule","evenodd","d","M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z","clip-rule","evenodd"],["class","flex items-center mb-6 gap-2 text-text-secondary",4,"ngIf"],["class","space-y-8",4,"ngIf"],[1,"flex","items-center","mb-6","gap-2","text-text-secondary"],["fill-rule","evenodd","d","M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z","clip-rule","evenodd"],[4,"ngIf"],[1,"space-y-8"],[1,"space-y-4"],[1,"text-4xl","font-bold","tracking-tight"],[1,"text-gradient"],[1,"flex","flex-wrap","gap-2"],["class","bg-bg-primary/50 px-4 py-2 rounded-lg text-sm font-medium",4,"ngFor","ngForOf"],["class","flex flex-wrap gap-4 pt-4",4,"ngIf"],["class","space-y-4",4,"ngIf"],[1,"text-2xl","font-semibold"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8"],["class","aspect-video rounded-xl overflow-hidden",4,"ngFor","ngForOf"],[1,"space-y-6"],[1,"prose","prose-invert","max-w-none"],[1,"text-2xl","font-semibold","mb-6"],[1,"text-xl","text-text-secondary",3,"data"],[1,"flex","flex-wrap","gap-4"],["target","_blank","rel","noopener noreferrer","class","inline-flex items-center gap-2 bg-accent hover:bg-accent-hover text-white px-6 py-3 rounded-xl font-medium transition-all duration-300 hover:scale-105",3,"href",4,"ngIf"],[1,"space-y-2"],["class","flex items-center gap-2",4,"ngFor","ngForOf"],[1,"bg-bg-primary/50","px-4","py-2","rounded-lg","text-sm","font-medium"],[1,"flex","flex-wrap","gap-4","pt-4"],["target","_blank","rel","noopener noreferrer",1,"inline-flex","items-center","gap-2","bg-accent","hover:bg-accent-hover","text-white","px-6","py-3","rounded-xl","font-medium","transition-all","duration-300","hover:scale-105",3,"href"],["fill-rule","evenodd","d","M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z","clip-rule","evenodd"],["class","text-center",4,"ngIf"],[1,"text-center"],["target","_blank","rel","noopener noreferrer",1,"inline-flex","items-center","gap-2","bg-[#FA5C5C]","hover:bg-[#E44D4D]","text-white","px-6","py-3","rounded-xl","font-medium","transition-all","duration-300","hover:scale-105",3,"href"],["viewBox","0 0 24 24","fill","currentColor",1,"w-5","h-5"],["d","M3.13 1.338C2.08 1.96.02 4.328 0 4.95v1.03c0 1.303 1.22 2.45 2.325 2.45 1.33 0 2.436-1.102 2.436-2.41 0 1.308 1.07 2.41 2.4 2.41 1.328 0 2.362-1.102 2.362-2.41 0 1.308 1.137 2.41 2.466 2.41h.024c1.33 0 2.466-1.102 2.466-2.41 0 1.308 1.034 2.41 2.363 2.41 1.33 0 2.4-1.102 2.4-2.41 0 1.308 1.106 2.41 2.435 2.41C22.78 8.43 24 7.282 24 5.98V4.95c-.02-.622-2.08-2.99-3.13-3.612-3.382-.192-5.444-.29-8.87-.29s-5.488.098-8.87.29z"],["d","M2.622 10.97c-.037.98-.042 1.94-.03 2.89-.06 3.54-.015 7.09-.03 10.63 1.384.39 2.798.693 4.242.89.526-1.06 1.053-2.11 1.512-3.2.38.195.79.37 1.208.505.91-.47 1.81-.97 2.67-1.53.84.56 1.73 1.06 2.63 1.53.44-.14.87-.32 1.27-.53.45 1.09.97 2.14 1.49 3.2 1.44-.19 2.86-.5 4.24-.89-.05-4.51-.01-9.01-.03-13.52.01-.12.01-.23.01-.35-1.63.39-3.27.71-4.95.89-.66.73-1.45 1.33-2.31 1.85-.85-.52-1.64-1.12-2.3-1.85-1.68-.18-3.32-.5-4.95-.89-.02.11-.02.23-.01.35-.02 1.43-.03 2.86-.03 4.3-.05.83.04 1.66-.15 2.47-.48-.97-1.08-1.87-1.82-2.65-.45.27-.89.57-1.3.9-.02-.91-.03-1.82-.02-2.73-.05-.83.04-1.66-.15-2.47-.46.92-1.02 1.79-1.71 2.54-.5-.3-.99-.62-1.45-.97z"],[1,"grid","grid-cols-1","gap-8"],["class","space-y-2",4,"ngFor","ngForOf"],[1,"text-lg","font-medium","text-text-secondary"],[1,"aspect-video","rounded-xl","overflow-hidden","bg-bg-secondary"],["frameborder","0","allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share","referrerpolicy","strict-origin-when-cross-origin","allowfullscreen","",1,"w-full","h-full",3,"src","title"],[1,"aspect-video","rounded-xl","overflow-hidden"],[1,"w-full","h-full","object-cover",3,"src","alt"],["fill","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["fill-rule","evenodd","d","M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z","clip-rule","evenodd"],["d","M22.65 14.39L12 22.13 1.35 14.39a.84.84 0 0 1-.3-.94l1.22-3.78 2.44-7.51A.42.42 0 0 1 4.82 2a.43.43 0 0 1 .58 0 .42.42 0 0 1 .11.18l2.44 7.49h8.1l2.44-7.51A.42.42 0 0 1 18.6 2a.43.43 0 0 1 .58 0 .42.42 0 0 1 .11.18l2.44 7.51L23 13.45a.84.84 0 0 1-.35.94z"],[1,"flex","items-center","gap-2"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5","text-accent"],["fill-rule","evenodd","d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule","evenodd"],["fill-rule","evenodd","d","M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z","clip-rule","evenodd"]],template:function(i,r){1&i&&(ae(0,"div",0)(1,"a",1),si(),ae(2,"svg",2),$t(3,"path",3),ue(),Ze(4),gt(5,"translate"),ue(),ci(6,FK,5,2,"div",4)(7,XK,40,27,"div",5),ue()),2&i&&(Te(4),Dn(" ",Et(5,3,"BackToPortfolio")," "),Te(2),It("ngIf",(null==r.project?null:r.project.startDate)||(null==r.project?null:r.project.endDate)),Te(),It("ngIf",r.project))},dependencies:[wm,ob,ab,HP,tM,nf,AJ,uv,dO,IO,DO],encapsulation:2})}return n})();const ZK=[{name:"skillCategories.gameEngines",skills:[{name:"skills.unity",proficiency:90,description:"description.unity"},{name:"skills.unreal",proficiency:80,description:"description.unreal"},{name:"skills.ionic",proficiency:70,description:"description.ionic"}]},{name:"skillCategories.programming",skills:[{name:"skills.c#",proficiency:90,description:"description.c#"},{name:"skills.typescript",proficiency:80,description:"description.typescript"},{name:"skills.c++",proficiency:60,description:"description.c++"}]},{name:"skillCategories.tools",skills:[{name:"skills.angular",proficiency:90,description:"description.angular"},{name:"skills.git",proficiency:85,description:"description.git"},{name:"skills.photo&utils",proficiency:50,description:"description.photo&utils"}]}],RO=n=>["/project",n];function JK(n,e){1&n&&(ae(0,"div",2)(1,"a",3),Ze(2,"alfonsolopezviejo@gmail.com"),ue()())}function KK(n,e){if(1&n&&(ae(0,"span",63),Ze(1),gt(2,"translate"),ue()),2&n){const t=e.$implicit;Te(),Dn(" ",Et(2,1,t)," ")}}function QK(n,e){if(1&n&&(ae(0,"div",51)(1,"div",52)(2,"div",53),$t(3,"img",54),ue(),ae(4,"div",55)(5,"h3",56)(6,"a",57),Ze(7),gt(8,"translate"),ue()(),ae(9,"p",58),Ze(10),gt(11,"translate"),ue(),ae(12,"div",59),ci(13,KK,3,3,"span",60),ue(),ae(14,"div",61)(15,"a",62)(16,"span"),Ze(17),gt(18,"translate"),ue(),si(),ae(19,"svg",48),$t(20,"path",49),ue()()()()()()),2&n){const t=e.$implicit;Te(3),It("src",t.imageUrl,zo)("alt",t.name+" Screenshot"),Te(3),It("routerLink",Cw(14,RO,t.id)),Te(),Dn(" ",Et(8,8,t.name)," "),Te(3),Dn(" ",Et(11,10,t.shortDescription)," "),Te(3),It("ngForOf",t.technologies),Te(2),It("routerLink",Cw(16,RO,t.id)),Te(2),Zn(Et(18,12,"projectsViewDetails"))}}function eQ(n,e){if(1&n&&(ae(0,"p",33),Ze(1),gt(2,"translate"),ue()),2&n){const t=Ji().$implicit;Te(),Dn(" ",Et(2,1,t.description)," ")}}function tQ(n,e){if(1&n&&(ae(0,"div",66)(1,"div",67)(2,"span",68),Ze(3),gt(4,"translate"),ue(),ae(5,"span",69),Ze(6),ue()(),ae(7,"div",70),$t(8,"div",71),ue(),ci(9,eQ,3,3,"p",72),ue()),2&n){const t=e.$implicit;Te(3),Zn(Et(4,5,t.name)),Te(3),Dn("",t.proficiency,"%"),Te(2),lw("width",t.proficiency,"%"),Te(),It("ngIf",t.description)}}function nQ(n,e){if(1&n&&(ae(0,"div",24)(1,"h3",64),Ze(2),gt(3,"translate"),ue(),ae(4,"div",24),ci(5,tQ,10,7,"div",65),ue()()),2&n){const t=e.$implicit;Te(2),Zn(Et(3,2,t.name)),Te(3),It("ngForOf",t.skills)}}function iQ(n,e){if(1&n&&(ae(0,"div",4)(1,"header",5),$t(2,"div",6),ae(3,"h1",7)(4,"span",8),Ze(5,"Alfonso L\xf3pez Viejo"),ue()(),ae(6,"h2",9),Ze(7),gt(8,"translate"),ue(),ae(9,"p",10),Ze(10),gt(11,"translate"),ue(),ae(12,"div",11)(13,"a",12),si(),ae(14,"svg",13),$t(15,"path",14),ue()(),Ws(),ae(16,"a",15),si(),ae(17,"svg",13),$t(18,"path",16),ue()(),Ws(),ae(19,"a",17),si(),ae(20,"svg",18),$t(21,"path",19),ue()(),Ws(),ae(22,"a",20),si(),ae(23,"svg",18),$t(24,"path",21),ue()()()(),Ws(),ae(25,"section",22)(26,"div",23)(27,"div",24)(28,"h2",25)(29,"span",8),Ze(30),gt(31,"translate"),ue()(),ae(32,"div",26)(33,"p"),Ze(34),gt(35,"translate"),ue(),ae(36,"p"),Ze(37),gt(38,"translate"),ue(),ae(39,"p"),Ze(40),gt(41,"translate"),ue(),ae(42,"p"),Ze(43),gt(44,"translate"),ue()(),ae(45,"div",27)(46,"div",28)(47,"div",29),si(),ae(48,"svg",30),$t(49,"path",31),ue()(),Ws(),ae(50,"div")(51,"div",32),Ze(52),gt(53,"translate"),ue(),ae(54,"div",33),Ze(55),gt(56,"translate"),ue()()(),ae(57,"div",28)(58,"div",29),si(),ae(59,"svg",30),$t(60,"path",34),ue()(),Ws(),ae(61,"div")(62,"div",32),Ze(63,"10+"),ue(),ae(64,"div",33),Ze(65),gt(66,"translate"),ue()()(),ae(67,"div",28)(68,"div",29),si(),ae(69,"svg",30),$t(70,"path",34),ue()(),Ws(),ae(71,"div")(72,"div",32),Ze(73,"2"),ue(),ae(74,"div",33),Ze(75),gt(76,"translate"),ue()()()()(),ae(77,"div",35)(78,"div",36),$t(79,"img",37),ue(),$t(80,"div",38),ue()()(),ae(81,"section",22)(82,"h2",39)(83,"span",8),Ze(84),gt(85,"translate"),ue()(),ae(86,"div",40),ci(87,QK,21,18,"div",41),ue()(),ae(88,"section",22)(89,"h2",39)(90,"span",8),Ze(91),gt(92,"translate"),ue()(),ae(93,"div",42),ci(94,nQ,6,4,"div",43),ue()(),ae(95,"section",44)(96,"h2",45)(97,"span",8),Ze(98),gt(99,"translate"),ue()(),ae(100,"p",46),Ze(101),gt(102,"translate"),ue(),ae(103,"a",47),Ze(104),gt(105,"translate"),si(),ae(106,"svg",48),$t(107,"path",49),ue()()(),Ws(),ae(108,"footer",50)(109,"p"),Ze(110),gt(111,"translate"),ue()()()),2&n){const t=Ji();Te(7),Zn(Et(8,20,"ProfessionName")),Te(3),Dn(" ",Et(11,22,"ProfessionSubtitle")," "),Te(20),Zn(Et(31,24,"AboutMe.Title")),Te(4),Dn(" ",Et(35,26,"AboutMe.DescriptionP1")," "),Te(3),Dn(" ",Et(38,28,"AboutMe.DescriptionP2")," "),Te(3),Dn(" ",Et(41,30,"AboutMe.DescriptionP2")," "),Te(3),Dn(" ",Et(44,32,"AboutMe.DescriptionP4")," "),Te(9),Dn("4+ ",Et(53,34,"AboutMe.YearsOfExperience"),""),Te(3),Zn(Et(56,36,"AboutMe.Experience")),Te(10),Zn(Et(66,38,"AboutMe.MobileProjects")),Te(10),Zn(Et(76,40,"AboutMe.VideogamesProjects")),Te(9),Zn(Et(85,42,"projectsTitle")),Te(3),It("ngForOf",t.projects),Te(4),Zn(Et(92,44,"TechnicalSkills")),Te(3),It("ngForOf",t.skillCategories),Te(4),Zn(Et(99,46,"footer.title")),Te(3),Dn(" ",Et(102,48,"footer.description")," "),Te(3),Dn(" ",Et(105,50,"footer.contactme")," "),Te(6),Eh("\xa9 ",t.currentYear," Alfonso L\xf3pez Viejo. ",Et(111,52,"footer.allrightsreserved"),"")}}const rQ=[{path:"",component:(()=>{class n{isReady=!1;title="AlfonsoLopezViejo.Github.io";currentYear=(new Date).getFullYear();projects=new Array;skillCategories=new Array;constructor(){this.projects=lM,this.skillCategories=ZK}ngOnInit(){this.isReady=!0}getArrayTranslations(){}changeLanguage(t){}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zs({type:n,selectors:[["app-home"]],decls:2,vars:2,consts:[["class","float-left px-5 py-0 mt-6",4,"ngIf"],["class","max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",4,"ngIf"],[1,"float-left","px-5","py-0","mt-6"],["href","mailto:hola@bisoul.es","title","Correo electr\xf3nico",1,"text-text-secondary","underline","text-lg","max-w-2xl","mx-auto"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-12"],[1,"my-20","space-y-4","text-center"],[1,"inline-block","mb-4","px-4","py-1.5","bg-accent/10","rounded-full"],[1,"text-5xl","sm:text-6xl","font-bold","tracking-tight"],[1,"text-gradient"],[1,"text-2xl","sm:text-3xl","font-medium","text-accent/90"],[1,"text-text-secondary","text-lg","max-w-2xl","mx-auto","mt-6"],[1,"flex","justify-center","gap-4","mt-8"],["href","https://bitbucket.org/Fonso15/","target","_blank","rel","noopener noreferrer",1,"text-text-secondary","hover:text-accent","transition-colors"],["fill","currentColor","viewBox","0 0 24 24","aria-hidden","true",1,"w-8","h-8"],["fill-rule","evenodd","d","M.778 1.211c-.424-.006-.772.334-.778.758 0 .045.002.09.01.134l3.263 19.811c.084.499.515.867 1.022.872H19.95c.382.004.708-.271.77-.646l3.27-20.03c.068-.418-.216-.813-.635-.881-.045-.008-.089-.011-.133-.01L.778 1.211zM14.52 15.528H9.522L8.17 8.464h7.561l-1.211 7.064z","clip-rule","evenodd"],["href","https://github.com/AlfonsoLopezViejo","target","_blank","rel","noopener noreferrer",1,"text-text-secondary","hover:text-accent","transition-colors"],["fill-rule","evenodd","d","M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z","clip-rule","evenodd"],["href","https://gitlab.com/Fonso","target","_blank","rel","noopener noreferrer",1,"text-text-secondary","hover:text-accent","transition-colors"],["viewBox","0 0 24 24","fill","currentColor",1,"w-8","h-8"],["d","M22.65 14.39L12 22.13 1.35 14.39a.84.84 0 0 1-.3-.94l1.22-3.78 2.44-7.51A.42.42 0 0 1 4.82 2a.43.43 0 0 1 .58 0 .42.42 0 0 1 .11.18l2.44 7.49h8.1l2.44-7.51A.42.42 0 0 1 18.6 2a.43.43 0 0 1 .58 0 .42.42 0 0 1 .11.18l2.44 7.51L23 13.45a.84.84 0 0 1-.35.94z"],["href","https://www.linkedin.com/in/alfonso-l\xf3pez-viejo-b63510171","target","_blank","rel","noopener noreferrer",1,"text-text-secondary","hover:text-accent","transition-colors"],["d","M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"],[1,"my-32"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-12","items-center"],[1,"space-y-6"],[1,"text-3xl","font-bold"],[1,"space-y-4","text-lg","text-text-secondary"],[1,"flex","flex-wrap","gap-6","pt-4"],[1,"flex","items-center","gap-2"],[1,"w-12","h-12","flex","items-center","justify-center","bg-accent/10","rounded-xl"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6","text-accent"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"],[1,"font-semibold"],[1,"text-sm","text-text-secondary"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"],[1,"relative"],[1,"aspect-square","rounded-2xl","overflow-hidden"],["src","../../assets/profile_photo.jpg","alt","Profile",1,"w-full","h-full","object-cover"],[1,"absolute","-bottom-6","-right-6","-z-10","w-full","h-full","bg-gradient-to-r","from-accent","to-accent-hover","rounded-2xl","opacity-20"],[1,"text-3xl","font-bold","mb-12","text-center"],[1,"space-y-8"],["class","group bg-bg-secondary backdrop-blur-sm bg-opacity-50 p-8 rounded-2xl border border-white/5 transition-all duration-300 hover:border-accent/20 hover:shadow-lg hover:shadow-accent/5",4,"ngFor","ngForOf"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-12"],["class","space-y-6",4,"ngFor","ngForOf"],[1,"my-32","text-center"],[1,"text-3xl","font-bold","mb-6"],[1,"text-text-secondary","text-lg","mb-8","max-w-2xl","mx-auto"],["href","mailto:alfonsolopezviejo@gmail.com",1,"inline-flex","items-center","gap-2","bg-accent","hover:bg-accent-hover","text-white","px-8","py-4","rounded-xl","font-medium","transition-all","duration-300","hover:scale-105","hover:shadow-lg","hover:shadow-accent/20"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5"],["fill-rule","evenodd","d","M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z","clip-rule","evenodd"],[1,"text-center","py-8","text-text-secondary","border-t","border-white/5","mt-32"],[1,"group","bg-bg-secondary","backdrop-blur-sm","bg-opacity-50","p-8","rounded-2xl","border","border-white/5","transition-all","duration-300","hover:border-accent/20","hover:shadow-lg","hover:shadow-accent/5"],[1,"flex","flex-col","sm:flex-row","gap-6","items-start"],[1,"w-full","sm:w-1/2","aspect-video","rounded-xl","overflow-hidden"],[1,"w-full","h-full","object-cover","transform","group-hover:scale-[1.02]","transition-transform","duration-300",3,"src","alt"],[1,"flex-1"],[1,"text-2xl","font-semibold","group-hover:text-accent","transition-colors"],[1,"hover:text-accent","transition-colors",3,"routerLink"],[1,"text-text-secondary","mt-3","leading-relaxed"],[1,"flex","flex-wrap","gap-2","mt-6"],["class","bg-bg-primary/50 px-4 py-2 rounded-lg text-sm font-medium",4,"ngFor","ngForOf"],[1,"mt-6","flex","gap-4"],[1,"inline-flex","items-center","gap-2","text-text-secondary","hover:text-accent","transition-colors",3,"routerLink"],[1,"bg-bg-primary/50","px-4","py-2","rounded-lg","text-sm","font-medium"],[1,"text-2xl","font-semibold"],["class","space-y-2",4,"ngFor","ngForOf"],[1,"space-y-2"],[1,"flex","justify-between","items-center"],[1,"font-medium"],[1,"text-text-secondary"],[1,"h-2","bg-bg-secondary","rounded-full","overflow-hidden"],[1,"h-full","bg-gradient-to-r","from-accent","to-accent-hover","rounded-full","transition-all","duration-500"],["class","text-sm text-text-secondary",4,"ngIf"]],template:function(i,r){1&i&&ci(0,JK,3,0,"div",0)(1,iQ,112,54,"div",1),2&i&&(It("ngIf",r.isReady),Te(),It("ngIf",r.isReady))},dependencies:[wm,ob,ab,tM,nf,uv,dO],encapsulation:2})}return n})()},{path:"project/:id",component:YK}],oQ={providers:[function b6(n){const e=n?.ignoreChangesOutsideZone,t=n?.scheduleInRootZone,i=Nw({ngZoneFactory:()=>{const r=Pw(n);return r.scheduleInRootZone=t,r.shouldCoalesceEventChangeDetection&&oi("NgZone_CoalesceEvent"),new Ot(r)},ignoreChangesOutsideZone:e,scheduleInRootZone:t});return Vs([{provide:w6,useValue:!0},{provide:Rd,useValue:!1},i])}({eventCoalescing:!0}),function DZ(n,...e){return Vs([{provide:_u,multi:!0,useValue:n},[],{provide:fl,useFactory:B2,deps:[ro]},{provide:jc,multi:!0,useFactory:V2},e.map(t=>t.\u0275providers)])}(rQ),function gJ(...n){const e=[ev,sO,iO,{provide:Zm,useExisting:iO},{provide:Jm,useFactory:()=>W(Q2,{optional:!0})??W(sO)},{provide:af,useValue:pJ,multi:!0},{provide:aM,useValue:!0},{provide:lO,useClass:fJ}];for(const t of n)e.push(...t.\u0275providers);return Vs(e)}(),bT([uv.forRoot({loader:{provide:wu,useFactory:n=>new DJ(n,"./assets/i18n/",".json"),deps:[ev]}})]),AO({sanitize:Xi.NONE})]},oa=0,er=1,oo=2,_l=100,dQ=101,hQ=102,gQ=200,mQ=201,vQ=202,yQ=203,RM=204,NM=205,_Q=206,xQ=207,wQ=208,bQ=209,MQ=210,EQ=211,SQ=212,TQ=213,CQ=214,PM=0,LM=1,OM=2,Eu=3,FM=4,kM=5,UM=6,BM=7,xv=1e3,ns=1001,wv=1002,bi=1003,UO=1004,_f=1005,ui=1006,bv=1007,ao=1008,lo=1009,xf=1012,ua=1014,yr=1015,wf=1016,Su=1020,tr=1023,Tu=1026,Cu=1027,Ev=33776,Sv=33777,Tv=33778,Cv=33779,Dv=36492,_r="srgb",Iu="srgb-linear",Rv="linear",nn="srgb",Ru=7680,jQ=512,$Q=513,WQ=514,ZO=515,qQ=516,XQ=517,YQ=518,ZQ=519,Is=2e3;class co{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Mi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],bl=Math.PI/180,Nu=180/Math.PI;function xr(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Mi[255&n]+Mi[n>>8&255]+Mi[n>>16&255]+Mi[n>>24&255]+"-"+Mi[255&e]+Mi[e>>8&255]+"-"+Mi[e>>16&15|64]+Mi[e>>24&255]+"-"+Mi[63&t|128]+Mi[t>>8&255]+"-"+Mi[t>>16&255]+Mi[t>>24&255]+Mi[255&i]+Mi[i>>8&255]+Mi[i>>16&255]+Mi[i>>24&255]).toLowerCase()}function ft(n,e,t){return Math.max(e,Math.min(t,n))}function bf(n,e,t){return(1-t)*n+t*e}function ki(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function mt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(4294967295*n);case Uint16Array:return Math.round(65535*n);case Uint8Array:return Math.round(255*n);case Int32Array:return Math.round(2147483647*n);case Int16Array:return Math.round(32767*n);case Int8Array:return Math.round(127*n);default:throw new Error("Invalid component type.")}}class ee{constructor(e=0,t=0){ee.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=ft(this.x,e.x,t.x),this.y=ft(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=ft(this.x,e,t),this.y=ft(this.y,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(ft(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(ft(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class vt{constructor(e,t,i,r,s,o,a,l,c){vt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c)}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],d=i[7],h=i[2],f=i[5],p=i[8],v=r[0],m=r[3],g=r[6],y=r[1],_=r[4],x=r[7],T=r[2],E=r[5],C=r[8];return s[0]=o*v+a*y+l*T,s[3]=o*m+a*_+l*E,s[6]=o*g+a*x+l*C,s[1]=c*v+u*y+d*T,s[4]=c*m+u*_+d*E,s[7]=c*g+u*x+d*C,s[2]=h*v+f*y+p*T,s[5]=h*m+f*_+p*E,s[8]=h*g+f*x+p*C,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=a*l-u*s,f=c*s-o*l,p=t*d+i*h+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const v=1/p;return e[0]=d*v,e[1]=(r*c-u*i)*v,e[2]=(a*i-r*o)*v,e[3]=h*v,e[4]=(u*t-r*l)*v,e[5]=(r*s-a*t)*v,e[6]=f*v,e[7]=(i*l-c*t)*v,e[8]=(o*t-i*s)*v,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(ME.makeScale(e,t)),this}rotate(e){return this.premultiply(ME.makeRotation(-e)),this}translate(e,t){return this.premultiply(ME.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const ME=new vt;function QO(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function Mf(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function pee(){const n=Mf("canvas");return n.style.display="block",n}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const eF={};function Lu(n){n in eF||(eF[n]=!0,console.warn(n))}const tF=(new vt).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),nF=(new vt).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function yee(){const n={enabled:!0,workingColorSpace:Iu,spaces:{},convert:function(r,s,o){return!1===this.enabled||s===o||!s||!o||(this.spaces[s].transfer===nn&&(r.r=uo(r.r),r.g=uo(r.g),r.b=uo(r.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===nn&&(r.r=Ou(r.r),r.g=Ou(r.g),r.b=Ou(r.b))),r},fromWorkingColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},toWorkingColorSpace:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return""===r?Rv:this.spaces[r].transfer},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,o){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],i=[.3127,.329];return n.define({[Iu]:{primaries:e,whitePoint:i,transfer:Rv,toXYZ:tF,fromXYZ:nF,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:_r},outputColorSpaceConfig:{drawingBufferColorSpace:_r}},[_r]:{primaries:e,whitePoint:i,transfer:nn,toXYZ:tF,fromXYZ:nF,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:_r}}}),n}const Ft=yee();function uo(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function Ou(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}let Fu;class _ee{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Fu&&(Fu=Mf("canvas")),Fu.width=e.width,Fu.height=e.height;const i=Fu.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Fu}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Mf("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*uo(s[o]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*uo(t[i]/255)):uo(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let xee=0;class ku{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:xee++}),this.uuid=xr(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(EE(r[o].isDataTexture?r[o].image:r[o]))}else s=EE(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function EE(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?_ee.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let wee=0,nr=(()=>{class n extends co{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=ns,s=ns,o=ui,a=ao,l=tr,c=lo,u=n.DEFAULT_ANISOTROPY,d=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:wee++}),this.uuid=xr(),this.name="",this.source=new ku(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new ee(0,0),this.repeat=new ee(1,1),this.center=new ee(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new vt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case ns:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case ns:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){!0===t&&this.pmremVersion++}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n.DEFAULT_ANISOTROPY=1,n})();class zt{constructor(e=0,t=0,i=0,r=1){zt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],f=l[5],p=l[9],v=l[2],m=l[6],g=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-v)<.01&&Math.abs(p-m)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+v)<.1&&Math.abs(p+m)<.1&&Math.abs(c+f+g-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const _=(c+1)/2,x=(f+1)/2,T=(g+1)/2,E=(u+h)/4,C=(d+v)/4,R=(p+m)/4;return _>x&&_>T?_<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(_),r=E/i,s=C/i):x>T?x<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),i=E/r,s=R/r):T<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(T),i=C/s,r=R/s),this.set(i,r,s,t),this}let y=Math.sqrt((m-p)*(m-p)+(d-v)*(d-v)+(h-u)*(h-u));return Math.abs(y)<.001&&(y=1),this.x=(m-p)/y,this.y=(d-v)/y,this.z=(h-u)/y,this.w=Math.acos((c+f+g-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=ft(this.x,e.x,t.x),this.y=ft(this.y,e.y,t.y),this.z=ft(this.z,e.z,t.z),this.w=ft(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=ft(this.x,e,t),this.y=ft(this.y,e,t),this.z=ft(this.z,e,t),this.w=ft(this.w,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(ft(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class SE extends co{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new zt(0,0,e,t),this.scissorTest=!1,this.viewport=new zt(0,0,e,t);const r={width:e,height:t,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:ui,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);const s=new nr(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const o=i.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,r=e.textures.length;i<r;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0,this.textures[i].renderTarget=this;const t=Object.assign({},e.texture.image);return this.texture.source=new ku(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ho extends SE{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class Lv extends nr{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=bi,this.minFilter=bi,this.wrapR=ns,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class TE extends nr{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=bi,this.minFilter=bi,this.wrapR=ns,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class wr{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],d=i[r+3];const h=s[o+0],f=s[o+1],p=s[o+2],v=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=d);if(1===a)return e[t+0]=h,e[t+1]=f,e[t+2]=p,void(e[t+3]=v);if(d!==v||l!==h||c!==f||u!==p){let m=1-a;const g=l*h+c*f+u*p+d*v,y=g>=0?1:-1,_=1-g*g;if(_>Number.EPSILON){const T=Math.sqrt(_),E=Math.atan2(T,g*y);m=Math.sin(m*E)/T,a=Math.sin(a*E)/T}const x=a*y;if(l=l*m+h*x,c=c*m+f*x,u=u*m+p*x,d=d*m+v*x,m===1-a){const T=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=T,c*=T,u*=T,d*=T}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],d=s[o],h=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*d+l*f-c*h,e[t+1]=l*p+u*h+c*d-a*f,e[t+2]=c*p+u*f+a*h-l*d,e[t+3]=u*p-a*d-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),d=a(s/2),h=l(i/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"YXZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"ZXY":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"ZYX":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"YZX":this._x=h*u*d+c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d-h*f*p;break;case"XZY":this._x=h*u*d-c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d+h*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],d=t[10],h=i+a+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>d){const f=2*Math.sqrt(1+i-a-d);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>d){const f=2*Math.sqrt(1+a-i-d);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+d-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ft(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),d=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=o*d+this._w*h,this._x=i*d+this._x*h,this._y=r*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class A{constructor(e=0,t=0,i=0){A.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(iF.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(iF.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*r-a*i),u=2*(a*t-s*r),d=2*(s*i-o*t);return this.x=t+l*c+o*d-a*u,this.y=i+l*u+a*c-s*d,this.z=r+l*d+s*u-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=ft(this.x,e.x,t.x),this.y=ft(this.y,e.y,t.y),this.z=ft(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=ft(this.x,e,t),this.y=ft(this.y,e,t),this.z=ft(this.z,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(ft(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return CE.copy(this).projectOnVector(e),this.sub(CE)}reflect(e){return this.sub(CE.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(ft(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const CE=new A,iF=new wr;class ir{constructor(e=new A(1/0,1/0,1/0),t=new A(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(is.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(is.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=is.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i){const s=i.getAttribute("position");if(!0===t&&void 0!==s&&!0!==e.isInstancedMesh)for(let o=0,a=s.count;o<a;o++)!0===e.isMesh?e.getVertexPosition(o,is):is.fromBufferAttribute(s,o),is.applyMatrix4(e.matrixWorld),this.expandByPoint(is);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Ov.copy(e.boundingBox)):(null===i.boundingBox&&i.computeBoundingBox(),Ov.copy(i.boundingBox)),Ov.applyMatrix4(e.matrixWorld),this.union(Ov)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,is),is.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ef),Fv.subVectors(this.max,Ef),Uu.subVectors(e.a,Ef),Bu.subVectors(e.b,Ef),Vu.subVectors(e.c,Ef),ha.subVectors(Bu,Uu),fa.subVectors(Vu,Bu),Ml.subVectors(Uu,Vu);let t=[0,-ha.z,ha.y,0,-fa.z,fa.y,0,-Ml.z,Ml.y,ha.z,0,-ha.x,fa.z,0,-fa.x,Ml.z,0,-Ml.x,-ha.y,ha.x,0,-fa.y,fa.x,0,-Ml.y,Ml.x,0];return!(!DE(t,Uu,Bu,Vu,Fv)||(t=[1,0,0,0,1,0,0,0,1],!DE(t,Uu,Bu,Vu,Fv)))&&(kv.crossVectors(ha,fa),t=[kv.x,kv.y,kv.z],DE(t,Uu,Bu,Vu,Fv))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,is).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(is).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(fo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),fo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),fo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),fo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),fo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),fo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),fo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),fo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(fo)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const fo=[new A,new A,new A,new A,new A,new A,new A,new A],is=new A,Ov=new ir,Uu=new A,Bu=new A,Vu=new A,ha=new A,fa=new A,Ml=new A,Ef=new A,Fv=new A,kv=new A,El=new A;function DE(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){El.fromArray(n,s);const a=r.x*Math.abs(El.x)+r.y*Math.abs(El.y)+r.z*Math.abs(El.z),l=e.dot(El),c=t.dot(El),u=i.dot(El);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const bee=new ir,Sf=new A,AE=new A;class Ui{constructor(e=new A,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):bee.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Sf.subVectors(e,this.center);const t=Sf.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.addScaledVector(Sf,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(AE.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Sf.copy(e.center).add(AE)),this.expandByPoint(Sf.copy(e.center).sub(AE))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const po=new A,IE=new A,Uv=new A,pa=new A,RE=new A,Bv=new A,NE=new A;class Tf{constructor(e=new A,t=new A(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,po)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=po.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(po.copy(this.origin).addScaledVector(this.direction,t),po.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){IE.copy(e).add(t).multiplyScalar(.5),Uv.copy(t).sub(e).normalize(),pa.copy(this.origin).sub(IE);const s=.5*e.distanceTo(t),o=-this.direction.dot(Uv),a=pa.dot(this.direction),l=-pa.dot(Uv),c=pa.lengthSq(),u=Math.abs(1-o*o);let d,h,f,p;if(u>0)if(d=o*l-a,h=o*a-l,p=s*u,d>=0)if(h>=-p)if(h<=p){const v=1/u;d*=v,h*=v,f=d*(d+o*h+2*a)+h*(o*d+h+2*l)+c}else h=s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;else h<=-p?(d=Math.max(0,-(-o*s+a)),h=d>0?-s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c):h<=p?(d=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(d=Math.max(0,-(o*s+a)),h=d>0?s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c);else h=o>0?-s:s,d=Math.max(0,-(o*h+a)),f=-d*d+h*(h+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(IE).addScaledVector(Uv,h),f}intersectSphere(e,t){po.subVectors(e.center,this.origin);const i=po.dot(this.direction),r=po.dot(po)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(i=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(i=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),i>l||a>r)||((a>i||i!=i)&&(i=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,po)}intersectTriangle(e,t,i,r,s){RE.subVectors(t,e),Bv.subVectors(i,e),NE.crossVectors(RE,Bv);let a,o=this.direction.dot(NE);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}pa.subVectors(this.origin,e);const l=a*this.direction.dot(Bv.crossVectors(pa,Bv));if(l<0)return null;const c=a*this.direction.dot(RE.cross(pa));if(c<0||l+c>o)return null;const u=-a*pa.dot(NE);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class ot{constructor(e,t,i,r,s,o,a,l,c,u,d,h,f,p,v,m){ot.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,s,o,a,l,c,u,d,h,f,p,v,m)}set(e,t,i,r,s,o,a,l,c,u,d,h,f,p,v,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=s,g[5]=o,g[9]=a,g[13]=l,g[2]=c,g[6]=u,g[10]=d,g[14]=h,g[3]=f,g[7]=p,g[11]=v,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new ot).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/zu.setFromMatrixColumn(e,0).length(),s=1/zu.setFromMatrixColumn(e,1).length(),o=1/zu.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const h=o*u,f=o*d,p=a*u,v=a*d;t[0]=l*u,t[4]=-l*d,t[8]=c,t[1]=f+p*c,t[5]=h-v*c,t[9]=-a*l,t[2]=v-h*c,t[6]=p+f*c,t[10]=o*l}else if("YXZ"===e.order){const h=l*u,f=l*d,p=c*u,v=c*d;t[0]=h+v*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*d,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=v+h*a,t[10]=o*l}else if("ZXY"===e.order){const h=l*u,f=l*d,p=c*u,v=c*d;t[0]=h-v*a,t[4]=-o*d,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=v-h*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const h=o*u,f=o*d,p=a*u,v=a*d;t[0]=l*u,t[4]=p*c-f,t[8]=h*c+v,t[1]=l*d,t[5]=v*c+h,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const h=o*l,f=o*c,p=a*l,v=a*c;t[0]=l*u,t[4]=v-h*d,t[8]=p*d+f,t[1]=d,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*d+p,t[10]=h-v*d}else if("XZY"===e.order){const h=o*l,f=o*c,p=a*l,v=a*c;t[0]=l*u,t[4]=-d,t[8]=c*u,t[1]=h*d+v,t[5]=o*u,t[9]=f*d-p,t[2]=p*d-f,t[6]=a*u,t[10]=v*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Mee,e,Eee)}lookAt(e,t,i){const r=this.elements;return br.subVectors(e,t),0===br.lengthSq()&&(br.z=1),br.normalize(),ga.crossVectors(i,br),0===ga.lengthSq()&&(1===Math.abs(i.z)?br.x+=1e-4:br.z+=1e-4,br.normalize(),ga.crossVectors(i,br)),ga.normalize(),Vv.crossVectors(br,ga),r[0]=ga.x,r[4]=Vv.x,r[8]=br.x,r[1]=ga.y,r[5]=Vv.y,r[9]=br.y,r[2]=ga.z,r[6]=Vv.z,r[10]=br.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],d=i[5],h=i[9],f=i[13],p=i[2],v=i[6],m=i[10],g=i[14],y=i[3],_=i[7],x=i[11],T=i[15],E=r[0],C=r[4],R=r[8],M=r[12],w=r[1],N=r[5],G=r[9],B=r[13],j=r[2],K=r[6],$=r[10],fe=r[14],q=r[3],we=r[7],Re=r[11],Ve=r[15];return s[0]=o*E+a*w+l*j+c*q,s[4]=o*C+a*N+l*K+c*we,s[8]=o*R+a*G+l*$+c*Re,s[12]=o*M+a*B+l*fe+c*Ve,s[1]=u*E+d*w+h*j+f*q,s[5]=u*C+d*N+h*K+f*we,s[9]=u*R+d*G+h*$+f*Re,s[13]=u*M+d*B+h*fe+f*Ve,s[2]=p*E+v*w+m*j+g*q,s[6]=p*C+v*N+m*K+g*we,s[10]=p*R+v*G+m*$+g*Re,s[14]=p*M+v*B+m*fe+g*Ve,s[3]=y*E+_*w+x*j+T*q,s[7]=y*C+_*N+x*K+T*we,s[11]=y*R+_*G+x*$+T*Re,s[15]=y*M+_*B+x*fe+T*Ve,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],f=e[14];return e[3]*(+s*l*d-r*c*d-s*a*h+i*c*h+r*a*f-i*l*f)+e[7]*(+t*l*f-t*c*h+s*o*h-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*d-t*a*f-s*o*d+i*o*f+s*a*u-i*c*u)+e[15]*(-r*a*u-t*l*d+t*a*h+r*o*d-i*o*h+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],v=e[13],m=e[14],g=e[15],y=d*m*c-v*h*c+v*l*f-a*m*f-d*l*g+a*h*g,_=p*h*c-u*m*c-p*l*f+o*m*f+u*l*g-o*h*g,x=u*v*c-p*d*c+p*a*f-o*v*f-u*a*g+o*d*g,T=p*d*l-u*v*l-p*a*h+o*v*h+u*a*m-o*d*m,E=t*y+i*_+r*x+s*T;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/E;return e[0]=y*C,e[1]=(v*h*s-d*m*s-v*r*f+i*m*f+d*r*g-i*h*g)*C,e[2]=(a*m*s-v*l*s+v*r*c-i*m*c-a*r*g+i*l*g)*C,e[3]=(d*l*s-a*h*s-d*r*c+i*h*c+a*r*f-i*l*f)*C,e[4]=_*C,e[5]=(u*m*s-p*h*s+p*r*f-t*m*f-u*r*g+t*h*g)*C,e[6]=(p*l*s-o*m*s-p*r*c+t*m*c+o*r*g-t*l*g)*C,e[7]=(o*h*s-u*l*s+u*r*c-t*h*c-o*r*f+t*l*f)*C,e[8]=x*C,e[9]=(p*d*s-u*v*s-p*i*f+t*v*f+u*i*g-t*d*g)*C,e[10]=(o*v*s-p*a*s+p*i*c-t*v*c-o*i*g+t*a*g)*C,e[11]=(u*a*s-o*d*s-u*i*c+t*d*c+o*i*f-t*a*f)*C,e[12]=T*C,e[13]=(u*v*r-p*d*r+p*i*h-t*v*h-u*i*m+t*d*m)*C,e[14]=(p*a*r-o*v*r-p*i*l+t*v*l+o*i*m-t*a*m)*C,e[15]=(o*d*r-u*a*r+u*i*l-t*d*l-o*i*h+t*a*h)*C,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,d=a+a,h=s*c,f=s*u,p=s*d,v=o*u,m=o*d,g=a*d,y=l*c,_=l*u,x=l*d,T=i.x,E=i.y,C=i.z;return r[0]=(1-(v+g))*T,r[1]=(f+x)*T,r[2]=(p-_)*T,r[3]=0,r[4]=(f-x)*E,r[5]=(1-(h+g))*E,r[6]=(m+y)*E,r[7]=0,r[8]=(p+_)*C,r[9]=(m-y)*C,r[10]=(1-(h+v))*C,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=zu.set(r[0],r[1],r[2]).length();const o=zu.set(r[4],r[5],r[6]).length(),a=zu.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],rs.copy(this);const c=1/s,u=1/o,d=1/a;return rs.elements[0]*=c,rs.elements[1]*=c,rs.elements[2]*=c,rs.elements[4]*=u,rs.elements[5]*=u,rs.elements[6]*=u,rs.elements[8]*=d,rs.elements[9]*=d,rs.elements[10]*=d,t.setFromRotationMatrix(rs),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Is){const l=this.elements,c=2*s/(t-e),u=2*s/(i-r),d=(t+e)/(t-e),h=(i+r)/(i-r);let f,p;if(a===Is)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else{if(2001!==a)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);f=-o/(o-s),p=-o*s/(o-s)}return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=u,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Is){const l=this.elements,c=1/(t-e),u=1/(i-r),d=1/(o-s),h=(t+e)*c,f=(i+r)*u;let p,v;if(a===Is)p=(o+s)*d,v=-2*d;else{if(2001!==a)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=s*d,v=-1*d}return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-f,l[2]=0,l[6]=0,l[10]=v,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const zu=new A,rs=new ot,Mee=new A(0,0,0),Eee=new A(1,1,1),ga=new A,Vv=new A,br=new A,rF=new ot,sF=new wr;let go=(()=>{class n{constructor(t=0,i=0,r=0,s=n.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,s=this._order){return this._x=t,this._y=i,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],d=s[9],h=s[2],f=s[6],p=s[10];switch(i){case"XYZ":this._y=Math.asin(ft(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-ft(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,o),this._z=0);break;case"ZXY":this._x=Math.asin(ft(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-ft(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(ft(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-ft(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-d,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return rF.makeRotationFromQuaternion(t),this.setFromRotationMatrix(rF,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return sF.setFromEuler(this),this.setFromQuaternion(sF,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})();class PE{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return!!(this.mask&e.mask)}isEnabled(e){return!!(this.mask&1<<e)}}let See=0;const oF=new A,Hu=new wr,mo=new ot,zv=new A,Cf=new A,Tee=new A,Cee=new wr,aF=new A(1,0,0),lF=new A(0,1,0),cF=new A(0,0,1),uF={type:"added"},Dee={type:"removed"},Gu={type:"childadded",child:null},LE={type:"childremoved",child:null};let fn=(()=>{class n extends co{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:See++}),this.uuid=xr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();const t=new A,i=new go,r=new wr,s=new A(1,1,1);i._onChange(function o(){r.setFromEuler(i,!1)}),r._onChange(function a(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new ot},normalMatrix:{value:new vt}}),this.matrix=new ot,this.matrixWorld=new ot,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new PE,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Hu.setFromAxisAngle(t,i),this.quaternion.multiply(Hu),this}rotateOnWorldAxis(t,i){return Hu.setFromAxisAngle(t,i),this.quaternion.premultiply(Hu),this}rotateX(t){return this.rotateOnAxis(aF,t)}rotateY(t){return this.rotateOnAxis(lF,t)}rotateZ(t){return this.rotateOnAxis(cF,t)}translateOnAxis(t,i){return oF.copy(t).applyQuaternion(this.quaternion),this.position.add(oF.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(aF,t)}translateY(t){return this.translateOnAxis(lF,t)}translateZ(t){return this.translateOnAxis(cF,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(mo.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?zv.copy(t):zv.set(t,i,r);const s=this.parent;this.updateWorldMatrix(!0,!1),Cf.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?mo.lookAt(Cf,zv,this.up):mo.lookAt(zv,Cf,this.up),this.quaternion.setFromRotationMatrix(mo),s&&(mo.extractRotation(s.matrixWorld),Hu.setFromRotationMatrix(mo),this.quaternion.premultiply(Hu.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(uF),Gu.child=t,this.dispatchEvent(Gu),Gu.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(Dee),LE.child=t,this.dispatchEvent(LE),LE.child=null),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),mo.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),mo.multiply(t.parent.matrixWorld)),t.applyMatrix4(mo),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(uF),Gu.child=t,this.dispatchEvent(Gu),Gu.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectByProperty(t,i);if(void 0!==a)return a}}getObjectsByProperty(t,i,r=[]){this[t]===i&&r.push(this);const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(t,i,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Cf,t,Tee),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Cf,Cee,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].updateMatrixWorld(t)}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===i){const s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};function o(l,c){return void 0===l[c.uuid]&&(l[c.uuid]=c.toJSON(t)),c.uuid}if(s.uuid=this.uuid,s.type=this.type,""!==this.name&&(s.name=this.name),!0===this.castShadow&&(s.castShadow=!0),!0===this.receiveShadow&&(s.receiveShadow=!0),!1===this.visible&&(s.visible=!1),!1===this.frustumCulled&&(s.frustumCulled=!1),0!==this.renderOrder&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(t),null!==this._colorsTexture&&(s.colorsTexture=this._colorsTexture.toJSON(t)),null!==this.boundingSphere&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),null!==this.boundingBox&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);const l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){const c=l.shapes;if(Array.isArray(c))for(let u=0,d=c.length;u<d;u++)o(t.shapes,c[u]);else o(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const l=[];for(let c=0,u=this.material.length;c<u;c++)l.push(o(t.materials,this.material[c]));s.material=l}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let l=0;l<this.children.length;l++)s.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let l=0;l<this.animations.length;l++)s.animations.push(o(t.animations,this.animations[l]))}if(i){const l=a(t.geometries),c=a(t.materials),u=a(t.textures),d=a(t.images),h=a(t.shapes),f=a(t.skeletons),p=a(t.animations),v=a(t.nodes);l.length>0&&(r.geometries=l),c.length>0&&(r.materials=c),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),p.length>0&&(r.animations=p),v.length>0&&(r.nodes=v)}return r.object=s,r;function a(l){const c=[];for(const u in l){const d=l[u];delete d.metadata,c.push(d)}return c}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DEFAULT_UP=new A(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})();const ss=new A,vo=new A,OE=new A,yo=new A,ju=new A,$u=new A,dF=new A,FE=new A,kE=new A,UE=new A,BE=new zt,VE=new zt,zE=new zt;class Mr{constructor(e=new A,t=new A,i=new A){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),ss.subVectors(e,t),r.cross(ss);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){ss.subVectors(r,t),vo.subVectors(i,t),OE.subVectors(e,t);const o=ss.dot(ss),a=ss.dot(vo),l=ss.dot(OE),c=vo.dot(vo),u=vo.dot(OE),d=o*c-a*a;if(0===d)return s.set(0,0,0),null;const h=1/d,f=(c*l-a*u)*h,p=(o*u-a*l)*h;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return null!==this.getBarycoord(e,t,i,r,yo)&&yo.x>=0&&yo.y>=0&&yo.x+yo.y<=1}static getInterpolation(e,t,i,r,s,o,a,l){return null===this.getBarycoord(e,t,i,r,yo)?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,yo.x),l.addScaledVector(o,yo.y),l.addScaledVector(a,yo.z),l)}static getInterpolatedAttribute(e,t,i,r,s,o){return BE.setScalar(0),VE.setScalar(0),zE.setScalar(0),BE.fromBufferAttribute(e,t),VE.fromBufferAttribute(e,i),zE.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(BE,s.x),o.addScaledVector(VE,s.y),o.addScaledVector(zE,s.z),o}static isFrontFacing(e,t,i,r){return ss.subVectors(i,t),vo.subVectors(e,t),ss.cross(vo).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ss.subVectors(this.c,this.b),vo.subVectors(this.a,this.b),.5*ss.cross(vo).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Mr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Mr.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,s){return Mr.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Mr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Mr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;ju.subVectors(r,i),$u.subVectors(s,i),FE.subVectors(e,i);const l=ju.dot(FE),c=$u.dot(FE);if(l<=0&&c<=0)return t.copy(i);kE.subVectors(e,r);const u=ju.dot(kE),d=$u.dot(kE);if(u>=0&&d<=u)return t.copy(r);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(ju,o);UE.subVectors(e,s);const f=ju.dot(UE),p=$u.dot(UE);if(p>=0&&f<=p)return t.copy(s);const v=f*c-l*p;if(v<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(i).addScaledVector($u,a);const m=u*p-f*d;if(m<=0&&d-u>=0&&f-p>=0)return dF.subVectors(s,r),a=(d-u)/(d-u+(f-p)),t.copy(r).addScaledVector(dF,a);const g=1/(m+v+h);return o=v*g,a=h*g,t.copy(i).addScaledVector(ju,o).addScaledVector($u,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const hF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ma={h:0,s:0,l:0},Hv={h:0,s:0,l:0};function HE(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}class Ie{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(void 0===t&&void 0===i){const r=e;r&&r.isColor?this.copy(r):"number"==typeof r?this.setHex(r):"string"==typeof r&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=_r){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Ft.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Ft.workingColorSpace){return this.r=e,this.g=t,this.b=i,Ft.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Ft.workingColorSpace){if(e=function bE(n,e){return(n%e+e)%e}(e,1),t=ft(t,0,1),i=ft(i,0,1),0===t)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=HE(o,s,e+1/3),this.g=HE(o,s,e),this.b=HE(o,s,e-1/3)}return Ft.toWorkingColorSpace(this,r),this}setStyle(e,t=_r){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(3===o)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=_r){const i=hF[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=uo(e.r),this.g=uo(e.g),this.b=uo(e.b),this}copyLinearToSRGB(e){return this.r=Ou(e.r),this.g=Ou(e.g),this.b=Ou(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=_r){return Ft.fromWorkingColorSpace(Ei.copy(this),e),65536*Math.round(ft(255*Ei.r,0,255))+256*Math.round(ft(255*Ei.g,0,255))+Math.round(ft(255*Ei.b,0,255))}getHexString(e=_r){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ft.workingColorSpace){Ft.fromWorkingColorSpace(Ei.copy(this),t);const i=Ei.r,r=Ei.g,s=Ei.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const d=o-a;switch(c=u<=.5?d/(o+a):d/(2-o-a),o){case i:l=(r-s)/d+(r<s?6:0);break;case r:l=(s-i)/d+2;break;case s:l=(i-r)/d+4}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=Ft.workingColorSpace){return Ft.fromWorkingColorSpace(Ei.copy(this),t),e.r=Ei.r,e.g=Ei.g,e.b=Ei.b,e}getStyle(e=_r){Ft.fromWorkingColorSpace(Ei.copy(this),e);const t=Ei.r,i=Ei.g,r=Ei.b;return e!==_r?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(ma),this.setHSL(ma.h+e,ma.s+t,ma.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(ma),e.getHSL(Hv);const i=bf(ma.h,Hv.h,t),r=bf(ma.s,Hv.s,t),s=bf(ma.l,Hv.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Ei=new Ie;Ie.NAMES=hF;let Aee=0;class Bi extends co{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Aee++}),this.uuid=xr(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ie(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ru,this.stencilZFail=Ru,this.stencilZPass=Ru,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(i.dispersion=this.dispersion),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapRotation&&(i.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),!0===this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=!0),204!==this.blendSrc&&(i.blendSrc=this.blendSrc),205!==this.blendDst&&(i.blendDst=this.blendDst),100!==this.blendEquation&&(i.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(i.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(i.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(i.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(i.depthFunc=this.depthFunc),!1===this.depthTest&&(i.depthTest=this.depthTest),!1===this.depthWrite&&(i.depthWrite=this.depthWrite),!1===this.colorWrite&&(i.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(i.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(i.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(i.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Ru&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Ru&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Ru&&(i.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(i.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=!0),!0===this.alphaToCoverage&&(i.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=!0),!0===this.forceSinglePass&&(i.forceSinglePass=!0),!0===this.wireframe&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Sl extends Bi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ie(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new go,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const zn=new A,Gv=new ee;class ln{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=35044,this.updateRanges=[],this.gpuType=yr,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)Gv.fromBufferAttribute(this,t),Gv.applyMatrix3(e),this.setXY(t,Gv.x,Gv.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)zn.fromBufferAttribute(this,t),zn.applyMatrix3(e),this.setXYZ(t,zn.x,zn.y,zn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)zn.fromBufferAttribute(this,t),zn.applyMatrix4(e),this.setXYZ(t,zn.x,zn.y,zn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)zn.fromBufferAttribute(this,t),zn.applyNormalMatrix(e),this.setXYZ(t,zn.x,zn.y,zn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)zn.fromBufferAttribute(this,t),zn.transformDirection(e),this.setXYZ(t,zn.x,zn.y,zn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=ki(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=mt(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ki(t,this.array)),t}setX(e,t){return this.normalized&&(t=mt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ki(t,this.array)),t}setY(e,t){return this.normalized&&(t=mt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ki(t,this.array)),t}setZ(e,t){return this.normalized&&(t=mt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ki(t,this.array)),t}setW(e,t){return this.normalized&&(t=mt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=mt(t,this.array),i=mt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=mt(t,this.array),i=mt(i,this.array),r=mt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=mt(t,this.array),i=mt(i,this.array),r=mt(r,this.array),s=mt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}}class fF extends ln{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class pF extends ln{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class ze extends ln{constructor(e,t,i){super(new Float32Array(e),t,i)}}let Ree=0;const Vr=new ot,GE=new fn,Wu=new A,Er=new ir,Af=new ir,di=new A;class bt extends co{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Ree++}),this.uuid=xr(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(QO(e)?pF:fF)(e,1):e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new vt).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Vr.makeRotationFromQuaternion(e),this.applyMatrix4(Vr),this}rotateX(e){return Vr.makeRotationX(e),this.applyMatrix4(Vr),this}rotateY(e){return Vr.makeRotationY(e),this.applyMatrix4(Vr),this}rotateZ(e){return Vr.makeRotationZ(e),this.applyMatrix4(Vr),this}translate(e,t,i){return Vr.makeTranslation(e,t,i),this.applyMatrix4(Vr),this}scale(e,t,i){return Vr.makeScale(e,t,i),this.applyMatrix4(Vr),this}lookAt(e){return GE.lookAt(e),GE.updateMatrix(),this.applyMatrix4(GE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Wu).negate(),this.translate(Wu.x,Wu.y,Wu.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const i=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new ze(i,3))}else{const i=Math.min(e.length,t.count);for(let r=0;r<i;r++){const s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new ir);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new A(-1/0,-1/0,-1/0),new A(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)Er.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(di.addVectors(this.boundingBox.min,Er.min),this.boundingBox.expandByPoint(di),di.addVectors(this.boundingBox.max,Er.max),this.boundingBox.expandByPoint(di)):(this.boundingBox.expandByPoint(Er.min),this.boundingBox.expandByPoint(Er.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Ui);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new A,1/0);if(e){const i=this.boundingSphere.center;if(Er.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Af.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(di.addVectors(Er.min,Af.min),Er.expandByPoint(di),di.addVectors(Er.max,Af.max),Er.expandByPoint(di)):(Er.expandByPoint(Af.min),Er.expandByPoint(Af.max));Er.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)di.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(di));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)di.fromBufferAttribute(a,c),l&&(Wu.fromBufferAttribute(e,c),di.add(Wu)),r=Math.max(r,i.distanceToSquared(di))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=t.position,r=t.normal,s=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new ln(new Float32Array(4*i.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let R=0;R<i.count;R++)a[R]=new A,l[R]=new A;const c=new A,u=new A,d=new A,h=new ee,f=new ee,p=new ee,v=new A,m=new A;function g(R,M,w){c.fromBufferAttribute(i,R),u.fromBufferAttribute(i,M),d.fromBufferAttribute(i,w),h.fromBufferAttribute(s,R),f.fromBufferAttribute(s,M),p.fromBufferAttribute(s,w),u.sub(c),d.sub(c),f.sub(h),p.sub(h);const N=1/(f.x*p.y-p.x*f.y);isFinite(N)&&(v.copy(u).multiplyScalar(p.y).addScaledVector(d,-f.y).multiplyScalar(N),m.copy(d).multiplyScalar(f.x).addScaledVector(u,-p.x).multiplyScalar(N),a[R].add(v),a[M].add(v),a[w].add(v),l[R].add(m),l[M].add(m),l[w].add(m))}let y=this.groups;0===y.length&&(y=[{start:0,count:e.count}]);for(let R=0,M=y.length;R<M;++R){const w=y[R],N=w.start;for(let B=N,j=N+w.count;B<j;B+=3)g(e.getX(B+0),e.getX(B+1),e.getX(B+2))}const _=new A,x=new A,T=new A,E=new A;function C(R){T.fromBufferAttribute(r,R),E.copy(T);const M=a[R];_.copy(M),_.sub(T.multiplyScalar(T.dot(M))).normalize(),x.crossVectors(E,M);const N=x.dot(l[R])<0?-1:1;o.setXYZW(R,_.x,_.y,_.z,N)}for(let R=0,M=y.length;R<M;++R){const w=y[R],N=w.start;for(let B=N,j=N+w.count;B<j;B+=3)C(e.getX(B+0)),C(e.getX(B+1)),C(e.getX(B+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new ln(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let h=0,f=i.count;h<f;h++)i.setXYZ(h,0,0,0);const r=new A,s=new A,o=new A,a=new A,l=new A,c=new A,u=new A,d=new A;if(e)for(let h=0,f=e.count;h<f;h+=3){const p=e.getX(h+0),v=e.getX(h+1),m=e.getX(h+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,v),o.fromBufferAttribute(t,m),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,v),c.fromBufferAttribute(i,m),a.add(u),l.add(u),c.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(v,l.x,l.y,l.z),i.setXYZ(m,c.x,c.y,c.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),s.fromBufferAttribute(t,h+1),o.fromBufferAttribute(t,h+2),u.subVectors(o,s),d.subVectors(r,s),u.cross(d),i.setXYZ(h+0,u.x,u.y,u.z),i.setXYZ(h+1,u.x,u.y,u.z),i.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)di.fromBufferAttribute(e,t),di.normalize(),e.setXYZ(t,di.x,di.y,di.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,d=a.normalized,h=new c.constructor(l.length*u);let f=0,p=0;for(let v=0,m=l.length;v<m;v++){f=a.isInterleavedBufferAttribute?l[v]*a.data.stride+a.offset:l[v]*u;for(let g=0;g<u;g++)h[p++]=c[f++]}return new ln(h,u,d)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new bt,i=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,d=c.length;u<d;u++){const f=e(c[u],i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i)e.data.attributes[l]=i[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++)u.push(c[d].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const d=o[c];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const gF=new ot,Tl=new Tf,jv=new Ui,mF=new A,$v=new A,Wv=new A,qv=new A,jE=new A,Xv=new A,vF=new A,Yv=new A;class Qn extends fn{constructor(e=new bt,t=new Sl){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(i.attributes.position,e);const a=this.morphTargetInfluences;if(s&&a){Xv.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l];0!==u&&(jE.fromBufferAttribute(s[l],e),Xv.addScaledVector(o?jE:jE.sub(t),u))}t.add(Xv)}return t}raycast(e,t){const i=this.geometry,s=this.matrixWorld;void 0!==this.material&&(null===i.boundingSphere&&i.computeBoundingSphere(),jv.copy(i.boundingSphere),jv.applyMatrix4(s),Tl.copy(e.ray).recast(e.near),(!1!==jv.containsPoint(Tl.origin)||!(null===Tl.intersectSphere(jv,mF)||Tl.origin.distanceToSquared(mF)>(e.far-e.near)**2))&&(gF.copy(s).invert(),Tl.copy(e.ray).applyMatrix4(gF),(null===i.boundingBox||!1!==Tl.intersectsBox(i.boundingBox))&&this._computeIntersections(e,t,Tl)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,h=s.groups,f=s.drawRange;if(null!==a)if(Array.isArray(o))for(let p=0,v=h.length;p<v;p++){const m=h[p],g=o[m.materialIndex];for(let x=Math.max(m.start,f.start),T=Math.min(a.count,Math.min(m.start+m.count,f.start+f.count));x<T;x+=3)r=Zv(this,g,e,i,c,u,d,a.getX(x),a.getX(x+1),a.getX(x+2)),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=m.materialIndex,t.push(r))}else for(let m=Math.max(0,f.start),g=Math.min(a.count,f.start+f.count);m<g;m+=3)r=Zv(this,o,e,i,c,u,d,a.getX(m),a.getX(m+1),a.getX(m+2)),r&&(r.faceIndex=Math.floor(m/3),t.push(r));else if(void 0!==l)if(Array.isArray(o))for(let p=0,v=h.length;p<v;p++){const m=h[p],g=o[m.materialIndex];for(let x=Math.max(m.start,f.start),T=Math.min(l.count,Math.min(m.start+m.count,f.start+f.count));x<T;x+=3)r=Zv(this,g,e,i,c,u,d,x,x+1,x+2),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=m.materialIndex,t.push(r))}else for(let m=Math.max(0,f.start),g=Math.min(l.count,f.start+f.count);m<g;m+=3)r=Zv(this,o,e,i,c,u,d,m,m+1,m+2),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}function Zv(n,e,t,i,r,s,o,a,l,c){n.getVertexPosition(a,$v),n.getVertexPosition(l,Wv),n.getVertexPosition(c,qv);const u=function Nee(n,e,t,i,r,s,o,a){let l;if(l=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,0===e.side,a),null===l)return null;Yv.copy(a),Yv.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(Yv);return c<t.near||c>t.far?null:{distance:c,point:Yv.clone(),object:n}}(n,e,t,i,$v,Wv,qv,vF);if(u){const d=new A;Mr.getBarycoord(vF,$v,Wv,qv,d),r&&(u.uv=Mr.getInterpolatedAttribute(r,a,l,c,d,new ee)),s&&(u.uv1=Mr.getInterpolatedAttribute(s,a,l,c,d,new ee)),o&&(u.normal=Mr.getInterpolatedAttribute(o,a,l,c,d,new A),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const h={a,b:l,c,normal:new A,materialIndex:0};Mr.getNormal($v,Wv,qv,h.normal),u.face=h,u.barycoord=d}return u}class qu extends bt{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],d=[];let h=0,f=0;function p(v,m,g,y,_,x,T,E,C,R,M){const w=x/C,N=T/R,G=x/2,B=T/2,j=E/2,K=C+1,$=R+1;let fe=0,q=0;const we=new A;for(let Re=0;Re<$;Re++){const Ve=Re*N-B;for(let yt=0;yt<K;yt++)we[v]=(yt*w-G)*y,we[m]=Ve*_,we[g]=j,c.push(we.x,we.y,we.z),we[v]=0,we[m]=0,we[g]=E>0?1:-1,u.push(we.x,we.y,we.z),d.push(yt/C),d.push(1-Re/R),fe+=1}for(let Re=0;Re<R;Re++)for(let Ve=0;Ve<C;Ve++){const Wt=h+Ve+K*(Re+1),J=h+(Ve+1)+K*(Re+1),ge=h+(Ve+1)+K*Re;l.push(h+Ve+K*Re,Wt,ge),l.push(Wt,J,ge),q+=6}a.addGroup(f,q,M),f+=q,h+=fe}p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new ze(c,3)),this.setAttribute("normal",new ze(u,3)),this.setAttribute("uv",new ze(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new qu(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Xu(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():e[t][i]=Array.isArray(r)?r.slice():r}}return e}function Vi(n){const e={};for(let t=0;t<n.length;t++){const i=Xu(n[t]);for(const r in i)e[r]=i[r]}return e}function yF(n){const e=n.getRenderTarget();return null===e?n.outputColorSpace:!0===e.isXRRenderTarget?e.texture.colorSpace:Ft.workingColorSpace}const Lee={clone:Xu,merge:Vi};class Rs extends Bi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Xu(e.uniforms),this.uniformsGroups=function Pee(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class $E extends fn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ot,this.projectionMatrix=new ot,this.projectionMatrixInverse=new ot,this.coordinateSystem=Is}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const va=new A,_F=new ee,xF=new ee;class pi extends $E{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Nu*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*bl*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Nu*Math.atan(Math.tan(.5*bl*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){va.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(va.x,va.y).multiplyScalar(-e/va.z),va.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(va.x,va.y).multiplyScalar(-e/va.z)}getViewSize(e,t){return this.getViewBounds(e,_F,xF),t.subVectors(xF,_F)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*bl*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class kee extends fn{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new pi(-90,1,e,t);r.layers=this.layers,this.add(r);const s=new pi(-90,1,e,t);s.layers=this.layers,this.add(s);const o=new pi(-90,1,e,t);o.layers=this.layers,this.add(o);const a=new pi(-90,1,e,t);a.layers=this.layers,this.add(a);const l=new pi(-90,1,e,t);l.layers=this.layers,this.add(l);const c=new pi(-90,1,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===Is)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else{if(2001!==e)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1)}for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,u]=this.children,d=e.getRenderTarget(),h=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const v=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,c),i.texture.generateMipmaps=v,e.setRenderTarget(i,5,r),e.render(t,u),e.setRenderTarget(d,h,f),e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class Jv extends nr{constructor(e,t,i,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:301,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Uee extends ho{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new Jv([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:ui}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new qu(5,5,5),s=new Rs({name:"CubemapFromEquirect",uniforms:Xu(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new Qn(r,s),a=t.minFilter;return t.minFilter===ao&&(t.minFilter=ui),new kee(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}class wF extends fn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new go,this.environmentIntensity=1,this.environmentRotation=new go,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}const QE=new A,Wee=new A,qee=new vt;class Cl{constructor(e=new A(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=QE.subVectors(i,t).cross(Wee.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(QE),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||qee.getNormalMatrix(e),r=this.coplanarPoint(QE).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Dl=new Ui,ry=new A;class sy{constructor(e=new Cl,t=new Cl,i=new Cl,r=new Cl,s=new Cl,o=new Cl){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Is){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],u=r[5],d=r[6],h=r[7],f=r[8],p=r[9],v=r[10],m=r[11],g=r[12],y=r[13],_=r[14],x=r[15];if(i[0].setComponents(l-s,h-c,m-f,x-g).normalize(),i[1].setComponents(l+s,h+c,m+f,x+g).normalize(),i[2].setComponents(l+o,h+u,m+p,x+y).normalize(),i[3].setComponents(l-o,h-u,m-p,x-y).normalize(),i[4].setComponents(l-a,h-d,m-v,x-_).normalize(),t===Is)i[5].setComponents(l+a,h+d,m+v,x+_).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);i[5].setComponents(a,d,v,_).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Dl.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Dl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Dl)}intersectsSprite(e){return Dl.center.set(0,0,0),Dl.radius=.7071067811865476,Dl.applyMatrix4(e.matrixWorld),this.intersectsSphere(Dl)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(ry.x=r.normal.x>0?e.max.x:e.min.x,ry.y=r.normal.y>0?e.max.y:e.min.y,ry.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(ry)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class rS extends Bi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ie(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const zF=new ot,sS=new Tf,hy=new Ui,fy=new A;class HF extends fn{constructor(e=new bt,t=new rS){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),hy.copy(i.boundingSphere),hy.applyMatrix4(r),hy.radius+=s,!1===e.ray.intersectsSphere(hy))return;zF.copy(r).invert(),sS.copy(e.ray).applyMatrix4(zF);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,d=i.attributes.position;if(null!==c)for(let p=Math.max(0,o.start),v=Math.min(c.count,o.start+o.count);p<v;p++){const m=c.getX(p);fy.fromBufferAttribute(d,m),GF(fy,m,l,r,e,t,this)}else for(let p=Math.max(0,o.start),v=Math.min(d.count,o.start+o.count);p<v;p++)fy.fromBufferAttribute(d,p),GF(fy,p,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function GF(n,e,t,i,r,s,o){const a=sS.distanceSqToPoint(n);if(a<t){const l=new A;sS.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class Uf extends fn{constructor(){super(),this.isGroup=!0,this.type="Group"}}class jF extends nr{constructor(e,t,i,r,s,o,a,l,c,u=Tu){if(u!==Tu&&u!==Cu)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===Tu&&(i=ua),void 0===i&&u===Cu&&(i=Su),super(null,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:bi,this.minFilter=void 0!==l?l:bi,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class $f extends bt{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,d=e/a,h=t/l,f=[],p=[],v=[],m=[];for(let g=0;g<u;g++){const y=g*h-o;for(let _=0;_<c;_++)p.push(_*d-s,-y,0),v.push(0,0,1),m.push(_/a),m.push(1-g/l)}for(let g=0;g<l;g++)for(let y=0;y<a;y++){const x=y+c*(g+1),T=y+1+c*(g+1),E=y+1+c*g;f.push(y+c*g,x,E),f.push(x,T,E)}this.setIndex(f),this.setAttribute("position",new ze(p,3)),this.setAttribute("normal",new ze(v,3)),this.setAttribute("uv",new ze(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $f(e.width,e.height,e.widthSegments,e.heightSegments)}}class ok extends Bi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class ak extends Bi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function Ll(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)}class Ty{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0}}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class qte extends Ty{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-i;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:o=e,l=2*i-t;break;case 2402:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(i-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(i-t)/(r-t),v=p*p,m=v*p,g=-h*m+2*h*v-h*p,y=(1+h)*m+(-1.5-2*h)*v+(-.5+h)*p+1,_=(-1-f)*m+(1.5+f)*v+.5*p,x=f*m-f*v;for(let T=0;T!==a;++T)s[T]=g*o[u+T]+y*o[c+T]+_*o[l+T]+x*o[d+T];return s}}class uk extends Ty{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)s[h]=o[c+h]*d+o[l+h]*u;return s}}class Xte extends Ty{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ps{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ll(t,this.TimeBufferType),this.values=Ll(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Ll(e.times,Array),values:Ll(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Xte(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new uk(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new qte(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&function lk(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const d=a*i,h=d-i,f=d+i;for(let p=0;p!==i;++p){const v=t[d+p];if(v!==t[h+p]||v!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const d=a*i,h=o*i;for(let f=0;f!==i;++f)t[h+f]=t[d+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Ps.prototype.TimeBufferType=Float32Array,Ps.prototype.ValueBufferType=Float32Array,Ps.prototype.DefaultInterpolation=2301;class sd extends Ps{constructor(e,t,i){super(e,t,i)}}sd.prototype.ValueTypeName="bool",sd.prototype.ValueBufferType=Array,sd.prototype.DefaultInterpolation=2300,sd.prototype.InterpolantFactoryMethodLinear=void 0,sd.prototype.InterpolantFactoryMethodSmooth=void 0;(class dk extends Ps{}).prototype.ValueTypeName="color";(class Cy extends Ps{}).prototype.ValueTypeName="number";class Yte extends Ty{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)wr.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Dy extends Ps{InterpolantFactoryMethodLinear(e){return new Yte(this.times,this.values,this.getValueSize(),e)}}Dy.prototype.ValueTypeName="quaternion",Dy.prototype.InterpolantFactoryMethodSmooth=void 0;class od extends Ps{constructor(e,t,i){super(e,t,i)}}od.prototype.ValueTypeName="string",od.prototype.ValueBufferType=Array,od.prototype.DefaultInterpolation=2300,od.prototype.InterpolantFactoryMethodLinear=void 0,od.prototype.InterpolantFactoryMethodSmooth=void 0;(class Ay extends Ps{}).prototype.ValueTypeName="vector",Error;class NS extends $E{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class pne extends pi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}const LS="\\[\\]\\.:\\/",xne=new RegExp("["+LS+"]","g"),OS="[^"+LS+"]",wne="[^"+LS.replace("\\.","")+"]",Tne=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",OS)+/(WCOD+)?/.source.replace("WCOD",wne)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",OS)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",OS)+"$"),Cne=["material","materials","bones","map"];class Dne{constructor(e,t,i){const r=i||pn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let pn=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(xne,"")}static parseTrackName(t){const i=Tne.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==Cne.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===i||l.uuid===i)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[i++]=r[s]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let o=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(r){let u=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,!0===t.isMaterial?l=this.Versioning.NeedsUpdate:!0===t.isObject3D&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=Dne,n})();function BS(n,e,t,i){const r=function Fne(n){switch(n){case lo:case 1010:return{byteLength:1,components:1};case xf:case 1011:case wf:return{byteLength:2,components:1};case 1017:case 1018:return{byteLength:2,components:4};case ua:case 1013:case yr:return{byteLength:4,components:1};case 35902:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}(i);switch(t){case 1021:case 1024:return n*e;case 1025:return n*e*2;case 1028:case 1029:return n*e/r.components*r.byteLength;case 1030:case 1031:return n*e*2/r.components*r.byteLength;case 1022:return n*e*3/r.components*r.byteLength;case tr:case 1033:return n*e*4/r.components*r.byteLength;case Ev:case Sv:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case Tv:case Cv:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case 35841:case 35843:return Math.max(n,16)*Math.max(e,8)/4;case 35840:case 35842:return Math.max(n,8)*Math.max(e,8)/2;case 36196:case 37492:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case 37496:case 37808:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case 37809:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case 37810:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case 37811:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case 37812:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case 37813:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case 37814:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case 37815:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case 37816:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case 37817:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case 37818:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case 37819:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case 37820:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case 37821:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case Dv:case 36494:case 36495:return Math.ceil(n/4)*Math.ceil(e/4)*16;case 36283:case 36284:return Math.ceil(n/4)*Math.ceil(e/4)*8;case 36285:case 36286:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Uk(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function kne(n){const e=new WeakMap;return{get:function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)},remove:function s(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(n.deleteBuffer(l.buffer),e.delete(a))},update:function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const u=e.get(a);return void((!u||u.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version}))}const c=e.get(a);if(void 0===c)e.set(a,function t(a,l){const c=a.array,u=a.usage,d=c.byteLength,h=n.createBuffer();let f;if(n.bindBuffer(l,h),n.bufferData(l,c,u),a.onUploadCallback(),c instanceof Float32Array)f=n.FLOAT;else if(c instanceof Uint16Array)f=a.isFloat16BufferAttribute?n.HALF_FLOAT:n.UNSIGNED_SHORT;else if(c instanceof Int16Array)f=n.SHORT;else if(c instanceof Uint32Array)f=n.UNSIGNED_INT;else if(c instanceof Int32Array)f=n.INT;else if(c instanceof Int8Array)f=n.BYTE;else if(c instanceof Uint8Array)f=n.UNSIGNED_BYTE;else{if(!(c instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);f=n.UNSIGNED_BYTE}return{buffer:h,type:f,bytesPerElement:c.BYTES_PER_ELEMENT,version:a.version,size:d}}(a,l));else if(c.version<a.version){if(c.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");(function i(a,l,c){const u=l.array,d=l.updateRanges;if(n.bindBuffer(c,a),0===d.length)n.bufferSubData(c,0,u);else{d.sort((f,p)=>f.start-p.start);let h=0;for(let f=1;f<d.length;f++){const p=d[h],v=d[f];v.start<=p.start+p.count+1?p.count=Math.max(p.count,v.start+v.count-p.start):(++h,d[h]=v)}d.length=h+1;for(let f=0,p=d.length;f<p;f++){const v=d[f];n.bufferSubData(c,v.start*u.BYTES_PER_ELEMENT,u,v.start,v.count)}l.clearUpdateRanges()}l.onUploadCallback()})(c.buffer,a,l),c.version=a.version}}}}pn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},pn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},pn.prototype.GetterByBindingType=[pn.prototype._getValue_direct,pn.prototype._getValue_array,pn.prototype._getValue_arrayElement,pn.prototype._getValue_toArray],pn.prototype.SetterByBindingTypeAndVersioning=[[pn.prototype._setValue_direct,pn.prototype._setValue_direct_setNeedsUpdate,pn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[pn.prototype._setValue_array,pn.prototype._setValue_array_setNeedsUpdate,pn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[pn.prototype._setValue_arrayElement,pn.prototype._setValue_arrayElement_setNeedsUpdate,pn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[pn.prototype._setValue_fromArray,pn.prototype._setValue_fromArray_setNeedsUpdate,pn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1),typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"172"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="172");const St={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},be={common:{diffuse:{value:new Ie(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new vt},alphaMap:{value:null},alphaMapTransform:{value:new vt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new vt}},envmap:{envMap:{value:null},envMapRotation:{value:new vt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new vt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new vt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new vt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new vt},normalScale:{value:new ee(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new vt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new vt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new vt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new vt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ie(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ie(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new vt},alphaTest:{value:0},uvTransform:{value:new vt}},sprite:{diffuse:{value:new Ie(16777215)},opacity:{value:1},center:{value:new ee(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new vt},alphaMap:{value:null},alphaMapTransform:{value:new vt},alphaTest:{value:0}}},Ls={basic:{uniforms:Vi([be.common,be.specularmap,be.envmap,be.aomap,be.lightmap,be.fog]),vertexShader:St.meshbasic_vert,fragmentShader:St.meshbasic_frag},lambert:{uniforms:Vi([be.common,be.specularmap,be.envmap,be.aomap,be.lightmap,be.emissivemap,be.bumpmap,be.normalmap,be.displacementmap,be.fog,be.lights,{emissive:{value:new Ie(0)}}]),vertexShader:St.meshlambert_vert,fragmentShader:St.meshlambert_frag},phong:{uniforms:Vi([be.common,be.specularmap,be.envmap,be.aomap,be.lightmap,be.emissivemap,be.bumpmap,be.normalmap,be.displacementmap,be.fog,be.lights,{emissive:{value:new Ie(0)},specular:{value:new Ie(1118481)},shininess:{value:30}}]),vertexShader:St.meshphong_vert,fragmentShader:St.meshphong_frag},standard:{uniforms:Vi([be.common,be.envmap,be.aomap,be.lightmap,be.emissivemap,be.bumpmap,be.normalmap,be.displacementmap,be.roughnessmap,be.metalnessmap,be.fog,be.lights,{emissive:{value:new Ie(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:St.meshphysical_vert,fragmentShader:St.meshphysical_frag},toon:{uniforms:Vi([be.common,be.aomap,be.lightmap,be.emissivemap,be.bumpmap,be.normalmap,be.displacementmap,be.gradientmap,be.fog,be.lights,{emissive:{value:new Ie(0)}}]),vertexShader:St.meshtoon_vert,fragmentShader:St.meshtoon_frag},matcap:{uniforms:Vi([be.common,be.bumpmap,be.normalmap,be.displacementmap,be.fog,{matcap:{value:null}}]),vertexShader:St.meshmatcap_vert,fragmentShader:St.meshmatcap_frag},points:{uniforms:Vi([be.points,be.fog]),vertexShader:St.points_vert,fragmentShader:St.points_frag},dashed:{uniforms:Vi([be.common,be.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:St.linedashed_vert,fragmentShader:St.linedashed_frag},depth:{uniforms:Vi([be.common,be.displacementmap]),vertexShader:St.depth_vert,fragmentShader:St.depth_frag},normal:{uniforms:Vi([be.common,be.bumpmap,be.normalmap,be.displacementmap,{opacity:{value:1}}]),vertexShader:St.meshnormal_vert,fragmentShader:St.meshnormal_frag},sprite:{uniforms:Vi([be.sprite,be.fog]),vertexShader:St.sprite_vert,fragmentShader:St.sprite_frag},background:{uniforms:{uvTransform:{value:new vt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:St.background_vert,fragmentShader:St.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new vt}},vertexShader:St.backgroundCube_vert,fragmentShader:St.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:St.cube_vert,fragmentShader:St.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:St.equirect_vert,fragmentShader:St.equirect_frag},distanceRGBA:{uniforms:Vi([be.common,be.displacementmap,{referencePosition:{value:new A},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:St.distanceRGBA_vert,fragmentShader:St.distanceRGBA_frag},shadow:{uniforms:Vi([be.lights,be.fog,{color:{value:new Ie(0)},opacity:{value:1}}]),vertexShader:St.shadow_vert,fragmentShader:St.shadow_frag}};Ls.physical={uniforms:Vi([Ls.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new vt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new vt},clearcoatNormalScale:{value:new ee(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new vt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new vt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new vt},sheen:{value:0},sheenColor:{value:new Ie(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new vt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new vt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new vt},transmissionSamplerSize:{value:new ee},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new vt},attenuationDistance:{value:0},attenuationColor:{value:new Ie(0)},specularColor:{value:new Ie(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new vt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new vt},anisotropyVector:{value:new ee},anisotropyMap:{value:null},anisotropyMapTransform:{value:new vt}}]),vertexShader:St.meshphysical_vert,fragmentShader:St.meshphysical_frag};const By={r:0,b:0,g:0},zl=new go,kre=new ot;function Ure(n,e,t,i,r,s,o){const a=new Ie(0);let c,u,l=!0===s?0:1,d=null,h=0,f=null;function p(_){let x=!0===_.isScene?_.background:null;return x&&x.isTexture&&(x=(_.backgroundBlurriness>0?t:e).get(x)),x}function g(_,x){_.getRGB(By,yF(n)),i.buffers.color.setClear(By.r,By.g,By.b,x,o)}return{getClearColor:function(){return a},setClearColor:function(_,x=1){a.set(_),l=x,g(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(_){l=_,g(a,l)},render:function v(_){let x=!1;const T=p(_);null===T?g(a,l):T&&T.isColor&&(g(T,1),x=!0);const E=n.xr.getEnvironmentBlendMode();"additive"===E?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===E&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||x)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))},addToRenderList:function m(_,x){const T=p(x);T&&(T.isCubeTexture||306===T.mapping)?(void 0===u&&(u=new Qn(new qu(1,1,1),new Rs({name:"BackgroundCubeMaterial",uniforms:Xu(Ls.backgroundCube.uniforms),vertexShader:Ls.backgroundCube.vertexShader,fragmentShader:Ls.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(E,C,R){this.matrixWorld.copyPosition(R.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),zl.copy(x.backgroundRotation),zl.x*=-1,zl.y*=-1,zl.z*=-1,T.isCubeTexture&&!1===T.isRenderTargetTexture&&(zl.y*=-1,zl.z*=-1),u.material.uniforms.envMap.value=T,u.material.uniforms.flipEnvMap.value=T.isCubeTexture&&!1===T.isRenderTargetTexture?-1:1,u.material.uniforms.backgroundBlurriness.value=x.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(kre.makeRotationFromEuler(zl)),u.material.toneMapped=Ft.getTransfer(T.colorSpace)!==nn,(d!==T||h!==T.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,d=T,h=T.version,f=n.toneMapping),u.layers.enableAll(),_.unshift(u,u.geometry,u.material,0,0,null)):T&&T.isTexture&&(void 0===c&&(c=new Qn(new $f(2,2),new Rs({name:"BackgroundMaterial",uniforms:Xu(Ls.background.uniforms),vertexShader:Ls.background.vertexShader,fragmentShader:Ls.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=T,c.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,c.material.toneMapped=Ft.getTransfer(T.colorSpace)!==nn,!0===T.matrixAutoUpdate&&T.updateMatrix(),c.material.uniforms.uvTransform.value.copy(T.matrix),(d!==T||h!==T.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,d=T,h=T.version,f=n.toneMapping),c.layers.enableAll(),_.unshift(c,c.geometry,c.material,0,0,null))},dispose:function y(){void 0!==u&&(u.geometry.dispose(),u.material.dispose()),void 0!==c&&(c.geometry.dispose(),c.material.dispose())}}}function Bre(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},r=h(null);let s=r,o=!1;function c(w){return n.bindVertexArray(w)}function u(w){return n.deleteVertexArray(w)}function h(w){const N=[],G=[],B=[];for(let j=0;j<t;j++)N[j]=0,G[j]=0,B[j]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:N,enabledAttributes:G,attributeDivisors:B,object:w,attributes:{},index:null}}function v(){const w=s.newAttributes;for(let N=0,G=w.length;N<G;N++)w[N]=0}function m(w){g(w,0)}function g(w,N){const B=s.enabledAttributes,j=s.attributeDivisors;s.newAttributes[w]=1,0===B[w]&&(n.enableVertexAttribArray(w),B[w]=1),j[w]!==N&&(n.vertexAttribDivisor(w,N),j[w]=N)}function y(){const w=s.newAttributes,N=s.enabledAttributes;for(let G=0,B=N.length;G<B;G++)N[G]!==w[G]&&(n.disableVertexAttribArray(G),N[G]=0)}function _(w,N,G,B,j,K,$){!0===$?n.vertexAttribIPointer(w,N,G,j,K):n.vertexAttribPointer(w,N,G,B,j,K)}function R(){M(),o=!0,s!==r&&(s=r,c(s.object))}function M(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:function a(w,N,G,B,j){let K=!1;const $=function d(w,N,G){const B=!0===G.wireframe;let j=i[w.id];void 0===j&&(j={},i[w.id]=j);let K=j[N.id];void 0===K&&(K={},j[N.id]=K);let $=K[B];return void 0===$&&($=h(function l(){return n.createVertexArray()}()),K[B]=$),$}(B,G,N);s!==$&&(s=$,c(s.object)),K=function f(w,N,G,B){const j=s.attributes,K=N.attributes;let $=0;const fe=G.getAttributes();for(const q in fe)if(fe[q].location>=0){const Re=j[q];let Ve=K[q];if(void 0===Ve&&("instanceMatrix"===q&&w.instanceMatrix&&(Ve=w.instanceMatrix),"instanceColor"===q&&w.instanceColor&&(Ve=w.instanceColor)),void 0===Re||Re.attribute!==Ve||Ve&&Re.data!==Ve.data)return!0;$++}return s.attributesNum!==$||s.index!==B}(w,B,G,j),K&&function p(w,N,G,B){const j={},K=N.attributes;let $=0;const fe=G.getAttributes();for(const q in fe)if(fe[q].location>=0){let Re=K[q];void 0===Re&&("instanceMatrix"===q&&w.instanceMatrix&&(Re=w.instanceMatrix),"instanceColor"===q&&w.instanceColor&&(Re=w.instanceColor));const Ve={};Ve.attribute=Re,Re&&Re.data&&(Ve.data=Re.data),j[q]=Ve,$++}s.attributes=j,s.attributesNum=$,s.index=B}(w,B,G,j),null!==j&&e.update(j,n.ELEMENT_ARRAY_BUFFER),(K||o)&&(o=!1,function x(w,N,G,B){v();const j=B.attributes,K=G.getAttributes(),$=N.defaultAttributeValues;for(const fe in K){const q=K[fe];if(q.location>=0){let we=j[fe];if(void 0===we&&("instanceMatrix"===fe&&w.instanceMatrix&&(we=w.instanceMatrix),"instanceColor"===fe&&w.instanceColor&&(we=w.instanceColor)),void 0!==we){const Re=we.normalized,Ve=we.itemSize,yt=e.get(we);if(void 0===yt)continue;const Wt=yt.buffer,J=yt.type,ge=yt.bytesPerElement,Ge=J===n.INT||J===n.UNSIGNED_INT||1013===we.gpuType;if(we.isInterleavedBufferAttribute){const me=we.data,Ye=me.stride,at=we.offset;if(me.isInstancedInterleavedBuffer){for(let nt=0;nt<q.locationSize;nt++)g(q.location+nt,me.meshPerAttribute);!0!==w.isInstancedMesh&&void 0===B._maxInstanceCount&&(B._maxInstanceCount=me.meshPerAttribute*me.count)}else for(let nt=0;nt<q.locationSize;nt++)m(q.location+nt);n.bindBuffer(n.ARRAY_BUFFER,Wt);for(let nt=0;nt<q.locationSize;nt++)_(q.location+nt,Ve/q.locationSize,J,Re,Ye*ge,(at+Ve/q.locationSize*nt)*ge,Ge)}else{if(we.isInstancedBufferAttribute){for(let me=0;me<q.locationSize;me++)g(q.location+me,we.meshPerAttribute);!0!==w.isInstancedMesh&&void 0===B._maxInstanceCount&&(B._maxInstanceCount=we.meshPerAttribute*we.count)}else for(let me=0;me<q.locationSize;me++)m(q.location+me);n.bindBuffer(n.ARRAY_BUFFER,Wt);for(let me=0;me<q.locationSize;me++)_(q.location+me,Ve/q.locationSize,J,Re,Ve*ge,Ve/q.locationSize*me*ge,Ge)}}else if(void 0!==$){const Re=$[fe];if(void 0!==Re)switch(Re.length){case 2:n.vertexAttrib2fv(q.location,Re);break;case 3:n.vertexAttrib3fv(q.location,Re);break;case 4:n.vertexAttrib4fv(q.location,Re);break;default:n.vertexAttrib1fv(q.location,Re)}}}}y()}(w,N,G,B),null!==j&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(j).buffer))},reset:R,resetDefaultState:M,dispose:function T(){R();for(const w in i){const N=i[w];for(const G in N){const B=N[G];for(const j in B)u(B[j].object),delete B[j];delete N[G]}delete i[w]}},releaseStatesOfGeometry:function E(w){if(void 0===i[w.id])return;const N=i[w.id];for(const G in N){const B=N[G];for(const j in B)u(B[j].object),delete B[j];delete N[G]}delete i[w.id]},releaseStatesOfProgram:function C(w){for(const N in i){const G=i[N];if(void 0===G[w.id])continue;const B=G[w.id];for(const j in B)u(B[j].object),delete B[j];delete G[w.id]}},initAttributes:v,enableAttribute:m,disableUnusedAttributes:y}}function Vre(n,e,t){let i;function o(c,u,d){0!==d&&(n.drawArraysInstanced(i,c,u,d),t.update(u,i,d))}this.setMode=function r(c){i=c},this.render=function s(c,u){n.drawArrays(i,c,u),t.update(u,i,1)},this.renderInstances=o,this.renderMultiDraw=function a(c,u,d){if(0===d)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,c,0,u,0,d);let f=0;for(let p=0;p<d;p++)f+=u[p];t.update(f,i,1)},this.renderMultiDrawInstances=function l(c,u,d,h){if(0===d)return;const f=e.get("WEBGL_multi_draw");if(null===f)for(let p=0;p<c.length;p++)o(c[p],u[p],h[p]);else{f.multiDrawArraysInstancedWEBGL(i,c,0,u,0,h,0,d);let p=0;for(let v=0;v<d;v++)p+=u[v]*h[v];t.update(p,i,1)}}}function zre(n,e,t,i){let r;function l(C){if("highp"===C){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";C="mediump"}return"mediump"===C&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=void 0!==t.precision?t.precision:"highp";const u=l(c);u!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);const d=!0===t.logarithmicDepthBuffer,h=!0===t.reverseDepthBuffer&&e.has("EXT_clip_control"),f=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function s(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const C=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:l,textureFormatReadable:function o(C){return!(C!==tr&&i.convert(C)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))},textureTypeReadable:function a(C){const R=C===wf&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(C!==lo&&i.convert(C)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&C!==yr&&!R)},precision:c,logarithmicDepthBuffer:d,reverseDepthBuffer:h,maxTextures:f,maxVertexTextures:p,maxTextureSize:n.getParameter(n.MAX_TEXTURE_SIZE),maxCubemapSize:n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:n.getParameter(n.MAX_VERTEX_ATTRIBS),maxVertexUniforms:n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:n.getParameter(n.MAX_VARYING_VECTORS),maxFragmentUniforms:n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:p>0,maxSamples:n.getParameter(n.MAX_SAMPLES)}}function Hre(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new Cl,a=new vt,l={value:null,needsUpdate:!1};function u(d,h,f,p){const v=null!==d?d.length:0;let m=null;if(0!==v){if(m=l.value,!0!==p||null===m){const g=f+4*v,y=h.matrixWorldInverse;a.getNormalMatrix(y),(null===m||m.length<g)&&(m=new Float32Array(g));for(let _=0,x=f;_!==v;++_,x+=4)o.copy(d[_]).applyMatrix4(y,a),o.normal.toArray(m,x),m[x+3]=o.constant}l.value=m,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,m}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const f=0!==d.length||h||0!==i||r;return r=h,i=d.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){t=u(d,h,0)},this.setState=function(d,h,f){const p=d.clippingPlanes,v=d.clipIntersection,m=d.clipShadows,g=n.get(d);if(!r||null===p||0===p.length||s&&!m)s?u(null):function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}();else{const y=s?0:i,_=4*y;let x=g.clippingState||null;l.value=x,x=u(p,h,_,f);for(let T=0;T!==_;++T)x[T]=t[T];g.clippingState=x,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=y}}}function Gre(n){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=301:304===a&&(o.mapping=302),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function i(o){if(o&&o.isTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new Uee(l.height);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}const Bk=[.125,.215,.35,.446,.526,.582],VS=new NS,Vk=new Ie;let zS=null,HS=0,GS=0,jS=!1;const Gl=(1+Math.sqrt(5))/2,ld=1/Gl,zk=[new A(-Gl,ld,0),new A(Gl,ld,0),new A(-ld,0,Gl),new A(ld,0,Gl),new A(0,Gl,-ld),new A(0,Gl,ld),new A(-1,1,-1),new A(1,1,-1),new A(-1,1,1),new A(1,1,1)];class Hk{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){zS=this._renderer.getRenderTarget(),HS=this._renderer.getActiveCubeFace(),GS=this._renderer.getActiveMipmapLevel(),jS=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=$k(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=jk(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(zS,HS,GS),this._renderer.xr.enabled=jS,e.scissorTest=!1,Vy(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),zS=this._renderer.getRenderTarget(),HS=this._renderer.getActiveCubeFace(),GS=this._renderer.getActiveMipmapLevel(),jS=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:ui,minFilter:ui,generateMipmaps:!1,type:wf,format:tr,colorSpace:Iu,depthBuffer:!1},r=Gk(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Gk(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function jre(n){const e=[],t=[],i=[];let r=n;const s=n-4+1+Bk.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-4?l=Bk[o-n+4-1]:0===o&&(l=0),i.push(l);const c=1/(a-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,p=6,v=3,m=2,g=1,y=new Float32Array(v*p*f),_=new Float32Array(m*p*f),x=new Float32Array(g*p*f);for(let E=0;E<f;E++){const C=E%3*2/3-1,R=E>2?0:-1;y.set([C,R,0,C+2/3,R,0,C+2/3,R+1,0,C,R,0,C+2/3,R+1,0,C,R+1,0],v*p*E),_.set(h,m*p*E),x.set([E,E,E,E,E,E],g*p*E)}const T=new bt;T.setAttribute("position",new ln(y,v)),T.setAttribute("uv",new ln(_,m)),T.setAttribute("faceIndex",new ln(x,g)),e.push(T),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(s)),this._blurMaterial=function $re(n,e,t){const i=new Float32Array(20),r=new A(0,1,0);return new Rs({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Qn(this._lodPlanes[0],e);this._renderer.compile(t,VS)}_sceneToCubeUV(e,t,i,r){const a=new pi(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(Vk),u.toneMapping=0,u.autoClear=!1;const f=new Sl({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),p=new Qn(new qu,f);let v=!1;const m=e.background;m?m.isColor&&(f.color.copy(m),e.background=null,v=!0):(f.color.copy(Vk),v=!0);for(let g=0;g<6;g++){const y=g%3;0===y?(a.up.set(0,l[g],0),a.lookAt(c[g],0,0)):1===y?(a.up.set(0,0,l[g]),a.lookAt(0,c[g],0)):(a.up.set(0,l[g],0),a.lookAt(0,0,c[g]));const _=this._cubeSize;Vy(r,y*_,g>2?_:0,_,_),u.setRenderTarget(r),v&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=m}_textureToCubeUV(e,t){const i=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=$k()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=jk());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Qn(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;Vy(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,VS)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]);this._blur(e,s-1,s,o,zk[(r-s-1)%zk.length])}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const d=new Qn(this._lodPlanes[r],c),h=c.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,v=s/p,m=isFinite(s)?1+Math.floor(3*v):20;m>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${m} samples when the maximum is set to 20`);const g=[];let y=0;for(let C=0;C<20;++C){const R=C/v,M=Math.exp(-R*R/2);g.push(M),0===C?y+=M:C<m&&(y+=2*M)}for(let C=0;C<g.length;C++)g[C]=g[C]/y;h.envMap.value=e.texture,h.samples.value=m,h.weights.value=g,h.latitudinal.value="latitudinal"===o,a&&(h.poleAxis.value=a);const{_lodMax:_}=this;h.dTheta.value=p,h.mipInt.value=_-i;const x=this._sizeLods[r];Vy(t,3*x*(r>_-4?r-_+4:0),4*(this._cubeSize-x),3*x,2*x),l.setRenderTarget(t),l.render(d,VS)}}function Gk(n,e,t){const i=new ho(n,e,t);return i.texture.mapping=306,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Vy(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function jk(){return new Rs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function $k(){return new Rs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Wre(n){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function i(a){if(a&&a.isTexture){const l=a.mapping,c=303===l||304===l,u=301===l||302===l;if(c||u){let d=e.get(a);if(a.isRenderTargetTexture&&a.pmremVersion!==(void 0!==d?d.texture.pmremVersion:0))return null===t&&(t=new Hk(n)),d=c?t.fromEquirectangular(a,d):t.fromCubemap(a,d),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),d.texture;if(void 0!==d)return d.texture;{const f=a.image;return c&&f&&f.height>0||u&&f&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(f)?(null===t&&(t=new Hk(n)),d=c?t.fromEquirectangular(a):t.fromCubemap(a),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),a.addEventListener("dispose",s),d.texture):null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function qre(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const r=t(i);return null===r&&Lu("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Xre(n,e,t,i){const r={},s=new WeakMap;function o(d){const h=d.target;null!==h.index&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);h.removeEventListener("dispose",o),delete r[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),i.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,t.memory.geometries--}function c(d){const h=[],f=d.index,p=d.attributes.position;let v=0;if(null!==f){const y=f.array;v=f.version;for(let _=0,x=y.length;_<x;_+=3){const T=y[_+0],E=y[_+1],C=y[_+2];h.push(T,E,E,C,C,T)}}else{if(void 0===p)return;v=p.version;for(let _=0,x=p.array.length/3-1;_<x;_+=3){const T=_+0,E=_+1,C=_+2;h.push(T,E,E,C,C,T)}}const m=new(QO(h)?pF:fF)(h,1);m.version=v;const g=s.get(d);g&&e.remove(g),s.set(d,m)}return{get:function a(d,h){return!0===r[h.id]||(h.addEventListener("dispose",o),r[h.id]=!0,t.memory.geometries++),h},update:function l(d){const h=d.attributes;for(const f in h)e.update(h[f],n.ARRAY_BUFFER)},getWireframeAttribute:function u(d){const h=s.get(d);if(h){const f=d.index;null!==f&&h.version<f.version&&c(d)}else c(d);return s.get(d)}}}function Yre(n,e,t){let i,s,o;function c(h,f,p){0!==p&&(n.drawElementsInstanced(i,f,s,h*o,p),t.update(f,i,p))}this.setMode=function r(h){i=h},this.setIndex=function a(h){s=h.type,o=h.bytesPerElement},this.render=function l(h,f){n.drawElements(i,f,s,h*o),t.update(f,i,1)},this.renderInstances=c,this.renderMultiDraw=function u(h,f,p){if(0===p)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,f,0,s,h,0,p);let m=0;for(let g=0;g<p;g++)m+=f[g];t.update(m,i,1)},this.renderMultiDrawInstances=function d(h,f,p,v){if(0===p)return;const m=e.get("WEBGL_multi_draw");if(null===m)for(let g=0;g<h.length;g++)c(h[g]/o,f[g],v[g]);else{m.multiDrawElementsInstancedWEBGL(i,f,0,s,h,0,v,0,p);let g=0;for(let y=0;y<p;y++)g+=f[y]*v[y];t.update(g,i,1)}}}function Zre(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function Jre(n,e,t){const i=new WeakMap,r=new zt;return{update:function s(o,a,l){const c=o.morphTargetInfluences,u=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,d=void 0!==u?u.length:0;let h=i.get(a);if(void 0===h||h.count!==d){let M=function(){C.dispose(),i.delete(a),a.removeEventListener("dispose",M)};void 0!==h&&h.texture.dispose();const f=void 0!==a.morphAttributes.position,p=void 0!==a.morphAttributes.normal,v=void 0!==a.morphAttributes.color,m=a.morphAttributes.position||[],g=a.morphAttributes.normal||[],y=a.morphAttributes.color||[];let _=0;!0===f&&(_=1),!0===p&&(_=2),!0===v&&(_=3);let x=a.attributes.position.count*_,T=1;x>e.maxTextureSize&&(T=Math.ceil(x/e.maxTextureSize),x=e.maxTextureSize);const E=new Float32Array(x*T*4*d),C=new Lv(E,x,T,d);C.type=yr,C.needsUpdate=!0;const R=4*_;for(let w=0;w<d;w++){const N=m[w],G=g[w],B=y[w],j=x*T*4*w;for(let K=0;K<N.count;K++){const $=K*R;!0===f&&(r.fromBufferAttribute(N,K),E[j+$+0]=r.x,E[j+$+1]=r.y,E[j+$+2]=r.z,E[j+$+3]=0),!0===p&&(r.fromBufferAttribute(G,K),E[j+$+4]=r.x,E[j+$+5]=r.y,E[j+$+6]=r.z,E[j+$+7]=0),!0===v&&(r.fromBufferAttribute(B,K),E[j+$+8]=r.x,E[j+$+9]=r.y,E[j+$+10]=r.z,E[j+$+11]=4===B.itemSize?r.w:1)}}h={count:d,texture:C,size:new ee(x,T)},i.set(a,h),a.addEventListener("dispose",M)}if(!0===o.isInstancedMesh&&null!==o.morphTexture)l.getUniforms().setValue(n,"morphTexture",o.morphTexture,t);else{let f=0;for(let v=0;v<c.length;v++)f+=c[v];const p=a.morphTargetsRelative?1:1-f;l.getUniforms().setValue(n,"morphTargetBaseInfluence",p),l.getUniforms().setValue(n,"morphTargetInfluences",c)}l.getUniforms().setValue(n,"morphTargetsTexture",h.texture,t),l.getUniforms().setValue(n,"morphTargetsTextureSize",h.size)}}}function Kre(n,e,t,i){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=i.render.frame,d=e.get(l,l.geometry);if(r.get(d)!==c&&(e.update(d),r.set(d,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),null!==l.instanceColor&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const h=l.skeleton;r.get(h)!==c&&(h.update(),r.set(h,c))}return d},dispose:function o(){r=new WeakMap}}}const Wk=new nr,qk=new jF(1,1),Xk=new Lv,Yk=new TE,Zk=new Jv,Jk=[],Kk=[],Qk=new Float32Array(16),e3=new Float32Array(9),t3=new Float32Array(4);function cd(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=Jk[r];if(void 0===s&&(s=new Float32Array(r),Jk[r]=s),0!==e){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function ei(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function ti(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function zy(n,e){let t=Kk[e];void 0===t&&(t=new Int32Array(e),Kk[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Qre(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function ese(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ei(t,e))return;n.uniform2fv(this.addr,e),ti(t,e)}}function tse(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ei(t,e))return;n.uniform3fv(this.addr,e),ti(t,e)}}function nse(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ei(t,e))return;n.uniform4fv(this.addr,e),ti(t,e)}}function ise(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(ei(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),ti(t,e)}else{if(ei(t,i))return;t3.set(i),n.uniformMatrix2fv(this.addr,!1,t3),ti(t,i)}}function rse(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(ei(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),ti(t,e)}else{if(ei(t,i))return;e3.set(i),n.uniformMatrix3fv(this.addr,!1,e3),ti(t,i)}}function sse(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(ei(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),ti(t,e)}else{if(ei(t,i))return;Qk.set(i),n.uniformMatrix4fv(this.addr,!1,Qk),ti(t,i)}}function ose(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function ase(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ei(t,e))return;n.uniform2iv(this.addr,e),ti(t,e)}}function lse(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ei(t,e))return;n.uniform3iv(this.addr,e),ti(t,e)}}function cse(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ei(t,e))return;n.uniform4iv(this.addr,e),ti(t,e)}}function use(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function dse(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ei(t,e))return;n.uniform2uiv(this.addr,e),ti(t,e)}}function hse(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ei(t,e))return;n.uniform3uiv(this.addr,e),ti(t,e)}}function fse(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ei(t,e))return;n.uniform4uiv(this.addr,e),ti(t,e)}}function pse(n,e,t){const i=this.cache,r=t.allocateTextureUnit();let s;i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),this.type===n.SAMPLER_2D_SHADOW?(qk.compareFunction=515,s=qk):s=Wk,t.setTexture2D(e||s,r)}function gse(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||Yk,r)}function mse(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||Zk,r)}function vse(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||Xk,r)}function _se(n,e){n.uniform1fv(this.addr,e)}function xse(n,e){const t=cd(e,this.size,2);n.uniform2fv(this.addr,t)}function wse(n,e){const t=cd(e,this.size,3);n.uniform3fv(this.addr,t)}function bse(n,e){const t=cd(e,this.size,4);n.uniform4fv(this.addr,t)}function Mse(n,e){const t=cd(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function Ese(n,e){const t=cd(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function Sse(n,e){const t=cd(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function Tse(n,e){n.uniform1iv(this.addr,e)}function Cse(n,e){n.uniform2iv(this.addr,e)}function Dse(n,e){n.uniform3iv(this.addr,e)}function Ase(n,e){n.uniform4iv(this.addr,e)}function Ise(n,e){n.uniform1uiv(this.addr,e)}function Rse(n,e){n.uniform2uiv(this.addr,e)}function Nse(n,e){n.uniform3uiv(this.addr,e)}function Pse(n,e){n.uniform4uiv(this.addr,e)}function Lse(n,e,t){const i=this.cache,r=e.length,s=zy(t,r);ei(i,s)||(n.uniform1iv(this.addr,s),ti(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||Wk,s[o])}function Ose(n,e,t){const i=this.cache,r=e.length,s=zy(t,r);ei(i,s)||(n.uniform1iv(this.addr,s),ti(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||Yk,s[o])}function Fse(n,e,t){const i=this.cache,r=e.length,s=zy(t,r);ei(i,s)||(n.uniform1iv(this.addr,s),ti(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||Zk,s[o])}function kse(n,e,t){const i=this.cache,r=e.length,s=zy(t,r);ei(i,s)||(n.uniform1iv(this.addr,s),ti(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||Xk,s[o])}class Bse{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=function yse(n){switch(n){case 5126:return Qre;case 35664:return ese;case 35665:return tse;case 35666:return nse;case 35674:return ise;case 35675:return rse;case 35676:return sse;case 5124:case 35670:return ose;case 35667:case 35671:return ase;case 35668:case 35672:return lse;case 35669:case 35673:return cse;case 5125:return use;case 36294:return dse;case 36295:return hse;case 36296:return fse;case 35678:case 36198:case 36298:case 36306:case 35682:return pse;case 35679:case 36299:case 36307:return gse;case 35680:case 36300:case 36308:case 36293:return mse;case 36289:case 36303:case 36311:case 36292:return vse}}(t.type)}}class Vse{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function Use(n){switch(n){case 5126:return _se;case 35664:return xse;case 35665:return wse;case 35666:return bse;case 35674:return Mse;case 35675:return Ese;case 35676:return Sse;case 5124:case 35670:return Tse;case 35667:case 35671:return Cse;case 35668:case 35672:return Dse;case 35669:case 35673:return Ase;case 5125:return Ise;case 36294:return Rse;case 36295:return Nse;case 36296:return Pse;case 35678:case 36198:case 36298:case 36306:case 35682:return Lse;case 35679:case 36299:case 36307:return Ose;case 35680:case 36300:case 36308:case 36293:return Fse;case 36289:case 36303:case 36311:case 36292:return kse}}(t.type)}}class zse{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const WS=/(\w+)(\])?(\[|\.)?/g;function n3(n,e){n.seq.push(e),n.map[e.id]=e}function Hse(n,e,t){const i=n.name,r=i.length;for(WS.lastIndex=0;;){const s=WS.exec(i);let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&WS.lastIndex+2===r){n3(t,void 0===c?new Bse(a,n,e):new Vse(a,n,e));break}{let d=t.map[a];void 0===d&&(d=new zse(a),n3(t,d)),t=d}}}class Hy{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r);Hse(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,i,r){const s=this.map[t];void 0!==s&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function i3(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let jse=0;const r3=new vt;function s3(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function $se(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join("\n")}(n.getShaderSource(e),o)}return r}function qse(n,e){const t=function Wse(n){Ft._getMatrix(r3,Ft.workingColorSpace,n);const e=`mat3( ${r3.elements.map(t=>t.toFixed(4))} )`;switch(Ft.getTransfer(n)){case Rv:return[e,"LinearTransferOETF"];case nn:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}(e);return[`vec4 ${n}( vec4 value ) {`,`\treturn ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join("\n")}function Xse(n,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="Cineon";break;case 4:t="ACESFilmic";break;case 6:t="AgX";break;case 7:t="Neutral";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Gy=new A;function qf(n){return""!==n}function o3(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function a3(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Qse=/^[ \t]*#include +<([\w\d./]+)>/gm;function qS(n){return n.replace(Qse,toe)}const eoe=new Map;function toe(n,e){let t=St[e];if(void 0===t){const i=eoe.get(e);if(void 0===i)throw new Error("Can not resolve #include <"+e+">");t=St[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i)}return qS(t)}const noe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function l3(n){return n.replace(noe,ioe)}function ioe(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function c3(n){let e=`precision ${n.precision} float;\n\tprecision ${n.precision} int;\n\tprecision ${n.precision} sampler2D;\n\tprecision ${n.precision} samplerCube;\n\tprecision ${n.precision} sampler3D;\n\tprecision ${n.precision} sampler2DArray;\n\tprecision ${n.precision} sampler2DShadow;\n\tprecision ${n.precision} samplerCubeShadow;\n\tprecision ${n.precision} sampler2DArrayShadow;\n\tprecision ${n.precision} isampler2D;\n\tprecision ${n.precision} isampler3D;\n\tprecision ${n.precision} isamplerCube;\n\tprecision ${n.precision} isampler2DArray;\n\tprecision ${n.precision} usampler2D;\n\tprecision ${n.precision} usampler3D;\n\tprecision ${n.precision} usamplerCube;\n\tprecision ${n.precision} usampler2DArray;\n\t`;return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function coe(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function roe(n){let e="SHADOWMAP_TYPE_BASIC";return 1===n.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===n.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===n.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function soe(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function ooe(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&302===n.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),d=function aoe(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),h=function loe(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),f=function Zse(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(qf).join("\n")}(t),p=function Jse(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(s),v=r.createProgram();let m,g,y=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(m=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(qf).join("\n"),m.length>0&&(m+="\n"),g=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(qf).join("\n"),g.length>0&&(g+="\n")):(m=[c3(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(qf).join("\n"),g=[c3(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&!1===t.flatShading?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?St.tonemapping_pars_fragment:"",0!==t.toneMapping?Xse("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",St.colorspace_pars_fragment,qse("linearToOutputTexel",t.outputColorSpace),(Ft.getLuminanceCoefficients(Gy),["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${Gy.x.toFixed(4)}, ${Gy.y.toFixed(4)}, ${Gy.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(qf).join("\n")),o=qS(o),o=o3(o,t),o=a3(o,t),a=qS(a),a=o3(a,t),a=a3(a,t),o=l3(o),a=l3(a),!0!==t.isRawShaderMaterial&&(y="#version 300 es\n",m=[f,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,g=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g);const x=y+g+a,T=i3(r,r.VERTEX_SHADER,y+m+o),E=i3(r,r.FRAGMENT_SHADER,x);function C(N){if(n.debug.checkShaderErrors){const G=r.getProgramInfoLog(v).trim(),B=r.getShaderInfoLog(T).trim(),j=r.getShaderInfoLog(E).trim();let K=!0,$=!0;if(!1===r.getProgramParameter(v,r.LINK_STATUS))if(K=!1,"function"==typeof n.debug.onShaderError)n.debug.onShaderError(r,v,T,E);else{const fe=s3(r,T,"vertex"),q=s3(r,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+N.name+"\nMaterial Type: "+N.type+"\n\nProgram Info Log: "+G+"\n"+fe+"\n"+q)}else""!==G?console.warn("THREE.WebGLProgram: Program Info Log:",G):(""===B||""===j)&&($=!1);$&&(N.diagnostics={runnable:K,programLog:G,vertexShader:{log:B,prefix:m},fragmentShader:{log:j,prefix:g}})}r.deleteShader(T),r.deleteShader(E),R=new Hy(r,v),M=function Kse(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}(r,v)}let R,M;r.attachShader(v,T),r.attachShader(v,E),void 0!==t.index0AttributeName?r.bindAttribLocation(v,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v),this.getUniforms=function(){return void 0===R&&C(this),R},this.getAttributes=function(){return void 0===M&&C(this),M};let w=!1===t.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===w&&(w=r.getProgramParameter(v,37297)),w},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=jse++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=T,this.fragmentShader=E,this}let uoe=0;class doe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return void 0===i&&(i=new hoe(e),t.set(e,i)),i}}class hoe{constructor(e){this.id=uoe++,this.code=e,this.usedTimes=0}}function foe(n,e,t,i,r,s,o){const a=new PE,l=new doe,c=new Set,u=[],d=r.logarithmicDepthBuffer,h=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(M){return c.add(M),0===M?"uv":`uv${M}`}return{getParameters:function m(M,w,N,G,B){const j=G.fog,K=B.geometry,fe=(M.isMeshStandardMaterial?t:e).get(M.envMap||(M.isMeshStandardMaterial?G.environment:null)),q=fe&&306===fe.mapping?fe.image.height:null,we=p[M.type];null!==M.precision&&(f=r.getMaxPrecision(M.precision),f!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",f,"instead."));const Re=K.morphAttributes.position||K.morphAttributes.normal||K.morphAttributes.color,Ve=void 0!==Re?Re.length:0;let Wt,J,ge,Ge,yt=0;if(void 0!==K.morphAttributes.position&&(yt=1),void 0!==K.morphAttributes.normal&&(yt=2),void 0!==K.morphAttributes.color&&(yt=3),we){const Zt=Ls[we];Wt=Zt.vertexShader,J=Zt.fragmentShader}else Wt=M.vertexShader,J=M.fragmentShader,l.update(M),ge=l.getVertexShaderID(M),Ge=l.getFragmentShaderID(M);const me=n.getRenderTarget(),Ye=n.state.buffers.depth.getReversed(),at=!0===B.isInstancedMesh,nt=!0===B.isBatchedMesh,kt=!!M.map,pe=!!fe,I=!!M.aoMap,je=!!M.lightMap,le=!!M.bumpMap,Le=!!M.normalMap,ve=!!M.displacementMap,st=!!M.emissiveMap,Ce=!!M.metalnessMap,D=!!M.roughnessMap,b=M.anisotropy>0,F=M.clearcoat>0,se=M.iridescence>0,Z=M.sheen>0,He=M.transmission>0,Ee=b&&!!M.anisotropyMap,Pe=F&&!!M.clearcoatMap,At=F&&!!M.clearcoatNormalMap,he=F&&!!M.clearcoatRoughnessMap,ke=se&&!!M.iridescenceMap,it=se&&!!M.iridescenceThicknessMap,ut=Z&&!!M.sheenColorMap,Ue=Z&&!!M.sheenRoughnessMap,Lt=!!M.specularMap,Tt=!!M.specularColorMap,dn=!!M.specularIntensityMap,P=He&&!!M.transmissionMap,Se=He&&!!M.thicknessMap,Q=!!M.alphaMap,Mt=!!M.extensions;let In=0;M.toneMapped&&(null===me||!0===me.isXRRenderTarget)&&(In=n.toneMapping);const Ti={shaderID:we,shaderType:M.type,shaderName:M.name,vertexShader:Wt,fragmentShader:J,defines:M.defines,customVertexShaderID:ge,customFragmentShaderID:Ge,isRawShaderMaterial:!0===M.isRawShaderMaterial,glslVersion:M.glslVersion,precision:f,batching:nt,batchingColor:nt&&null!==B._colorsTexture,instancing:at,instancingColor:at&&null!==B.instanceColor,instancingMorph:at&&null!==B.morphTexture,supportsVertexTextures:h,outputColorSpace:null===me?n.outputColorSpace:!0===me.isXRRenderTarget?me.texture.colorSpace:Iu,alphaToCoverage:!!M.alphaToCoverage,map:kt,matcap:!!M.matcap,envMap:pe,envMapMode:pe&&fe.mapping,envMapCubeUVHeight:q,aoMap:I,lightMap:je,bumpMap:le,normalMap:Le,displacementMap:h&&ve,emissiveMap:st,normalMapObjectSpace:Le&&1===M.normalMapType,normalMapTangentSpace:Le&&0===M.normalMapType,metalnessMap:Ce,roughnessMap:D,anisotropy:b,anisotropyMap:Ee,clearcoat:F,clearcoatMap:Pe,clearcoatNormalMap:At,clearcoatRoughnessMap:he,dispersion:M.dispersion>0,iridescence:se,iridescenceMap:ke,iridescenceThicknessMap:it,sheen:Z,sheenColorMap:ut,sheenRoughnessMap:Ue,specularMap:Lt,specularColorMap:Tt,specularIntensityMap:dn,transmission:He,transmissionMap:P,thicknessMap:Se,gradientMap:!!M.gradientMap,opaque:!1===M.transparent&&1===M.blending&&!1===M.alphaToCoverage,alphaMap:Q,alphaTest:M.alphaTest>0,alphaHash:!!M.alphaHash,combine:M.combine,mapUv:kt&&v(M.map.channel),aoMapUv:I&&v(M.aoMap.channel),lightMapUv:je&&v(M.lightMap.channel),bumpMapUv:le&&v(M.bumpMap.channel),normalMapUv:Le&&v(M.normalMap.channel),displacementMapUv:ve&&v(M.displacementMap.channel),emissiveMapUv:st&&v(M.emissiveMap.channel),metalnessMapUv:Ce&&v(M.metalnessMap.channel),roughnessMapUv:D&&v(M.roughnessMap.channel),anisotropyMapUv:Ee&&v(M.anisotropyMap.channel),clearcoatMapUv:Pe&&v(M.clearcoatMap.channel),clearcoatNormalMapUv:At&&v(M.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:he&&v(M.clearcoatRoughnessMap.channel),iridescenceMapUv:ke&&v(M.iridescenceMap.channel),iridescenceThicknessMapUv:it&&v(M.iridescenceThicknessMap.channel),sheenColorMapUv:ut&&v(M.sheenColorMap.channel),sheenRoughnessMapUv:Ue&&v(M.sheenRoughnessMap.channel),specularMapUv:Lt&&v(M.specularMap.channel),specularColorMapUv:Tt&&v(M.specularColorMap.channel),specularIntensityMapUv:dn&&v(M.specularIntensityMap.channel),transmissionMapUv:P&&v(M.transmissionMap.channel),thicknessMapUv:Se&&v(M.thicknessMap.channel),alphaMapUv:Q&&v(M.alphaMap.channel),vertexTangents:!!K.attributes.tangent&&(Le||b),vertexColors:M.vertexColors,vertexAlphas:!0===M.vertexColors&&!!K.attributes.color&&4===K.attributes.color.itemSize,pointsUvs:!0===B.isPoints&&!!K.attributes.uv&&(kt||Q),fog:!!j,useFog:!0===M.fog,fogExp2:!!j&&j.isFogExp2,flatShading:!0===M.flatShading,sizeAttenuation:!0===M.sizeAttenuation,logarithmicDepthBuffer:d,reverseDepthBuffer:Ye,skinning:!0===B.isSkinnedMesh,morphTargets:void 0!==K.morphAttributes.position,morphNormals:void 0!==K.morphAttributes.normal,morphColors:void 0!==K.morphAttributes.color,morphTargetsCount:Ve,morphTextureStride:yt,numDirLights:w.directional.length,numPointLights:w.point.length,numSpotLights:w.spot.length,numSpotLightMaps:w.spotLightMap.length,numRectAreaLights:w.rectArea.length,numHemiLights:w.hemi.length,numDirLightShadows:w.directionalShadowMap.length,numPointLightShadows:w.pointShadowMap.length,numSpotLightShadows:w.spotShadowMap.length,numSpotLightShadowsWithMaps:w.numSpotLightShadowsWithMaps,numLightProbes:w.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:M.dithering,shadowMapEnabled:n.shadowMap.enabled&&N.length>0,shadowMapType:n.shadowMap.type,toneMapping:In,decodeVideoTexture:kt&&!0===M.map.isVideoTexture&&Ft.getTransfer(M.map.colorSpace)===nn,decodeVideoTextureEmissive:st&&!0===M.emissiveMap.isVideoTexture&&Ft.getTransfer(M.emissiveMap.colorSpace)===nn,premultipliedAlpha:M.premultipliedAlpha,doubleSided:2===M.side,flipSided:1===M.side,useDepthPacking:M.depthPacking>=0,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionClipCullDistance:Mt&&!0===M.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Mt&&!0===M.extensions.multiDraw||nt)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:M.customProgramCacheKey()};return Ti.vertexUv1s=c.has(1),Ti.vertexUv2s=c.has(2),Ti.vertexUv3s=c.has(3),c.clear(),Ti},getProgramCacheKey:function g(M){const w=[];if(M.shaderID?w.push(M.shaderID):(w.push(M.customVertexShaderID),w.push(M.customFragmentShaderID)),void 0!==M.defines)for(const N in M.defines)w.push(N),w.push(M.defines[N]);return!1===M.isRawShaderMaterial&&(function y(M,w){M.push(w.precision),M.push(w.outputColorSpace),M.push(w.envMapMode),M.push(w.envMapCubeUVHeight),M.push(w.mapUv),M.push(w.alphaMapUv),M.push(w.lightMapUv),M.push(w.aoMapUv),M.push(w.bumpMapUv),M.push(w.normalMapUv),M.push(w.displacementMapUv),M.push(w.emissiveMapUv),M.push(w.metalnessMapUv),M.push(w.roughnessMapUv),M.push(w.anisotropyMapUv),M.push(w.clearcoatMapUv),M.push(w.clearcoatNormalMapUv),M.push(w.clearcoatRoughnessMapUv),M.push(w.iridescenceMapUv),M.push(w.iridescenceThicknessMapUv),M.push(w.sheenColorMapUv),M.push(w.sheenRoughnessMapUv),M.push(w.specularMapUv),M.push(w.specularColorMapUv),M.push(w.specularIntensityMapUv),M.push(w.transmissionMapUv),M.push(w.thicknessMapUv),M.push(w.combine),M.push(w.fogExp2),M.push(w.sizeAttenuation),M.push(w.morphTargetsCount),M.push(w.morphAttributeCount),M.push(w.numDirLights),M.push(w.numPointLights),M.push(w.numSpotLights),M.push(w.numSpotLightMaps),M.push(w.numHemiLights),M.push(w.numRectAreaLights),M.push(w.numDirLightShadows),M.push(w.numPointLightShadows),M.push(w.numSpotLightShadows),M.push(w.numSpotLightShadowsWithMaps),M.push(w.numLightProbes),M.push(w.shadowMapType),M.push(w.toneMapping),M.push(w.numClippingPlanes),M.push(w.numClipIntersection),M.push(w.depthPacking)}(w,M),function _(M,w){a.disableAll(),w.supportsVertexTextures&&a.enable(0),w.instancing&&a.enable(1),w.instancingColor&&a.enable(2),w.instancingMorph&&a.enable(3),w.matcap&&a.enable(4),w.envMap&&a.enable(5),w.normalMapObjectSpace&&a.enable(6),w.normalMapTangentSpace&&a.enable(7),w.clearcoat&&a.enable(8),w.iridescence&&a.enable(9),w.alphaTest&&a.enable(10),w.vertexColors&&a.enable(11),w.vertexAlphas&&a.enable(12),w.vertexUv1s&&a.enable(13),w.vertexUv2s&&a.enable(14),w.vertexUv3s&&a.enable(15),w.vertexTangents&&a.enable(16),w.anisotropy&&a.enable(17),w.alphaHash&&a.enable(18),w.batching&&a.enable(19),w.dispersion&&a.enable(20),w.batchingColor&&a.enable(21),M.push(a.mask),a.disableAll(),w.fog&&a.enable(0),w.useFog&&a.enable(1),w.flatShading&&a.enable(2),w.logarithmicDepthBuffer&&a.enable(3),w.reverseDepthBuffer&&a.enable(4),w.skinning&&a.enable(5),w.morphTargets&&a.enable(6),w.morphNormals&&a.enable(7),w.morphColors&&a.enable(8),w.premultipliedAlpha&&a.enable(9),w.shadowMapEnabled&&a.enable(10),w.doubleSided&&a.enable(11),w.flipSided&&a.enable(12),w.useDepthPacking&&a.enable(13),w.dithering&&a.enable(14),w.transmission&&a.enable(15),w.sheen&&a.enable(16),w.opaque&&a.enable(17),w.pointsUvs&&a.enable(18),w.decodeVideoTexture&&a.enable(19),w.decodeVideoTextureEmissive&&a.enable(20),w.alphaToCoverage&&a.enable(21),M.push(a.mask)}(w,M),w.push(n.outputColorSpace)),w.push(M.customProgramCacheKey),w.join()},getUniforms:function x(M){const w=p[M.type];let N;return N=w?Lee.clone(Ls[w].uniforms):M.uniforms,N},acquireProgram:function T(M,w){let N;for(let G=0,B=u.length;G<B;G++){const j=u[G];if(j.cacheKey===w){N=j,++N.usedTimes;break}}return void 0===N&&(N=new coe(n,w,M,s),u.push(N)),N},releaseProgram:function E(M){if(0==--M.usedTimes){const w=u.indexOf(M);u[w]=u[u.length-1],u.pop(),M.destroy()}},releaseShaderCache:function C(M){l.remove(M)},programs:u,dispose:function R(){l.dispose()}}}function poe(){let n=new WeakMap;return{has:function e(o){return n.has(o)},get:function t(o){let a=n.get(o);return void 0===a&&(a={},n.set(o,a)),a},remove:function i(o){n.delete(o)},update:function r(o,a,l){n.get(o)[a]=l},dispose:function s(){n=new WeakMap}}}function goe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function u3(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function d3(){const n=[];let e=0;const t=[],i=[],r=[];function o(d,h,f,p,v,m){let g=n[e];return void 0===g?(g={id:d.id,object:d,geometry:h,material:f,groupOrder:p,renderOrder:d.renderOrder,z:v,group:m},n[e]=g):(g.id=d.id,g.object=d,g.geometry=h,g.material=f,g.groupOrder=p,g.renderOrder=d.renderOrder,g.z=v,g.group=m),e++,g}return{opaque:t,transmissive:i,transparent:r,init:function s(){e=0,t.length=0,i.length=0,r.length=0},push:function a(d,h,f,p,v,m){const g=o(d,h,f,p,v,m);f.transmission>0?i.push(g):!0===f.transparent?r.push(g):t.push(g)},unshift:function l(d,h,f,p,v,m){const g=o(d,h,f,p,v,m);f.transmission>0?i.unshift(g):!0===f.transparent?r.unshift(g):t.unshift(g)},finish:function u(){for(let d=e,h=n.length;d<h;d++){const f=n[d];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(d,h){t.length>1&&t.sort(d||goe),i.length>1&&i.sort(h||u3),r.length>1&&r.sort(h||u3)}}}function moe(){let n=new WeakMap;return{get:function e(i,r){const s=n.get(i);let o;return void 0===s?(o=new d3,n.set(i,[o])):r>=s.length?(o=new d3,s.push(o)):o=s[r],o},dispose:function t(){n=new WeakMap}}}function voe(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new A,color:new Ie};break;case"SpotLight":t={position:new A,direction:new A,color:new Ie,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new A,color:new Ie,distance:0,decay:0};break;case"HemisphereLight":t={direction:new A,skyColor:new Ie,groundColor:new Ie};break;case"RectAreaLight":t={color:new Ie,position:new A,halfWidth:new A,halfHeight:new A}}return n[e.id]=t,t}}}let _oe=0;function xoe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function woe(n){const e=new voe,t=function yoe(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ee};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ee,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)i.probe.push(new A);const r=new A,s=new ot,o=new ot;return{setup:function a(c){let u=0,d=0,h=0;for(let M=0;M<9;M++)i.probe[M].set(0,0,0);let f=0,p=0,v=0,m=0,g=0,y=0,_=0,x=0,T=0,E=0,C=0;c.sort(xoe);for(let M=0,w=c.length;M<w;M++){const N=c[M],G=N.color,B=N.intensity,j=N.distance,K=N.shadow&&N.shadow.map?N.shadow.map.texture:null;if(N.isAmbientLight)u+=G.r*B,d+=G.g*B,h+=G.b*B;else if(N.isLightProbe){for(let $=0;$<9;$++)i.probe[$].addScaledVector(N.sh.coefficients[$],B);C++}else if(N.isDirectionalLight){const $=e.get(N);if($.color.copy(N.color).multiplyScalar(N.intensity),N.castShadow){const fe=N.shadow,q=t.get(N);q.shadowIntensity=fe.intensity,q.shadowBias=fe.bias,q.shadowNormalBias=fe.normalBias,q.shadowRadius=fe.radius,q.shadowMapSize=fe.mapSize,i.directionalShadow[f]=q,i.directionalShadowMap[f]=K,i.directionalShadowMatrix[f]=N.shadow.matrix,y++}i.directional[f]=$,f++}else if(N.isSpotLight){const $=e.get(N);$.position.setFromMatrixPosition(N.matrixWorld),$.color.copy(G).multiplyScalar(B),$.distance=j,$.coneCos=Math.cos(N.angle),$.penumbraCos=Math.cos(N.angle*(1-N.penumbra)),$.decay=N.decay,i.spot[v]=$;const fe=N.shadow;if(N.map&&(i.spotLightMap[T]=N.map,T++,fe.updateMatrices(N),N.castShadow&&E++),i.spotLightMatrix[v]=fe.matrix,N.castShadow){const q=t.get(N);q.shadowIntensity=fe.intensity,q.shadowBias=fe.bias,q.shadowNormalBias=fe.normalBias,q.shadowRadius=fe.radius,q.shadowMapSize=fe.mapSize,i.spotShadow[v]=q,i.spotShadowMap[v]=K,x++}v++}else if(N.isRectAreaLight){const $=e.get(N);$.color.copy(G).multiplyScalar(B),$.halfWidth.set(.5*N.width,0,0),$.halfHeight.set(0,.5*N.height,0),i.rectArea[m]=$,m++}else if(N.isPointLight){const $=e.get(N);if($.color.copy(N.color).multiplyScalar(N.intensity),$.distance=N.distance,$.decay=N.decay,N.castShadow){const fe=N.shadow,q=t.get(N);q.shadowIntensity=fe.intensity,q.shadowBias=fe.bias,q.shadowNormalBias=fe.normalBias,q.shadowRadius=fe.radius,q.shadowMapSize=fe.mapSize,q.shadowCameraNear=fe.camera.near,q.shadowCameraFar=fe.camera.far,i.pointShadow[p]=q,i.pointShadowMap[p]=K,i.pointShadowMatrix[p]=N.shadow.matrix,_++}i.point[p]=$,p++}else if(N.isHemisphereLight){const $=e.get(N);$.skyColor.copy(N.color).multiplyScalar(B),$.groundColor.copy(N.groundColor).multiplyScalar(B),i.hemi[g]=$,g++}}m>0&&(!0===n.has("OES_texture_float_linear")?(i.rectAreaLTC1=be.LTC_FLOAT_1,i.rectAreaLTC2=be.LTC_FLOAT_2):(i.rectAreaLTC1=be.LTC_HALF_1,i.rectAreaLTC2=be.LTC_HALF_2)),i.ambient[0]=u,i.ambient[1]=d,i.ambient[2]=h;const R=i.hash;(R.directionalLength!==f||R.pointLength!==p||R.spotLength!==v||R.rectAreaLength!==m||R.hemiLength!==g||R.numDirectionalShadows!==y||R.numPointShadows!==_||R.numSpotShadows!==x||R.numSpotMaps!==T||R.numLightProbes!==C)&&(i.directional.length=f,i.spot.length=v,i.rectArea.length=m,i.point.length=p,i.hemi.length=g,i.directionalShadow.length=y,i.directionalShadowMap.length=y,i.pointShadow.length=_,i.pointShadowMap.length=_,i.spotShadow.length=x,i.spotShadowMap.length=x,i.directionalShadowMatrix.length=y,i.pointShadowMatrix.length=_,i.spotLightMatrix.length=x+T-E,i.spotLightMap.length=T,i.numSpotLightShadowsWithMaps=E,i.numLightProbes=C,R.directionalLength=f,R.pointLength=p,R.spotLength=v,R.rectAreaLength=m,R.hemiLength=g,R.numDirectionalShadows=y,R.numPointShadows=_,R.numSpotShadows=x,R.numSpotMaps=T,R.numLightProbes=C,i.version=_oe++)},setupView:function l(c,u){let d=0,h=0,f=0,p=0,v=0;const m=u.matrixWorldInverse;for(let g=0,y=c.length;g<y;g++){const _=c[g];if(_.isDirectionalLight){const x=i.directional[d];x.direction.setFromMatrixPosition(_.matrixWorld),r.setFromMatrixPosition(_.target.matrixWorld),x.direction.sub(r),x.direction.transformDirection(m),d++}else if(_.isSpotLight){const x=i.spot[f];x.position.setFromMatrixPosition(_.matrixWorld),x.position.applyMatrix4(m),x.direction.setFromMatrixPosition(_.matrixWorld),r.setFromMatrixPosition(_.target.matrixWorld),x.direction.sub(r),x.direction.transformDirection(m),f++}else if(_.isRectAreaLight){const x=i.rectArea[p];x.position.setFromMatrixPosition(_.matrixWorld),x.position.applyMatrix4(m),o.identity(),s.copy(_.matrixWorld),s.premultiply(m),o.extractRotation(s),x.halfWidth.set(.5*_.width,0,0),x.halfHeight.set(0,.5*_.height,0),x.halfWidth.applyMatrix4(o),x.halfHeight.applyMatrix4(o),p++}else if(_.isPointLight){const x=i.point[h];x.position.setFromMatrixPosition(_.matrixWorld),x.position.applyMatrix4(m),h++}else if(_.isHemisphereLight){const x=i.hemi[v];x.direction.setFromMatrixPosition(_.matrixWorld),x.direction.transformDirection(m),v++}}},state:i}}function h3(n){const e=new woe(n),t=[],i=[],c={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:function r(u){c.camera=u,t.length=0,i.length=0},state:c,setupLights:function a(){e.setup(t)},setupLightsView:function l(u){e.setupView(t,u)},pushLight:function s(u){t.push(u)},pushShadow:function o(u){i.push(u)}}}function boe(n){let e=new WeakMap;return{get:function t(r,s=0){const o=e.get(r);let a;return void 0===o?(a=new h3(n),e.set(r,[a])):s>=o.length?(a=new h3(n),o.push(a)):a=o[s],a},dispose:function i(){e=new WeakMap}}}function Soe(n,e,t){let i=new sy;const r=new ee,s=new ee,o=new zt,a=new ok({depthPacking:3201}),l=new ak,c={},u=t.maxTextureSize,d={[oa]:1,[er]:0,[oo]:2},h=new Rs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ee},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const p=new bt;p.setAttribute("position",new ln(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new Qn(p,h),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let g=this.type;function y(E,C){const R=e.update(v);h.defines.VSM_SAMPLES!==E.blurSamples&&(h.defines.VSM_SAMPLES=E.blurSamples,f.defines.VSM_SAMPLES=E.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===E.mapPass&&(E.mapPass=new ho(r.x,r.y)),h.uniforms.shadow_pass.value=E.map.texture,h.uniforms.resolution.value=E.mapSize,h.uniforms.radius.value=E.radius,n.setRenderTarget(E.mapPass),n.clear(),n.renderBufferDirect(C,null,R,h,v,null),f.uniforms.shadow_pass.value=E.mapPass.texture,f.uniforms.resolution.value=E.mapSize,f.uniforms.radius.value=E.radius,n.setRenderTarget(E.map),n.clear(),n.renderBufferDirect(C,null,R,f,v,null)}function _(E,C,R,M){let w=null;const N=!0===R.isPointLight?E.customDistanceMaterial:E.customDepthMaterial;if(void 0!==N)w=N;else if(w=!0===R.isPointLight?l:a,n.localClippingEnabled&&!0===C.clipShadows&&Array.isArray(C.clippingPlanes)&&0!==C.clippingPlanes.length||C.displacementMap&&0!==C.displacementScale||C.alphaMap&&C.alphaTest>0||C.map&&C.alphaTest>0){const G=w.uuid,B=C.uuid;let j=c[G];void 0===j&&(j={},c[G]=j);let K=j[B];void 0===K&&(K=w.clone(),j[B]=K,C.addEventListener("dispose",T)),w=K}return w.visible=C.visible,w.wireframe=C.wireframe,w.side=3===M?null!==C.shadowSide?C.shadowSide:C.side:null!==C.shadowSide?C.shadowSide:d[C.side],w.alphaMap=C.alphaMap,w.alphaTest=C.alphaTest,w.map=C.map,w.clipShadows=C.clipShadows,w.clippingPlanes=C.clippingPlanes,w.clipIntersection=C.clipIntersection,w.displacementMap=C.displacementMap,w.displacementScale=C.displacementScale,w.displacementBias=C.displacementBias,w.wireframeLinewidth=C.wireframeLinewidth,w.linewidth=C.linewidth,!0===R.isPointLight&&!0===w.isMeshDistanceMaterial&&(n.properties.get(w).light=R),w}function x(E,C,R,M,w){if(!1===E.visible)return;if(E.layers.test(C.layers)&&(E.isMesh||E.isLine||E.isPoints)&&(E.castShadow||E.receiveShadow&&3===w)&&(!E.frustumCulled||i.intersectsObject(E))){E.modelViewMatrix.multiplyMatrices(R.matrixWorldInverse,E.matrixWorld);const B=e.update(E),j=E.material;if(Array.isArray(j)){const K=B.groups;for(let $=0,fe=K.length;$<fe;$++){const q=K[$],we=j[q.materialIndex];if(we&&we.visible){const Re=_(E,we,M,w);E.onBeforeShadow(n,E,C,R,B,Re,q),n.renderBufferDirect(R,null,B,Re,E,q),E.onAfterShadow(n,E,C,R,B,Re,q)}}}else if(j.visible){const K=_(E,j,M,w);E.onBeforeShadow(n,E,C,R,B,K,null),n.renderBufferDirect(R,null,B,K,E,null),E.onAfterShadow(n,E,C,R,B,K,null)}}const G=E.children;for(let B=0,j=G.length;B<j;B++)x(G[B],C,R,M,w)}function T(E){E.target.removeEventListener("dispose",T);for(const R in c){const M=c[R],w=E.target.uuid;w in M&&(M[w].dispose(),delete M[w])}}this.render=function(E,C,R){if(!1===m.enabled||!1===m.autoUpdate&&!1===m.needsUpdate||0===E.length)return;const M=n.getRenderTarget(),w=n.getActiveCubeFace(),N=n.getActiveMipmapLevel(),G=n.state;G.setBlending(0),G.buffers.color.setClear(1,1,1,1),G.buffers.depth.setTest(!0),G.setScissorTest(!1);const B=3!==g&&3===this.type,j=3===g&&3!==this.type;for(let K=0,$=E.length;K<$;K++){const fe=E[K],q=fe.shadow;if(void 0===q){console.warn("THREE.WebGLShadowMap:",fe,"has no shadow.");continue}if(!1===q.autoUpdate&&!1===q.needsUpdate)continue;r.copy(q.mapSize);const we=q.getFrameExtents();if(r.multiply(we),s.copy(q.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/we.x),r.x=s.x*we.x,q.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/we.y),r.y=s.y*we.y,q.mapSize.y=s.y)),null===q.map||!0===B||!0===j){const Ve=3!==this.type?{minFilter:bi,magFilter:bi}:{};null!==q.map&&q.map.dispose(),q.map=new ho(r.x,r.y,Ve),q.map.texture.name=fe.name+".shadowMap",q.camera.updateProjectionMatrix()}n.setRenderTarget(q.map),n.clear();const Re=q.getViewportCount();for(let Ve=0;Ve<Re;Ve++){const yt=q.getViewport(Ve);o.set(s.x*yt.x,s.y*yt.y,s.x*yt.z,s.y*yt.w),G.viewport(o),q.updateMatrices(fe,Ve),i=q.getFrustum(),x(C,R,q.camera,fe,this.type)}!0!==q.isPointLightShadow&&3===this.type&&y(q,R),q.needsUpdate=!1}g=this.type,m.needsUpdate=!1,n.setRenderTarget(M,w,N)}}const Toe={[PM]:1,[OM]:6,[FM]:7,[Eu]:5,[LM]:0,[UM]:2,[BM]:4,[kM]:3};function Coe(n,e){const s=new function t(){let P=!1;const Se=new zt;let X=null;const Q=new zt(0,0,0,0);return{setMask:function(Ae){X!==Ae&&!P&&(n.colorMask(Ae,Ae,Ae,Ae),X=Ae)},setLocked:function(Ae){P=Ae},setClear:function(Ae,De,Mt,In,Ti){!0===Ti&&(Ae*=In,De*=In,Mt*=In),Se.set(Ae,De,Mt,In),!1===Q.equals(Se)&&(n.clearColor(Ae,De,Mt,In),Q.copy(Se))},reset:function(){P=!1,X=null,Q.set(-1,0,0,0)}}},o=new function i(){let P=!1,Se=!1,X=null,Q=null,Ae=null;return{setReversed:function(De){if(Se!==De){const Mt=e.get("EXT_clip_control");Mt.clipControlEXT(Mt.LOWER_LEFT_EXT,Se?Mt.ZERO_TO_ONE_EXT:Mt.NEGATIVE_ONE_TO_ONE_EXT);const In=Ae;Ae=null,this.setClear(In)}Se=De},getReversed:function(){return Se},setTest:function(De){De?me(n.DEPTH_TEST):Ye(n.DEPTH_TEST)},setMask:function(De){X!==De&&!P&&(n.depthMask(De),X=De)},setFunc:function(De){if(Se&&(De=Toe[De]),Q!==De){switch(De){case 0:n.depthFunc(n.NEVER);break;case 1:n.depthFunc(n.ALWAYS);break;case 2:n.depthFunc(n.LESS);break;case 3:default:n.depthFunc(n.LEQUAL);break;case 4:n.depthFunc(n.EQUAL);break;case 5:n.depthFunc(n.GEQUAL);break;case 6:n.depthFunc(n.GREATER);break;case 7:n.depthFunc(n.NOTEQUAL)}Q=De}},setLocked:function(De){P=De},setClear:function(De){Ae!==De&&(Se&&(De=1-De),n.clearDepth(De),Ae=De)},reset:function(){P=!1,X=null,Q=null,Ae=null,Se=!1}}},a=new function r(){let P=!1,Se=null,X=null,Q=null,Ae=null,De=null,Mt=null,In=null,Ti=null;return{setTest:function(Zt){P||(Zt?me(n.STENCIL_TEST):Ye(n.STENCIL_TEST))},setMask:function(Zt){Se!==Zt&&!P&&(n.stencilMask(Zt),Se=Zt)},setFunc:function(Zt,os,Eo){(X!==Zt||Q!==os||Ae!==Eo)&&(n.stencilFunc(Zt,os,Eo),X=Zt,Q=os,Ae=Eo)},setOp:function(Zt,os,Eo){(De!==Zt||Mt!==os||In!==Eo)&&(n.stencilOp(Zt,os,Eo),De=Zt,Mt=os,In=Eo)},setLocked:function(Zt){P=Zt},setClear:function(Zt){Ti!==Zt&&(n.clearStencil(Zt),Ti=Zt)},reset:function(){P=!1,Se=null,X=null,Q=null,Ae=null,De=null,Mt=null,In=null,Ti=null}}},l=new WeakMap,c=new WeakMap;let u={},d={},h=new WeakMap,f=[],p=null,v=!1,m=null,g=null,y=null,_=null,x=null,T=null,E=null,C=new Ie(0,0,0),R=0,M=!1,w=null,N=null,G=null,B=null,j=null;const K=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let $=!1,fe=0;const q=n.getParameter(n.VERSION);-1!==q.indexOf("WebGL")?(fe=parseFloat(/^WebGL (\d)/.exec(q)[1]),$=fe>=1):-1!==q.indexOf("OpenGL ES")&&(fe=parseFloat(/^OpenGL ES (\d)/.exec(q)[1]),$=fe>=2);let we=null,Re={};const Ve=n.getParameter(n.SCISSOR_BOX),yt=n.getParameter(n.VIEWPORT),Wt=(new zt).fromArray(Ve),J=(new zt).fromArray(yt);function ge(P,Se,X,Q){const Ae=new Uint8Array(4),De=n.createTexture();n.bindTexture(P,De),n.texParameteri(P,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(P,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Mt=0;Mt<X;Mt++)P===n.TEXTURE_3D||P===n.TEXTURE_2D_ARRAY?n.texImage3D(Se,0,n.RGBA,1,1,Q,0,n.RGBA,n.UNSIGNED_BYTE,Ae):n.texImage2D(Se+Mt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Ae);return De}const Ge={};function me(P){!0!==u[P]&&(n.enable(P),u[P]=!0)}function Ye(P){!1!==u[P]&&(n.disable(P),u[P]=!1)}Ge[n.TEXTURE_2D]=ge(n.TEXTURE_2D,n.TEXTURE_2D,1),Ge[n.TEXTURE_CUBE_MAP]=ge(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ge[n.TEXTURE_2D_ARRAY]=ge(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ge[n.TEXTURE_3D]=ge(n.TEXTURE_3D,n.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),me(n.DEPTH_TEST),o.setFunc(3),le(!1),Le(1),me(n.CULL_FACE),I(0);const ne={[_l]:n.FUNC_ADD,[dQ]:n.FUNC_SUBTRACT,[hQ]:n.FUNC_REVERSE_SUBTRACT};ne[103]=n.MIN,ne[104]=n.MAX;const pe={[gQ]:n.ZERO,[mQ]:n.ONE,[vQ]:n.SRC_COLOR,[RM]:n.SRC_ALPHA,[MQ]:n.SRC_ALPHA_SATURATE,[wQ]:n.DST_COLOR,[_Q]:n.DST_ALPHA,[yQ]:n.ONE_MINUS_SRC_COLOR,[NM]:n.ONE_MINUS_SRC_ALPHA,[bQ]:n.ONE_MINUS_DST_COLOR,[xQ]:n.ONE_MINUS_DST_ALPHA,[EQ]:n.CONSTANT_COLOR,[SQ]:n.ONE_MINUS_CONSTANT_COLOR,[TQ]:n.CONSTANT_ALPHA,[CQ]:n.ONE_MINUS_CONSTANT_ALPHA};function I(P,Se,X,Q,Ae,De,Mt,In,Ti,Zt){if(0!==P){if(!1===v&&(me(n.BLEND),v=!0),5===P)Ae=Ae||Se,De=De||X,Mt=Mt||Q,(Se!==g||Ae!==x)&&(n.blendEquationSeparate(ne[Se],ne[Ae]),g=Se,x=Ae),(X!==y||Q!==_||De!==T||Mt!==E)&&(n.blendFuncSeparate(pe[X],pe[Q],pe[De],pe[Mt]),y=X,_=Q,T=De,E=Mt),(!1===In.equals(C)||Ti!==R)&&(n.blendColor(In.r,In.g,In.b,Ti),C.copy(In),R=Ti),m=P,M=!1;else if(P!==m||Zt!==M){if((100!==g||100!==x)&&(n.blendEquation(n.FUNC_ADD),g=100,x=100),Zt)switch(P){case 1:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.ONE,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",P)}else switch(P){case 1:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case 2:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case 3:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case 4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",P)}y=null,_=null,T=null,E=null,C.set(0,0,0),R=0,m=P,M=Zt}}else!0===v&&(Ye(n.BLEND),v=!1)}function le(P){w!==P&&(n.frontFace(P?n.CW:n.CCW),w=P)}function Le(P){0!==P?(me(n.CULL_FACE),P!==N&&n.cullFace(1===P?n.BACK:2===P?n.FRONT:n.FRONT_AND_BACK)):Ye(n.CULL_FACE),N=P}function st(P,Se,X){P?(me(n.POLYGON_OFFSET_FILL),(B!==Se||j!==X)&&(n.polygonOffset(Se,X),B=Se,j=X)):Ye(n.POLYGON_OFFSET_FILL)}return{buffers:{color:s,depth:o,stencil:a},enable:me,disable:Ye,bindFramebuffer:function at(P,Se){return d[P]!==Se&&(n.bindFramebuffer(P,Se),d[P]=Se,P===n.DRAW_FRAMEBUFFER&&(d[n.FRAMEBUFFER]=Se),P===n.FRAMEBUFFER&&(d[n.DRAW_FRAMEBUFFER]=Se),!0)},drawBuffers:function nt(P,Se){let X=f,Q=!1;if(P){X=h.get(Se),void 0===X&&(X=[],h.set(Se,X));const Ae=P.textures;if(X.length!==Ae.length||X[0]!==n.COLOR_ATTACHMENT0){for(let De=0,Mt=Ae.length;De<Mt;De++)X[De]=n.COLOR_ATTACHMENT0+De;X.length=Ae.length,Q=!0}}else X[0]!==n.BACK&&(X[0]=n.BACK,Q=!0);Q&&n.drawBuffers(X)},useProgram:function kt(P){return p!==P&&(n.useProgram(P),p=P,!0)},setBlending:I,setMaterial:function je(P,Se){2===P.side?Ye(n.CULL_FACE):me(n.CULL_FACE);let X=1===P.side;Se&&(X=!X),le(X),1===P.blending&&!1===P.transparent?I(0):I(P.blending,P.blendEquation,P.blendSrc,P.blendDst,P.blendEquationAlpha,P.blendSrcAlpha,P.blendDstAlpha,P.blendColor,P.blendAlpha,P.premultipliedAlpha),o.setFunc(P.depthFunc),o.setTest(P.depthTest),o.setMask(P.depthWrite),s.setMask(P.colorWrite);const Q=P.stencilWrite;a.setTest(Q),Q&&(a.setMask(P.stencilWriteMask),a.setFunc(P.stencilFunc,P.stencilRef,P.stencilFuncMask),a.setOp(P.stencilFail,P.stencilZFail,P.stencilZPass)),st(P.polygonOffset,P.polygonOffsetFactor,P.polygonOffsetUnits),!0===P.alphaToCoverage?me(n.SAMPLE_ALPHA_TO_COVERAGE):Ye(n.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:le,setCullFace:Le,setLineWidth:function ve(P){P!==G&&($&&n.lineWidth(P),G=P)},setPolygonOffset:st,setScissorTest:function Ce(P){P?me(n.SCISSOR_TEST):Ye(n.SCISSOR_TEST)},activeTexture:function D(P){void 0===P&&(P=n.TEXTURE0+K-1),we!==P&&(n.activeTexture(P),we=P)},bindTexture:function b(P,Se,X){void 0===X&&(X=null===we?n.TEXTURE0+K-1:we);let Q=Re[X];void 0===Q&&(Q={type:void 0,texture:void 0},Re[X]=Q),(Q.type!==P||Q.texture!==Se)&&(we!==X&&(n.activeTexture(X),we=X),n.bindTexture(P,Se||Ge[P]),Q.type=P,Q.texture=Se)},unbindTexture:function F(){const P=Re[we];void 0!==P&&void 0!==P.type&&(n.bindTexture(P.type,null),P.type=void 0,P.texture=void 0)},compressedTexImage2D:function Y(){try{n.compressedTexImage2D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},compressedTexImage3D:function se(){try{n.compressedTexImage3D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texImage2D:function ke(){try{n.texImage2D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texImage3D:function it(){try{n.texImage3D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},updateUBOMapping:function Lt(P,Se){let X=c.get(Se);void 0===X&&(X=new WeakMap,c.set(Se,X));let Q=X.get(P);void 0===Q&&(Q=n.getUniformBlockIndex(Se,P.name),X.set(P,Q))},uniformBlockBinding:function Tt(P,Se){const Q=c.get(Se).get(P);l.get(Se)!==Q&&(n.uniformBlockBinding(Se,Q,P.__bindingPointIndex),l.set(Se,Q))},texStorage2D:function At(){try{n.texStorage2D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texStorage3D:function he(){try{n.texStorage3D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texSubImage2D:function Z(){try{n.texSubImage2D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},texSubImage3D:function He(){try{n.texSubImage3D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},compressedTexSubImage2D:function Ee(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},compressedTexSubImage3D:function Pe(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(P){console.error("THREE.WebGLState:",P)}},scissor:function ut(P){!1===Wt.equals(P)&&(n.scissor(P.x,P.y,P.z,P.w),Wt.copy(P))},viewport:function Ue(P){!1===J.equals(P)&&(n.viewport(P.x,P.y,P.z,P.w),J.copy(P))},reset:function dn(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),o.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),u={},we=null,Re={},d={},h=new WeakMap,f=[],p=null,v=!1,m=null,g=null,y=null,_=null,x=null,T=null,E=null,C=new Ie(0,0,0),R=0,M=!1,w=null,N=null,G=null,B=null,j=null,Wt.set(0,0,n.canvas.width,n.canvas.height),J.set(0,0,n.canvas.width,n.canvas.height),s.reset(),o.reset(),a.reset()}}}function Doe(n,e,t,i,r,s,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=!(typeof navigator>"u")&&/OculusBrowser/g.test(navigator.userAgent),c=new ee,u=new WeakMap;let d;const h=new WeakMap;let f=!1;try{f=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function p(D,b){return f?new OffscreenCanvas(D,b):Mf("canvas")}function v(D,b,F){let Y=1;const se=Ce(D);if((se.width>F||se.height>F)&&(Y=F/Math.max(se.width,se.height)),Y<1){if(typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&D instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&D instanceof ImageBitmap||typeof VideoFrame<"u"&&D instanceof VideoFrame){const Z=Math.floor(Y*se.width),He=Math.floor(Y*se.height);void 0===d&&(d=p(Z,He));const Ee=b?p(Z,He):d;return Ee.width=Z,Ee.height=He,Ee.getContext("2d").drawImage(D,0,0,Z,He),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+se.width+"x"+se.height+") to ("+Z+"x"+He+")."),Ee}return"data"in D&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+se.width+"x"+se.height+")."),D}return D}function m(D){return D.generateMipmaps}function g(D){n.generateMipmap(D)}function y(D){return D.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:D.isWebGL3DRenderTarget?n.TEXTURE_3D:D.isWebGLArrayRenderTarget||D.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function _(D,b,F,Y,se=!1){if(null!==D){if(void 0!==n[D])return n[D];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+D+"'")}let Z=b;if(b===n.RED&&(F===n.FLOAT&&(Z=n.R32F),F===n.HALF_FLOAT&&(Z=n.R16F),F===n.UNSIGNED_BYTE&&(Z=n.R8)),b===n.RED_INTEGER&&(F===n.UNSIGNED_BYTE&&(Z=n.R8UI),F===n.UNSIGNED_SHORT&&(Z=n.R16UI),F===n.UNSIGNED_INT&&(Z=n.R32UI),F===n.BYTE&&(Z=n.R8I),F===n.SHORT&&(Z=n.R16I),F===n.INT&&(Z=n.R32I)),b===n.RG&&(F===n.FLOAT&&(Z=n.RG32F),F===n.HALF_FLOAT&&(Z=n.RG16F),F===n.UNSIGNED_BYTE&&(Z=n.RG8)),b===n.RG_INTEGER&&(F===n.UNSIGNED_BYTE&&(Z=n.RG8UI),F===n.UNSIGNED_SHORT&&(Z=n.RG16UI),F===n.UNSIGNED_INT&&(Z=n.RG32UI),F===n.BYTE&&(Z=n.RG8I),F===n.SHORT&&(Z=n.RG16I),F===n.INT&&(Z=n.RG32I)),b===n.RGB_INTEGER&&(F===n.UNSIGNED_BYTE&&(Z=n.RGB8UI),F===n.UNSIGNED_SHORT&&(Z=n.RGB16UI),F===n.UNSIGNED_INT&&(Z=n.RGB32UI),F===n.BYTE&&(Z=n.RGB8I),F===n.SHORT&&(Z=n.RGB16I),F===n.INT&&(Z=n.RGB32I)),b===n.RGBA_INTEGER&&(F===n.UNSIGNED_BYTE&&(Z=n.RGBA8UI),F===n.UNSIGNED_SHORT&&(Z=n.RGBA16UI),F===n.UNSIGNED_INT&&(Z=n.RGBA32UI),F===n.BYTE&&(Z=n.RGBA8I),F===n.SHORT&&(Z=n.RGBA16I),F===n.INT&&(Z=n.RGBA32I)),b===n.RGB&&F===n.UNSIGNED_INT_5_9_9_9_REV&&(Z=n.RGB9_E5),b===n.RGBA){const He=se?Rv:Ft.getTransfer(Y);F===n.FLOAT&&(Z=n.RGBA32F),F===n.HALF_FLOAT&&(Z=n.RGBA16F),F===n.UNSIGNED_BYTE&&(Z=He===nn?n.SRGB8_ALPHA8:n.RGBA8),F===n.UNSIGNED_SHORT_4_4_4_4&&(Z=n.RGBA4),F===n.UNSIGNED_SHORT_5_5_5_1&&(Z=n.RGB5_A1)}return(Z===n.R16F||Z===n.R32F||Z===n.RG16F||Z===n.RG32F||Z===n.RGBA16F||Z===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Z}function x(D,b){let F;return D?null===b||b===ua||b===Su?F=n.DEPTH24_STENCIL8:b===yr?F=n.DEPTH32F_STENCIL8:b===xf&&(F=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===b||b===ua||b===Su?F=n.DEPTH_COMPONENT24:b===yr?F=n.DEPTH_COMPONENT32F:b===xf&&(F=n.DEPTH_COMPONENT16),F}function T(D,b){return!0===m(D)||D.isFramebufferTexture&&D.minFilter!==bi&&D.minFilter!==ui?Math.log2(Math.max(b.width,b.height))+1:void 0!==D.mipmaps&&D.mipmaps.length>0?D.mipmaps.length:D.isCompressedTexture&&Array.isArray(D.image)?b.mipmaps.length:1}function E(D){const b=D.target;b.removeEventListener("dispose",E),function R(D){const b=i.get(D);if(void 0===b.__webglInit)return;const F=D.source,Y=h.get(F);if(Y){const se=Y[b.__cacheKey];se.usedTimes--,0===se.usedTimes&&M(D),0===Object.keys(Y).length&&h.delete(F)}i.remove(D)}(b),b.isVideoTexture&&u.delete(b)}function C(D){const b=D.target;b.removeEventListener("dispose",C),function w(D){const b=i.get(D);if(D.depthTexture&&(D.depthTexture.dispose(),i.remove(D.depthTexture)),D.isWebGLCubeRenderTarget)for(let Y=0;Y<6;Y++){if(Array.isArray(b.__webglFramebuffer[Y]))for(let se=0;se<b.__webglFramebuffer[Y].length;se++)n.deleteFramebuffer(b.__webglFramebuffer[Y][se]);else n.deleteFramebuffer(b.__webglFramebuffer[Y]);b.__webglDepthbuffer&&n.deleteRenderbuffer(b.__webglDepthbuffer[Y])}else{if(Array.isArray(b.__webglFramebuffer))for(let Y=0;Y<b.__webglFramebuffer.length;Y++)n.deleteFramebuffer(b.__webglFramebuffer[Y]);else n.deleteFramebuffer(b.__webglFramebuffer);if(b.__webglDepthbuffer&&n.deleteRenderbuffer(b.__webglDepthbuffer),b.__webglMultisampledFramebuffer&&n.deleteFramebuffer(b.__webglMultisampledFramebuffer),b.__webglColorRenderbuffer)for(let Y=0;Y<b.__webglColorRenderbuffer.length;Y++)b.__webglColorRenderbuffer[Y]&&n.deleteRenderbuffer(b.__webglColorRenderbuffer[Y]);b.__webglDepthRenderbuffer&&n.deleteRenderbuffer(b.__webglDepthRenderbuffer)}const F=D.textures;for(let Y=0,se=F.length;Y<se;Y++){const Z=i.get(F[Y]);Z.__webglTexture&&(n.deleteTexture(Z.__webglTexture),o.memory.textures--),i.remove(F[Y])}i.remove(D)}(b)}function M(D){const b=i.get(D);n.deleteTexture(b.__webglTexture),delete h.get(D.source)[b.__cacheKey],o.memory.textures--}let N=0;function K(D,b){const F=i.get(D);if(D.isVideoTexture&&function ve(D){const b=o.render.frame;u.get(D)!==b&&(u.set(D,b),D.update())}(D),!1===D.isRenderTargetTexture&&D.version>0&&F.__version!==D.version){const Y=D.image;if(null===Y)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Y.complete)return void J(F,D,b);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.bindTexture(n.TEXTURE_2D,F.__webglTexture,n.TEXTURE0+b)}const we={[xv]:n.REPEAT,[ns]:n.CLAMP_TO_EDGE,[wv]:n.MIRRORED_REPEAT},Re={[bi]:n.NEAREST,[UO]:n.NEAREST_MIPMAP_NEAREST,[_f]:n.NEAREST_MIPMAP_LINEAR,[ui]:n.LINEAR,[bv]:n.LINEAR_MIPMAP_NEAREST,[ao]:n.LINEAR_MIPMAP_LINEAR},Ve={[jQ]:n.NEVER,[ZQ]:n.ALWAYS,[$Q]:n.LESS,[ZO]:n.LEQUAL,[WQ]:n.EQUAL,[YQ]:n.GEQUAL,[qQ]:n.GREATER,[XQ]:n.NOTEQUAL};function yt(D,b){if(b.type===yr&&!1===e.has("OES_texture_float_linear")&&(b.magFilter===ui||1007===b.magFilter||1005===b.magFilter||b.magFilter===ao||b.minFilter===ui||1007===b.minFilter||1005===b.minFilter||b.minFilter===ao)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(D,n.TEXTURE_WRAP_S,we[b.wrapS]),n.texParameteri(D,n.TEXTURE_WRAP_T,we[b.wrapT]),(D===n.TEXTURE_3D||D===n.TEXTURE_2D_ARRAY)&&n.texParameteri(D,n.TEXTURE_WRAP_R,we[b.wrapR]),n.texParameteri(D,n.TEXTURE_MAG_FILTER,Re[b.magFilter]),n.texParameteri(D,n.TEXTURE_MIN_FILTER,Re[b.minFilter]),b.compareFunction&&(n.texParameteri(D,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(D,n.TEXTURE_COMPARE_FUNC,Ve[b.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){if(b.magFilter===bi||1005!==b.minFilter&&b.minFilter!==ao||b.type===yr&&!1===e.has("OES_texture_float_linear"))return;if(b.anisotropy>1||i.get(b).__currentAnisotropy){const F=e.get("EXT_texture_filter_anisotropic");n.texParameterf(D,F.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.anisotropy,r.getMaxAnisotropy())),i.get(b).__currentAnisotropy=b.anisotropy}}}function Wt(D,b){let F=!1;void 0===D.__webglInit&&(D.__webglInit=!0,b.addEventListener("dispose",E));const Y=b.source;let se=h.get(Y);void 0===se&&(se={},h.set(Y,se));const Z=function j(D){const b=[];return b.push(D.wrapS),b.push(D.wrapT),b.push(D.wrapR||0),b.push(D.magFilter),b.push(D.minFilter),b.push(D.anisotropy),b.push(D.internalFormat),b.push(D.format),b.push(D.type),b.push(D.generateMipmaps),b.push(D.premultiplyAlpha),b.push(D.flipY),b.push(D.unpackAlignment),b.push(D.colorSpace),b.join()}(b);if(Z!==D.__cacheKey){void 0===se[Z]&&(se[Z]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,F=!0),se[Z].usedTimes++;const He=se[D.__cacheKey];void 0!==He&&(se[D.__cacheKey].usedTimes--,0===He.usedTimes&&M(b)),D.__cacheKey=Z,D.__webglTexture=se[Z].texture}return F}function J(D,b,F){let Y=n.TEXTURE_2D;(b.isDataArrayTexture||b.isCompressedArrayTexture)&&(Y=n.TEXTURE_2D_ARRAY),b.isData3DTexture&&(Y=n.TEXTURE_3D);const se=Wt(D,b),Z=b.source;t.bindTexture(Y,D.__webglTexture,n.TEXTURE0+F);const He=i.get(Z);if(Z.version!==He.__version||!0===se){t.activeTexture(n.TEXTURE0+F);const Ee=Ft.getPrimaries(Ft.workingColorSpace),Pe=""===b.colorSpace?null:Ft.getPrimaries(b.colorSpace),At=""===b.colorSpace||Ee===Pe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,b.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,b.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,At);let he=v(b.image,!1,r.maxTextureSize);he=st(b,he);const ke=s.convert(b.format,b.colorSpace),it=s.convert(b.type);let Ue,ut=_(b.internalFormat,ke,it,b.colorSpace,b.isVideoTexture);yt(Y,b);const Lt=b.mipmaps,Tt=!0!==b.isVideoTexture,dn=void 0===He.__version||!0===se,P=Z.dataReady,Se=T(b,he);if(b.isDepthTexture)ut=x(b.format===Cu,b.type),dn&&(Tt?t.texStorage2D(n.TEXTURE_2D,1,ut,he.width,he.height):t.texImage2D(n.TEXTURE_2D,0,ut,he.width,he.height,0,ke,it,null));else if(b.isDataTexture)if(Lt.length>0){Tt&&dn&&t.texStorage2D(n.TEXTURE_2D,Se,ut,Lt[0].width,Lt[0].height);for(let X=0,Q=Lt.length;X<Q;X++)Ue=Lt[X],Tt?P&&t.texSubImage2D(n.TEXTURE_2D,X,0,0,Ue.width,Ue.height,ke,it,Ue.data):t.texImage2D(n.TEXTURE_2D,X,ut,Ue.width,Ue.height,0,ke,it,Ue.data);b.generateMipmaps=!1}else Tt?(dn&&t.texStorage2D(n.TEXTURE_2D,Se,ut,he.width,he.height),P&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,he.width,he.height,ke,it,he.data)):t.texImage2D(n.TEXTURE_2D,0,ut,he.width,he.height,0,ke,it,he.data);else if(b.isCompressedTexture)if(b.isCompressedArrayTexture){Tt&&dn&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Se,ut,Lt[0].width,Lt[0].height,he.depth);for(let X=0,Q=Lt.length;X<Q;X++)if(Ue=Lt[X],b.format!==tr)if(null!==ke)if(Tt){if(P)if(b.layerUpdates.size>0){const Ae=BS(Ue.width,Ue.height,b.format,b.type);for(const De of b.layerUpdates){const Mt=Ue.data.subarray(De*Ae/Ue.data.BYTES_PER_ELEMENT,(De+1)*Ae/Ue.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,X,0,0,De,Ue.width,Ue.height,1,ke,Mt)}b.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,X,0,0,0,Ue.width,Ue.height,he.depth,ke,Ue.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,X,ut,Ue.width,Ue.height,he.depth,0,Ue.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Tt?P&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,X,0,0,0,Ue.width,Ue.height,he.depth,ke,it,Ue.data):t.texImage3D(n.TEXTURE_2D_ARRAY,X,ut,Ue.width,Ue.height,he.depth,0,ke,it,Ue.data)}else{Tt&&dn&&t.texStorage2D(n.TEXTURE_2D,Se,ut,Lt[0].width,Lt[0].height);for(let X=0,Q=Lt.length;X<Q;X++)Ue=Lt[X],b.format!==tr?null!==ke?Tt?P&&t.compressedTexSubImage2D(n.TEXTURE_2D,X,0,0,Ue.width,Ue.height,ke,Ue.data):t.compressedTexImage2D(n.TEXTURE_2D,X,ut,Ue.width,Ue.height,0,Ue.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Tt?P&&t.texSubImage2D(n.TEXTURE_2D,X,0,0,Ue.width,Ue.height,ke,it,Ue.data):t.texImage2D(n.TEXTURE_2D,X,ut,Ue.width,Ue.height,0,ke,it,Ue.data)}else if(b.isDataArrayTexture)if(Tt){if(dn&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Se,ut,he.width,he.height,he.depth),P)if(b.layerUpdates.size>0){const X=BS(he.width,he.height,b.format,b.type);for(const Q of b.layerUpdates){const Ae=he.data.subarray(Q*X/he.data.BYTES_PER_ELEMENT,(Q+1)*X/he.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,Q,he.width,he.height,1,ke,it,Ae)}b.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,he.width,he.height,he.depth,ke,it,he.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,ut,he.width,he.height,he.depth,0,ke,it,he.data);else if(b.isData3DTexture)Tt?(dn&&t.texStorage3D(n.TEXTURE_3D,Se,ut,he.width,he.height,he.depth),P&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,he.width,he.height,he.depth,ke,it,he.data)):t.texImage3D(n.TEXTURE_3D,0,ut,he.width,he.height,he.depth,0,ke,it,he.data);else if(b.isFramebufferTexture){if(dn)if(Tt)t.texStorage2D(n.TEXTURE_2D,Se,ut,he.width,he.height);else{let X=he.width,Q=he.height;for(let Ae=0;Ae<Se;Ae++)t.texImage2D(n.TEXTURE_2D,Ae,ut,X,Q,0,ke,it,null),X>>=1,Q>>=1}}else if(Lt.length>0){if(Tt&&dn){const X=Ce(Lt[0]);t.texStorage2D(n.TEXTURE_2D,Se,ut,X.width,X.height)}for(let X=0,Q=Lt.length;X<Q;X++)Ue=Lt[X],Tt?P&&t.texSubImage2D(n.TEXTURE_2D,X,0,0,ke,it,Ue):t.texImage2D(n.TEXTURE_2D,X,ut,ke,it,Ue);b.generateMipmaps=!1}else if(Tt){if(dn){const X=Ce(he);t.texStorage2D(n.TEXTURE_2D,Se,ut,X.width,X.height)}P&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,ke,it,he)}else t.texImage2D(n.TEXTURE_2D,0,ut,ke,it,he);m(b)&&g(Y),He.__version=Z.version,b.onUpdate&&b.onUpdate(b)}D.__version=b.version}function Ge(D,b,F,Y,se,Z){const He=s.convert(F.format,F.colorSpace),Ee=s.convert(F.type),Pe=_(F.internalFormat,He,Ee,F.colorSpace),At=i.get(b),he=i.get(F);if(he.__renderTarget=b,!At.__hasExternalTextures){const ke=Math.max(1,b.width>>Z),it=Math.max(1,b.height>>Z);se===n.TEXTURE_3D||se===n.TEXTURE_2D_ARRAY?t.texImage3D(se,Z,Pe,ke,it,b.depth,0,He,Ee,null):t.texImage2D(se,Z,Pe,ke,it,0,He,Ee,null)}t.bindFramebuffer(n.FRAMEBUFFER,D),Le(b)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Y,se,he.__webglTexture,0,le(b)):(se===n.TEXTURE_2D||se>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&se<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Y,se,he.__webglTexture,Z),t.bindFramebuffer(n.FRAMEBUFFER,null)}function me(D,b,F){if(n.bindRenderbuffer(n.RENDERBUFFER,D),b.depthBuffer){const Y=b.depthTexture,Z=x(b.stencilBuffer,Y&&Y.isDepthTexture?Y.type:null),He=b.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ee=le(b);Le(b)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ee,Z,b.width,b.height):F?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ee,Z,b.width,b.height):n.renderbufferStorage(n.RENDERBUFFER,Z,b.width,b.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,He,n.RENDERBUFFER,D)}else{const Y=b.textures;for(let se=0;se<Y.length;se++){const Z=Y[se],He=s.convert(Z.format,Z.colorSpace),Ee=s.convert(Z.type),Pe=_(Z.internalFormat,He,Ee,Z.colorSpace),At=le(b);F&&!1===Le(b)?n.renderbufferStorageMultisample(n.RENDERBUFFER,At,Pe,b.width,b.height):Le(b)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,At,Pe,b.width,b.height):n.renderbufferStorage(n.RENDERBUFFER,Pe,b.width,b.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function at(D){const b=i.get(D),F=!0===D.isWebGLCubeRenderTarget;if(b.__boundDepthTexture!==D.depthTexture){const Y=D.depthTexture;if(b.__depthDisposeCallback&&b.__depthDisposeCallback(),Y){const se=()=>{delete b.__boundDepthTexture,delete b.__depthDisposeCallback,Y.removeEventListener("dispose",se)};Y.addEventListener("dispose",se),b.__depthDisposeCallback=se}b.__boundDepthTexture=Y}if(D.depthTexture&&!b.__autoAllocateDepthBuffer){if(F)throw new Error("target.depthTexture not supported in Cube render targets");!function Ye(D,b){if(b&&b.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,D),!b.depthTexture||!b.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Y=i.get(b.depthTexture);Y.__renderTarget=b,(!Y.__webglTexture||b.depthTexture.image.width!==b.width||b.depthTexture.image.height!==b.height)&&(b.depthTexture.image.width=b.width,b.depthTexture.image.height=b.height,b.depthTexture.needsUpdate=!0),K(b.depthTexture,0);const se=Y.__webglTexture,Z=le(b);if(b.depthTexture.format===Tu)Le(b)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,se,0,Z):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,se,0);else{if(b.depthTexture.format!==Cu)throw new Error("Unknown depthTexture format");Le(b)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,se,0,Z):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,se,0)}}(b.__webglFramebuffer,D)}else if(F){b.__webglDepthbuffer=[];for(let Y=0;Y<6;Y++)if(t.bindFramebuffer(n.FRAMEBUFFER,b.__webglFramebuffer[Y]),void 0===b.__webglDepthbuffer[Y])b.__webglDepthbuffer[Y]=n.createRenderbuffer(),me(b.__webglDepthbuffer[Y],D,!1);else{const se=D.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Z=b.__webglDepthbuffer[Y];n.bindRenderbuffer(n.RENDERBUFFER,Z),n.framebufferRenderbuffer(n.FRAMEBUFFER,se,n.RENDERBUFFER,Z)}}else if(t.bindFramebuffer(n.FRAMEBUFFER,b.__webglFramebuffer),void 0===b.__webglDepthbuffer)b.__webglDepthbuffer=n.createRenderbuffer(),me(b.__webglDepthbuffer,D,!1);else{const Y=D.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,se=b.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,se),n.framebufferRenderbuffer(n.FRAMEBUFFER,Y,n.RENDERBUFFER,se)}t.bindFramebuffer(n.FRAMEBUFFER,null)}const pe=[],I=[];function le(D){return Math.min(r.maxSamples,D.samples)}function Le(D){const b=i.get(D);return D.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==b.__useRenderToTexture}function st(D,b){const F=D.colorSpace,Y=D.format,se=D.type;return!0===D.isCompressedTexture||!0===D.isVideoTexture||F!==Iu&&""!==F&&(Ft.getTransfer(F)===nn?(Y!==tr||se!==lo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",F)),b}function Ce(D){return typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement?(c.width=D.naturalWidth||D.width,c.height=D.naturalHeight||D.height):typeof VideoFrame<"u"&&D instanceof VideoFrame?(c.width=D.displayWidth,c.height=D.displayHeight):(c.width=D.width,c.height=D.height),c}this.allocateTextureUnit=function B(){const D=N;return D>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+D+" texture units while this GPU supports only "+r.maxTextures),N+=1,D},this.resetTextureUnits=function G(){N=0},this.setTexture2D=K,this.setTexture2DArray=function $(D,b){const F=i.get(D);D.version>0&&F.__version!==D.version?J(F,D,b):t.bindTexture(n.TEXTURE_2D_ARRAY,F.__webglTexture,n.TEXTURE0+b)},this.setTexture3D=function fe(D,b){const F=i.get(D);D.version>0&&F.__version!==D.version?J(F,D,b):t.bindTexture(n.TEXTURE_3D,F.__webglTexture,n.TEXTURE0+b)},this.setTextureCube=function q(D,b){const F=i.get(D);D.version>0&&F.__version!==D.version?function ge(D,b,F){if(6!==b.image.length)return;const Y=Wt(D,b),se=b.source;t.bindTexture(n.TEXTURE_CUBE_MAP,D.__webglTexture,n.TEXTURE0+F);const Z=i.get(se);if(se.version!==Z.__version||!0===Y){t.activeTexture(n.TEXTURE0+F);const He=Ft.getPrimaries(Ft.workingColorSpace),Ee=""===b.colorSpace?null:Ft.getPrimaries(b.colorSpace),Pe=""===b.colorSpace||He===Ee?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,b.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,b.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Pe);const At=b.isCompressedTexture||b.image[0].isCompressedTexture,he=b.image[0]&&b.image[0].isDataTexture,ke=[];for(let Q=0;Q<6;Q++)ke[Q]=At||he?he?b.image[Q].image:b.image[Q]:v(b.image[Q],!0,r.maxCubemapSize),ke[Q]=st(b,ke[Q]);const it=ke[0],ut=s.convert(b.format,b.colorSpace),Ue=s.convert(b.type),Lt=_(b.internalFormat,ut,Ue,b.colorSpace),Tt=!0!==b.isVideoTexture,dn=void 0===Z.__version||!0===Y,P=se.dataReady;let X,Se=T(b,it);if(yt(n.TEXTURE_CUBE_MAP,b),At){Tt&&dn&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Se,Lt,it.width,it.height);for(let Q=0;Q<6;Q++){X=ke[Q].mipmaps;for(let Ae=0;Ae<X.length;Ae++){const De=X[Ae];b.format!==tr?null!==ut?Tt?P&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Q,Ae,0,0,De.width,De.height,ut,De.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Q,Ae,Lt,De.width,De.height,0,De.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Tt?P&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Q,Ae,0,0,De.width,De.height,ut,Ue,De.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Q,Ae,Lt,De.width,De.height,0,ut,Ue,De.data)}}}else{if(X=b.mipmaps,Tt&&dn){X.length>0&&Se++;const Q=Ce(ke[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Se,Lt,Q.width,Q.height)}for(let Q=0;Q<6;Q++)if(he){Tt?P&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Q,0,0,0,ke[Q].width,ke[Q].height,ut,Ue,ke[Q].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Q,0,Lt,ke[Q].width,ke[Q].height,0,ut,Ue,ke[Q].data);for(let Ae=0;Ae<X.length;Ae++){const Mt=X[Ae].image[Q].image;Tt?P&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Q,Ae+1,0,0,Mt.width,Mt.height,ut,Ue,Mt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Q,Ae+1,Lt,Mt.width,Mt.height,0,ut,Ue,Mt.data)}}else{Tt?P&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Q,0,0,0,ut,Ue,ke[Q]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Q,0,Lt,ut,Ue,ke[Q]);for(let Ae=0;Ae<X.length;Ae++){const De=X[Ae];Tt?P&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Q,Ae+1,0,0,ut,Ue,De.image[Q]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Q,Ae+1,Lt,ut,Ue,De.image[Q])}}}m(b)&&g(n.TEXTURE_CUBE_MAP),Z.__version=se.version,b.onUpdate&&b.onUpdate(b)}D.__version=b.version}(F,D,b):t.bindTexture(n.TEXTURE_CUBE_MAP,F.__webglTexture,n.TEXTURE0+b)},this.rebindTextures=function nt(D,b,F){const Y=i.get(D);void 0!==b&&Ge(Y.__webglFramebuffer,D,D.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),void 0!==F&&at(D)},this.setupRenderTarget=function kt(D){const b=D.texture,F=i.get(D),Y=i.get(b);D.addEventListener("dispose",C);const se=D.textures,Z=!0===D.isWebGLCubeRenderTarget,He=se.length>1;if(He||(void 0===Y.__webglTexture&&(Y.__webglTexture=n.createTexture()),Y.__version=b.version,o.memory.textures++),Z){F.__webglFramebuffer=[];for(let Ee=0;Ee<6;Ee++)if(b.mipmaps&&b.mipmaps.length>0){F.__webglFramebuffer[Ee]=[];for(let Pe=0;Pe<b.mipmaps.length;Pe++)F.__webglFramebuffer[Ee][Pe]=n.createFramebuffer()}else F.__webglFramebuffer[Ee]=n.createFramebuffer()}else{if(b.mipmaps&&b.mipmaps.length>0){F.__webglFramebuffer=[];for(let Ee=0;Ee<b.mipmaps.length;Ee++)F.__webglFramebuffer[Ee]=n.createFramebuffer()}else F.__webglFramebuffer=n.createFramebuffer();if(He)for(let Ee=0,Pe=se.length;Ee<Pe;Ee++){const At=i.get(se[Ee]);void 0===At.__webglTexture&&(At.__webglTexture=n.createTexture(),o.memory.textures++)}if(D.samples>0&&!1===Le(D)){F.__webglMultisampledFramebuffer=n.createFramebuffer(),F.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,F.__webglMultisampledFramebuffer);for(let Ee=0;Ee<se.length;Ee++){const Pe=se[Ee];F.__webglColorRenderbuffer[Ee]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,F.__webglColorRenderbuffer[Ee]);const At=s.convert(Pe.format,Pe.colorSpace),he=s.convert(Pe.type),ke=_(Pe.internalFormat,At,he,Pe.colorSpace,!0===D.isXRRenderTarget),it=le(D);n.renderbufferStorageMultisample(n.RENDERBUFFER,it,ke,D.width,D.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ee,n.RENDERBUFFER,F.__webglColorRenderbuffer[Ee])}n.bindRenderbuffer(n.RENDERBUFFER,null),D.depthBuffer&&(F.__webglDepthRenderbuffer=n.createRenderbuffer(),me(F.__webglDepthRenderbuffer,D,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Z){t.bindTexture(n.TEXTURE_CUBE_MAP,Y.__webglTexture),yt(n.TEXTURE_CUBE_MAP,b);for(let Ee=0;Ee<6;Ee++)if(b.mipmaps&&b.mipmaps.length>0)for(let Pe=0;Pe<b.mipmaps.length;Pe++)Ge(F.__webglFramebuffer[Ee][Pe],D,b,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,Pe);else Ge(F.__webglFramebuffer[Ee],D,b,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ee,0);m(b)&&g(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(He){for(let Ee=0,Pe=se.length;Ee<Pe;Ee++){const At=se[Ee],he=i.get(At);t.bindTexture(n.TEXTURE_2D,he.__webglTexture),yt(n.TEXTURE_2D,At),Ge(F.__webglFramebuffer,D,At,n.COLOR_ATTACHMENT0+Ee,n.TEXTURE_2D,0),m(At)&&g(n.TEXTURE_2D)}t.unbindTexture()}else{let Ee=n.TEXTURE_2D;if((D.isWebGL3DRenderTarget||D.isWebGLArrayRenderTarget)&&(Ee=D.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Ee,Y.__webglTexture),yt(Ee,b),b.mipmaps&&b.mipmaps.length>0)for(let Pe=0;Pe<b.mipmaps.length;Pe++)Ge(F.__webglFramebuffer[Pe],D,b,n.COLOR_ATTACHMENT0,Ee,Pe);else Ge(F.__webglFramebuffer,D,b,n.COLOR_ATTACHMENT0,Ee,0);m(b)&&g(Ee),t.unbindTexture()}D.depthBuffer&&at(D)},this.updateRenderTargetMipmap=function ne(D){const b=D.textures;for(let F=0,Y=b.length;F<Y;F++){const se=b[F];if(m(se)){const Z=y(D),He=i.get(se).__webglTexture;t.bindTexture(Z,He),g(Z),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function je(D){if(D.samples>0)if(!1===Le(D)){const b=D.textures,F=D.width,Y=D.height;let se=n.COLOR_BUFFER_BIT;const Z=D.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,He=i.get(D),Ee=b.length>1;if(Ee)for(let Pe=0;Pe<b.length;Pe++)t.bindFramebuffer(n.FRAMEBUFFER,He.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Pe,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,He.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Pe,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,He.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,He.__webglFramebuffer);for(let Pe=0;Pe<b.length;Pe++){if(D.resolveDepthBuffer&&(D.depthBuffer&&(se|=n.DEPTH_BUFFER_BIT),D.stencilBuffer&&D.resolveStencilBuffer&&(se|=n.STENCIL_BUFFER_BIT)),Ee){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,He.__webglColorRenderbuffer[Pe]);const At=i.get(b[Pe]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,At,0)}n.blitFramebuffer(0,0,F,Y,0,0,F,Y,se,n.NEAREST),!0===l&&(pe.length=0,I.length=0,pe.push(n.COLOR_ATTACHMENT0+Pe),D.depthBuffer&&!1===D.resolveDepthBuffer&&(pe.push(Z),I.push(Z),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,I)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,pe))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Ee)for(let Pe=0;Pe<b.length;Pe++){t.bindFramebuffer(n.FRAMEBUFFER,He.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Pe,n.RENDERBUFFER,He.__webglColorRenderbuffer[Pe]);const At=i.get(b[Pe]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,He.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Pe,n.TEXTURE_2D,At,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,He.__webglMultisampledFramebuffer)}else D.depthBuffer&&!1===D.resolveDepthBuffer&&l&&n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[D.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT])},this.setupDepthRenderbuffer=at,this.setupFrameBufferTexture=Ge,this.useMultisampledRTT=Le}function Aoe(n,e){return{convert:function t(i,r=""){let s;const o=Ft.getTransfer(r);if(i===lo)return n.UNSIGNED_BYTE;if(1017===i)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===i)return n.UNSIGNED_SHORT_5_5_5_1;if(35902===i)return n.UNSIGNED_INT_5_9_9_9_REV;if(1010===i)return n.BYTE;if(1011===i)return n.SHORT;if(i===xf)return n.UNSIGNED_SHORT;if(1013===i)return n.INT;if(i===ua)return n.UNSIGNED_INT;if(i===yr)return n.FLOAT;if(i===wf)return n.HALF_FLOAT;if(1021===i)return n.ALPHA;if(1022===i)return n.RGB;if(i===tr)return n.RGBA;if(1024===i)return n.LUMINANCE;if(1025===i)return n.LUMINANCE_ALPHA;if(i===Tu)return n.DEPTH_COMPONENT;if(i===Cu)return n.DEPTH_STENCIL;if(1028===i)return n.RED;if(1029===i)return n.RED_INTEGER;if(1030===i)return n.RG;if(1031===i)return n.RG_INTEGER;if(1033===i)return n.RGBA_INTEGER;if(i===Ev||i===Sv||i===Tv||i===Cv)if(o===nn){if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===s)return null;if(i===Ev)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===Sv)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===Tv)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===Cv)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(s=e.get("WEBGL_compressed_texture_s3tc"),null===s)return null;if(i===Ev)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===Sv)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Tv)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Cv)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===i||35841===i||35842===i||35843===i){if(s=e.get("WEBGL_compressed_texture_pvrtc"),null===s)return null;if(35840===i)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===i)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===i)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===i)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===i||37492===i||37496===i){if(s=e.get("WEBGL_compressed_texture_etc"),null===s)return null;if(36196===i||37492===i)return o===nn?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(37496===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}if(37808===i||37809===i||37810===i||37811===i||37812===i||37813===i||37814===i||37815===i||37816===i||37817===i||37818===i||37819===i||37820===i||37821===i){if(s=e.get("WEBGL_compressed_texture_astc"),null===s)return null;if(37808===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===i)return o===nn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}if(i===Dv||36494===i||36495===i){if(s=e.get("EXT_texture_compression_bptc"),null===s)return null;if(i===Dv)return o===nn?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===i)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===i)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===i||36284===i||36285===i||36286===i){if(s=e.get("EXT_texture_compression_rgtc"),null===s)return null;if(i===Dv)return s.COMPRESSED_RED_RGTC1_EXT;if(36284===i)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===i)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===i)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return i===Su?n.UNSIGNED_INT_24_8:void 0!==n[i]?n[i]:null}}}const Ioe={type:"move"};class XS{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Uf,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Uf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new A,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new A),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Uf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new A,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new A),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){o=!0;for(const v of e.hand.values()){const m=t.getJointPose(v,i),g=this._getHandJoint(c,v);null!==m&&(g.matrix.fromArray(m.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=m.radius),g.visible=null!==m}const h=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,p=.005;c.inputState.pinching&&h>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));null!==a&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==s&&(r=s),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Ioe)))}return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const i=new Uf;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class Poe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(null===this.texture){const r=new nr;e.properties.get(r).__webglTexture=t.texture,(t.depthNear!==i.depthNear||t.depthFar!==i.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,i=new Rs({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Qn(new $f(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Loe extends co{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,d=null,h=null,f=null,p=null;const v=new Poe,m=t.getContextAttributes();let g=null,y=null;const _=[],x=[],T=new ee;let E=null;const C=new pi;C.viewport=new zt;const R=new pi;R.viewport=new zt;const M=[C,R],w=new pne;let N=null,G=null;function B(J){const ge=x.indexOf(J.inputSource);if(-1===ge)return;const Ge=_[ge];void 0!==Ge&&(Ge.update(J.inputSource,J.frame,c||o),Ge.dispatchEvent({type:J.type,data:J.inputSource}))}function j(){r.removeEventListener("select",B),r.removeEventListener("selectstart",B),r.removeEventListener("selectend",B),r.removeEventListener("squeeze",B),r.removeEventListener("squeezestart",B),r.removeEventListener("squeezeend",B),r.removeEventListener("end",j),r.removeEventListener("inputsourceschange",K);for(let J=0;J<_.length;J++){const ge=x[J];null!==ge&&(x[J]=null,_[J].disconnect(ge))}N=null,G=null,v.reset(),e.setRenderTarget(g),f=null,h=null,d=null,r=null,y=null,Wt.stop(),i.isPresenting=!1,e.setPixelRatio(E),e.setSize(T.width,T.height,!1),i.dispatchEvent({type:"sessionend"})}function K(J){for(let ge=0;ge<J.removed.length;ge++){const Ge=J.removed[ge],me=x.indexOf(Ge);me>=0&&(x[me]=null,_[me].disconnect(Ge))}for(let ge=0;ge<J.added.length;ge++){const Ge=J.added[ge];let me=x.indexOf(Ge);if(-1===me){for(let at=0;at<_.length;at++){if(at>=x.length){x.push(Ge),me=at;break}if(null===x[at]){x[at]=Ge,me=at;break}}if(-1===me)break}const Ye=_[me];Ye&&Ye.connect(Ge)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(J){let ge=_[J];return void 0===ge&&(ge=new XS,_[J]=ge),ge.getTargetRaySpace()},this.getControllerGrip=function(J){let ge=_[J];return void 0===ge&&(ge=new XS,_[J]=ge),ge.getGripSpace()},this.getHand=function(J){let ge=_[J];return void 0===ge&&(ge=new XS,_[J]=ge),ge.getHandSpace()},this.setFramebufferScaleFactor=function(J){s=J,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(J){a=J,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(J){c=J},this.getBaseLayer=function(){return null!==h?h:f},this.getBinding=function(){return d},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=function(){var J=Hn(function*(ge){if(r=ge,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",B),r.addEventListener("selectstart",B),r.addEventListener("selectend",B),r.addEventListener("squeeze",B),r.addEventListener("squeezestart",B),r.addEventListener("squeezeend",B),r.addEventListener("end",j),r.addEventListener("inputsourceschange",K),!0!==m.xrCompatible&&(yield t.makeXRCompatible()),E=e.getPixelRatio(),e.getSize(T),void 0!==r.enabledFeatures&&r.enabledFeatures.includes("layers")){let me=null,Ye=null,at=null;m.depth&&(at=m.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,me=m.stencil?Cu:Tu,Ye=m.stencil?Su:ua);const nt={colorFormat:t.RGBA8,depthFormat:at,scaleFactor:s};d=new XRWebGLBinding(r,t),h=d.createProjectionLayer(nt),r.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),y=new ho(h.textureWidth,h.textureHeight,{format:tr,type:lo,depthTexture:new jF(h.textureWidth,h.textureHeight,Ye,void 0,void 0,void 0,void 0,void 0,void 0,me),stencilBuffer:m.stencil,colorSpace:e.outputColorSpace,samples:m.antialias?4:0,resolveDepthBuffer:!1===h.ignoreDepthValues})}else f=new XRWebGLLayer(r,t,{antialias:m.antialias,alpha:!0,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:f}),e.setPixelRatio(1),e.setSize(f.framebufferWidth,f.framebufferHeight,!1),y=new ho(f.framebufferWidth,f.framebufferHeight,{format:tr,type:lo,colorSpace:e.outputColorSpace,stencilBuffer:m.stencil});y.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=yield r.requestReferenceSpace(a),Wt.setContext(r),Wt.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(ge){return J.apply(this,arguments)}}(),this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode},this.getDepthTexture=function(){return v.getDepthTexture()};const $=new A,fe=new A;function we(J,ge){null===ge?J.matrixWorld.copy(J.matrix):J.matrixWorld.multiplyMatrices(ge.matrixWorld,J.matrix),J.matrixWorldInverse.copy(J.matrixWorld).invert()}this.updateCamera=function(J){if(null===r)return;let ge=J.near,Ge=J.far;null!==v.texture&&(v.depthNear>0&&(ge=v.depthNear),v.depthFar>0&&(Ge=v.depthFar)),w.near=R.near=C.near=ge,w.far=R.far=C.far=Ge,(N!==w.near||G!==w.far)&&(r.updateRenderState({depthNear:w.near,depthFar:w.far}),N=w.near,G=w.far),C.layers.mask=2|J.layers.mask,R.layers.mask=4|J.layers.mask,w.layers.mask=C.layers.mask|R.layers.mask;const me=J.parent,Ye=w.cameras;we(w,me);for(let at=0;at<Ye.length;at++)we(Ye[at],me);2===Ye.length?function q(J,ge,Ge){$.setFromMatrixPosition(ge.matrixWorld),fe.setFromMatrixPosition(Ge.matrixWorld);const me=$.distanceTo(fe),Ye=ge.projectionMatrix.elements,at=Ge.projectionMatrix.elements,nt=Ye[14]/(Ye[10]-1),kt=Ye[14]/(Ye[10]+1),ne=(Ye[9]+1)/Ye[5],pe=(Ye[9]-1)/Ye[5],I=(Ye[8]-1)/Ye[0],je=(at[8]+1)/at[0],le=nt*I,Le=nt*je,ve=me/(-I+je),st=ve*-I;if(ge.matrixWorld.decompose(J.position,J.quaternion,J.scale),J.translateX(st),J.translateZ(ve),J.matrixWorld.compose(J.position,J.quaternion,J.scale),J.matrixWorldInverse.copy(J.matrixWorld).invert(),-1===Ye[10])J.projectionMatrix.copy(ge.projectionMatrix),J.projectionMatrixInverse.copy(ge.projectionMatrixInverse);else{const Ce=nt+ve,D=kt+ve;J.projectionMatrix.makePerspective(le-st,Le+(me-st),ne*kt/D*Ce,pe*kt/D*Ce,Ce,D),J.projectionMatrixInverse.copy(J.projectionMatrix).invert()}}(w,C,R):w.projectionMatrix.copy(C.projectionMatrix),function Re(J,ge,Ge){null===Ge?J.matrix.copy(ge.matrixWorld):(J.matrix.copy(Ge.matrixWorld),J.matrix.invert(),J.matrix.multiply(ge.matrixWorld)),J.matrix.decompose(J.position,J.quaternion,J.scale),J.updateMatrixWorld(!0),J.projectionMatrix.copy(ge.projectionMatrix),J.projectionMatrixInverse.copy(ge.projectionMatrixInverse),J.isPerspectiveCamera&&(J.fov=2*Nu*Math.atan(1/J.projectionMatrix.elements[5]),J.zoom=1)}(J,w,me)},this.getCamera=function(){return w},this.getFoveation=function(){if(null!==h||null!==f)return l},this.setFoveation=function(J){l=J,null!==h&&(h.fixedFoveation=J),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=J)},this.hasDepthSensing=function(){return null!==v.texture},this.getDepthSensingMesh=function(){return v.getMesh(w)};let Ve=null;const Wt=new Uk;Wt.setAnimationLoop(function yt(J,ge){if(u=ge.getViewerPose(c||o),p=ge,null!==u){const Ge=u.views;null!==f&&(e.setRenderTargetFramebuffer(y,f.framebuffer),e.setRenderTarget(y));let me=!1;Ge.length!==w.cameras.length&&(w.cameras.length=0,me=!0);for(let at=0;at<Ge.length;at++){const nt=Ge[at];let kt=null;if(null!==f)kt=f.getViewport(nt);else{const pe=d.getViewSubImage(h,nt);kt=pe.viewport,0===at&&(e.setRenderTargetTextures(y,pe.colorTexture,h.ignoreDepthValues?void 0:pe.depthStencilTexture),e.setRenderTarget(y))}let ne=M[at];void 0===ne&&(ne=new pi,ne.layers.enable(at),ne.viewport=new zt,M[at]=ne),ne.matrix.fromArray(nt.transform.matrix),ne.matrix.decompose(ne.position,ne.quaternion,ne.scale),ne.projectionMatrix.fromArray(nt.projectionMatrix),ne.projectionMatrixInverse.copy(ne.projectionMatrix).invert(),ne.viewport.set(kt.x,kt.y,kt.width,kt.height),0===at&&(w.matrix.copy(ne.matrix),w.matrix.decompose(w.position,w.quaternion,w.scale)),!0===me&&w.cameras.push(ne)}const Ye=r.enabledFeatures;if(Ye&&Ye.includes("depth-sensing")){const at=d.getDepthInformation(Ge[0]);at&&at.isValid&&at.texture&&v.init(e,at,r.renderState)}}for(let Ge=0;Ge<_.length;Ge++){const me=x[Ge],Ye=_[Ge];null!==me&&void 0!==Ye&&Ye.update(me,ge,c||o)}Ve&&Ve(J,ge),ge.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:ge}),p=null}),this.setAnimationLoop=function(J){Ve=J},this.dispose=function(){}}}const jl=new go,Ooe=new ot;function Foe(n,e){function t(m,g){!0===m.matrixAutoUpdate&&m.updateMatrix(),g.value.copy(m.matrix)}function s(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map,t(g.map,m.mapTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,t(g.alphaMap,m.alphaMapTransform)),g.bumpMap&&(m.bumpMap.value=g.bumpMap,t(g.bumpMap,m.bumpMapTransform),m.bumpScale.value=g.bumpScale,1===g.side&&(m.bumpScale.value*=-1)),g.normalMap&&(m.normalMap.value=g.normalMap,t(g.normalMap,m.normalMapTransform),m.normalScale.value.copy(g.normalScale),1===g.side&&m.normalScale.value.negate()),g.displacementMap&&(m.displacementMap.value=g.displacementMap,t(g.displacementMap,m.displacementMapTransform),m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap,t(g.emissiveMap,m.emissiveMapTransform)),g.specularMap&&(m.specularMap.value=g.specularMap,t(g.specularMap,m.specularMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);const y=e.get(g),_=y.envMap,x=y.envMapRotation;_&&(m.envMap.value=_,jl.copy(x),jl.x*=-1,jl.y*=-1,jl.z*=-1,_.isCubeTexture&&!1===_.isRenderTargetTexture&&(jl.y*=-1,jl.z*=-1),m.envMapRotation.value.setFromMatrix4(Ooe.makeRotationFromEuler(jl)),m.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap&&(m.lightMap.value=g.lightMap,m.lightMapIntensity.value=g.lightMapIntensity,t(g.lightMap,m.lightMapTransform)),g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity,t(g.aoMap,m.aoMapTransform))}return{refreshFogUniforms:function i(m,g){g.color.getRGB(m.fogColor.value,yF(n)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)},refreshMaterialUniforms:function r(m,g,y,_,x){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(m,g):g.isMeshToonMaterial?(s(m,g),function d(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}(m,g)):g.isMeshPhongMaterial?(s(m,g),function u(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}(m,g)):g.isMeshStandardMaterial?(s(m,g),function h(m,g){m.metalness.value=g.metalness,g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap,t(g.metalnessMap,m.metalnessMapTransform)),m.roughness.value=g.roughness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap,t(g.roughnessMap,m.roughnessMapTransform)),g.envMap&&(m.envMapIntensity.value=g.envMapIntensity)}(m,g),g.isMeshPhysicalMaterial&&function f(m,g,y){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap,t(g.sheenColorMap,m.sheenColorMapTransform)),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap,t(g.sheenRoughnessMap,m.sheenRoughnessMapTransform))),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap,t(g.clearcoatMap,m.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,t(g.clearcoatRoughnessMap,m.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(m.clearcoatNormalMap.value=g.clearcoatNormalMap,t(g.clearcoatNormalMap,m.clearcoatNormalMapTransform),m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),1===g.side&&m.clearcoatNormalScale.value.negate())),g.dispersion>0&&(m.dispersion.value=g.dispersion),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap,t(g.iridescenceMap,m.iridescenceMapTransform)),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap,t(g.iridescenceThicknessMap,m.iridescenceThicknessMapTransform))),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=y.texture,m.transmissionSamplerSize.value.set(y.width,y.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap,t(g.transmissionMap,m.transmissionMapTransform)),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap,t(g.thicknessMap,m.thicknessMapTransform)),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(m.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(m.anisotropyMap.value=g.anisotropyMap,t(g.anisotropyMap,m.anisotropyMapTransform))),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap,t(g.specularColorMap,m.specularColorMapTransform)),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap,t(g.specularIntensityMap,m.specularIntensityMapTransform))}(m,g,x)):g.isMeshMatcapMaterial?(s(m,g),function p(m,g){g.matcap&&(m.matcap.value=g.matcap)}(m,g)):g.isMeshDepthMaterial?s(m,g):g.isMeshDistanceMaterial?(s(m,g),function v(m,g){const y=e.get(g).light;m.referencePosition.value.setFromMatrixPosition(y.matrixWorld),m.nearDistance.value=y.shadow.camera.near,m.farDistance.value=y.shadow.camera.far}(m,g)):g.isMeshNormalMaterial?s(m,g):g.isLineBasicMaterial?(function o(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,g.map&&(m.map.value=g.map,t(g.map,m.mapTransform))}(m,g),g.isLineDashedMaterial&&function a(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}(m,g)):g.isPointsMaterial?function l(m,g,y,_){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*y,m.scale.value=.5*_,g.map&&(m.map.value=g.map,t(g.map,m.uvTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,t(g.alphaMap,m.alphaMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest)}(m,g,y,_):g.isSpriteMaterial?function c(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map,t(g.map,m.mapTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,t(g.alphaMap,m.alphaMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest)}(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function koe(n,e,t,i){let r={},s={},o=[];const a=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function f(y,_,x,T){const E=y.value,C=_+"_"+x;if(void 0===T[C])return T[C]="number"==typeof E||"boolean"==typeof E?E:E.clone(),!0;{const R=T[C];if("number"==typeof E||"boolean"==typeof E){if(R!==E)return T[C]=E,!0}else if(!1===R.equals(E))return R.copy(E),!0}return!1}function v(y){const _={boundary:0,storage:0};return"number"==typeof y||"boolean"==typeof y?(_.boundary=4,_.storage=4):y.isVector2?(_.boundary=8,_.storage=8):y.isVector3||y.isColor?(_.boundary=16,_.storage=12):y.isVector4?(_.boundary=16,_.storage=16):y.isMatrix3?(_.boundary=48,_.storage=48):y.isMatrix4?(_.boundary=64,_.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),_}function m(y){const _=y.target;_.removeEventListener("dispose",m);const x=o.indexOf(_.__bindingPointIndex);o.splice(x,1),n.deleteBuffer(r[_.id]),delete r[_.id],delete s[_.id]}return{bind:function l(y,_){i.uniformBlockBinding(y,_.program)},update:function c(y,_){let x=r[y.id];void 0===x&&(function p(y){const _=y.uniforms;let x=0;for(let C=0,R=_.length;C<R;C++){const M=Array.isArray(_[C])?_[C]:[_[C]];for(let w=0,N=M.length;w<N;w++){const G=M[w],B=Array.isArray(G.value)?G.value:[G.value];for(let j=0,K=B.length;j<K;j++){const fe=v(B[j]),q=x%16,we=q%fe.boundary,Re=q+we;x+=we,0!==Re&&16-Re<fe.storage&&(x+=16-Re),G.__data=new Float32Array(fe.storage/Float32Array.BYTES_PER_ELEMENT),G.__offset=x,x+=fe.storage}}}const E=x%16;E>0&&(x+=16-E),y.__size=x,y.__cache={}}(y),x=function u(y){const _=function d(){for(let y=0;y<a;y++)if(-1===o.indexOf(y))return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();y.__bindingPointIndex=_;const x=n.createBuffer(),T=y.__size,E=y.usage;return n.bindBuffer(n.UNIFORM_BUFFER,x),n.bufferData(n.UNIFORM_BUFFER,T,E),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,_,x),x}(y),r[y.id]=x,y.addEventListener("dispose",m)),i.updateUBOMapping(y,_.program);const E=e.render.frame;s[y.id]!==E&&(function h(y){const x=y.uniforms,T=y.__cache;n.bindBuffer(n.UNIFORM_BUFFER,r[y.id]);for(let E=0,C=x.length;E<C;E++){const R=Array.isArray(x[E])?x[E]:[x[E]];for(let M=0,w=R.length;M<w;M++){const N=R[M];if(!0===f(N,E,M,T)){const G=N.__offset,B=Array.isArray(N.value)?N.value:[N.value];let j=0;for(let K=0;K<B.length;K++){const $=B[K],fe=v($);"number"==typeof $||"boolean"==typeof $?(N.__data[0]=$,n.bufferSubData(n.UNIFORM_BUFFER,G+j,N.__data)):$.isMatrix3?(N.__data[0]=$.elements[0],N.__data[1]=$.elements[1],N.__data[2]=$.elements[2],N.__data[3]=0,N.__data[4]=$.elements[3],N.__data[5]=$.elements[4],N.__data[6]=$.elements[5],N.__data[7]=0,N.__data[8]=$.elements[6],N.__data[9]=$.elements[7],N.__data[10]=$.elements[8],N.__data[11]=0):($.toArray(N.__data,j),j+=fe.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,G,N.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}(y),s[y.id]=E)},dispose:function g(){for(const y in r)n.deleteBuffer(r[y]);o=[],r={},s={}}}}class Uoe{constructor(e={}){const{canvas:t=pee(),context:i=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1,reverseDepthBuffer:h=!1}=e;let f;if(this.isWebGLRenderer=!0,null!==i){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");f=i.getContextAttributes().alpha}else f=o;const p=new Uint32Array(4),v=new Int32Array(4);let m=null,g=null;const y=[],_=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=_r,this.toneMapping=0,this.toneMappingExposure=1;const x=this;let T=!1,E=0,C=0,R=null,M=-1,w=null;const N=new zt,G=new zt;let B=null;const j=new Ie(0);let K=0,$=t.width,fe=t.height,q=1,we=null,Re=null;const Ve=new zt(0,0,$,fe),yt=new zt(0,0,$,fe);let Wt=!1;const J=new sy;let ge=!1,Ge=!1;this.transmissionResolutionScale=1;const me=new ot,Ye=new ot,at=new A,nt=new zt,kt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ne=!1;function pe(){return null===R?q:1}let le,Le,ve,st,Ce,D,b,F,Y,se,Z,He,Ee,Pe,At,he,ke,it,ut,Ue,Lt,Tt,dn,P,I=i;function je(S,L){return t.getContext(S,L)}try{const S={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r172"),t.addEventListener("webglcontextlost",Q,!1),t.addEventListener("webglcontextrestored",Ae,!1),t.addEventListener("webglcontextcreationerror",De,!1),null===I){const L="webgl2";if(I=je(L,S),null===I)throw je(L)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(S){throw console.error("THREE.WebGLRenderer: "+S.message),S}function Se(){le=new qre(I),le.init(),Tt=new Aoe(I,le),Le=new zre(I,le,e,Tt),ve=new Coe(I,le),Le.reverseDepthBuffer&&h&&ve.buffers.depth.setReversed(!0),st=new Zre(I),Ce=new poe,D=new Doe(I,le,ve,Ce,Le,Tt,st),b=new Gre(x),F=new Wre(x),Y=new kne(I),dn=new Bre(I,Y),se=new Xre(I,Y,st,dn),Z=new Kre(I,se,Y,st),ut=new Jre(I,Le,D),he=new Hre(Ce),He=new foe(x,b,F,le,Le,dn,he),Ee=new Foe(x,Ce),Pe=new moe,At=new boe(le),it=new Ure(x,b,F,ve,Z,f,l),ke=new Soe(x,Z,Le),P=new koe(I,st,Le,ve),Ue=new Vre(I,le,st),Lt=new Yre(I,le,st),st.programs=He.programs,x.capabilities=Le,x.extensions=le,x.properties=Ce,x.renderLists=Pe,x.shadowMap=ke,x.state=ve,x.info=st}Se();const X=new Loe(x,I);function Q(S){S.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),T=!0}function Ae(){console.log("THREE.WebGLRenderer: Context Restored."),T=!1;const S=st.autoReset,L=ke.enabled,V=ke.autoUpdate,z=ke.needsUpdate,O=ke.type;Se(),st.autoReset=S,ke.enabled=L,ke.autoUpdate=V,ke.needsUpdate=z,ke.type=O}function De(S){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",S.statusMessage)}function Mt(S){const L=S.target;L.removeEventListener("dispose",Mt),function In(S){(function Ti(S){const L=Ce.get(S).programs;void 0!==L&&(L.forEach(function(V){He.releaseProgram(V)}),S.isShaderMaterial&&He.releaseShaderCache(S))})(S),Ce.remove(S)}(L)}function Zt(S,L,V){!0===S.transparent&&2===S.side&&!1===S.forceSinglePass?(S.side=1,S.needsUpdate=!0,$y(S,L,V),S.side=0,S.needsUpdate=!0,$y(S,L,V),S.side=2):$y(S,L,V)}this.xr=X,this.getContext=function(){return I},this.getContextAttributes=function(){return I.getContextAttributes()},this.forceContextLoss=function(){const S=le.get("WEBGL_lose_context");S&&S.loseContext()},this.forceContextRestore=function(){const S=le.get("WEBGL_lose_context");S&&S.restoreContext()},this.getPixelRatio=function(){return q},this.setPixelRatio=function(S){void 0!==S&&(q=S,this.setSize($,fe,!1))},this.getSize=function(S){return S.set($,fe)},this.setSize=function(S,L,V=!0){X.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):($=S,fe=L,t.width=Math.floor(S*q),t.height=Math.floor(L*q),!0===V&&(t.style.width=S+"px",t.style.height=L+"px"),this.setViewport(0,0,S,L))},this.getDrawingBufferSize=function(S){return S.set($*q,fe*q).floor()},this.setDrawingBufferSize=function(S,L,V){$=S,fe=L,q=V,t.width=Math.floor(S*V),t.height=Math.floor(L*V),this.setViewport(0,0,S,L)},this.getCurrentViewport=function(S){return S.copy(N)},this.getViewport=function(S){return S.copy(Ve)},this.setViewport=function(S,L,V,z){S.isVector4?Ve.set(S.x,S.y,S.z,S.w):Ve.set(S,L,V,z),ve.viewport(N.copy(Ve).multiplyScalar(q).round())},this.getScissor=function(S){return S.copy(yt)},this.setScissor=function(S,L,V,z){S.isVector4?yt.set(S.x,S.y,S.z,S.w):yt.set(S,L,V,z),ve.scissor(G.copy(yt).multiplyScalar(q).round())},this.getScissorTest=function(){return Wt},this.setScissorTest=function(S){ve.setScissorTest(Wt=S)},this.setOpaqueSort=function(S){we=S},this.setTransparentSort=function(S){Re=S},this.getClearColor=function(S){return S.copy(it.getClearColor())},this.setClearColor=function(){it.setClearColor.apply(it,arguments)},this.getClearAlpha=function(){return it.getClearAlpha()},this.setClearAlpha=function(){it.setClearAlpha.apply(it,arguments)},this.clear=function(S=!0,L=!0,V=!0){let z=0;if(S){let O=!1;if(null!==R){const ce=R.texture.format;O=1033===ce||1031===ce||1029===ce}if(O){const ce=R.texture.type,Me=ce===lo||ce===ua||ce===xf||ce===Su||1017===ce||1018===ce,Fe=it.getClearColor(),Oe=it.getClearAlpha(),dt=Fe.r,pt=Fe.g,Je=Fe.b;Me?(p[0]=dt,p[1]=pt,p[2]=Je,p[3]=Oe,I.clearBufferuiv(I.COLOR,0,p)):(v[0]=dt,v[1]=pt,v[2]=Je,v[3]=Oe,I.clearBufferiv(I.COLOR,0,v))}else z|=I.COLOR_BUFFER_BIT}L&&(z|=I.DEPTH_BUFFER_BIT),V&&(z|=I.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),I.clear(z)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Q,!1),t.removeEventListener("webglcontextrestored",Ae,!1),t.removeEventListener("webglcontextcreationerror",De,!1),it.dispose(),Pe.dispose(),At.dispose(),Ce.dispose(),b.dispose(),F.dispose(),Z.dispose(),dn.dispose(),P.dispose(),He.dispose(),X.dispose(),X.removeEventListener("sessionstart",f3),X.removeEventListener("sessionend",p3),$l.stop()},this.renderBufferDirect=function(S,L,V,z,O,ce){null===L&&(L=kt);const Me=O.isMesh&&O.matrixWorld.determinant()<0,Fe=function Hoe(S,L,V,z,O){!0!==L.isScene&&(L=kt),D.resetTextureUnits();const ce=L.fog,Fe=null===R?x.outputColorSpace:!0===R.isXRRenderTarget?R.texture.colorSpace:Iu,Oe=(z.isMeshStandardMaterial?F:b).get(z.envMap||(z.isMeshStandardMaterial?L.environment:null)),dt=!0===z.vertexColors&&!!V.attributes.color&&4===V.attributes.color.itemSize,pt=!!V.attributes.tangent&&(!!z.normalMap||z.anisotropy>0),Je=!!V.morphAttributes.position,Nt=!!V.morphAttributes.normal,Jt=!!V.morphAttributes.color;let bn=0;z.toneMapped&&(null===R||!0===R.isXRRenderTarget)&&(bn=x.toneMapping);const Rn=V.morphAttributes.position||V.morphAttributes.normal||V.morphAttributes.color,Ht=void 0!==Rn?Rn.length:0,Ke=Ce.get(z),gi=g.state.lights;!0!==ge||!0!==Ge&&S===w||he.setState(z,S,S===w&&z.id===M);let qt=!1;z.version===Ke.__version?(Ke.needsLights&&Ke.lightsStateVersion!==gi.state.version||Ke.outputColorSpace!==Fe||O.isBatchedMesh&&!1===Ke.batching||!O.isBatchedMesh&&!0===Ke.batching||O.isBatchedMesh&&!0===Ke.batchingColor&&null===O.colorTexture||O.isBatchedMesh&&!1===Ke.batchingColor&&null!==O.colorTexture||O.isInstancedMesh&&!1===Ke.instancing||!O.isInstancedMesh&&!0===Ke.instancing||O.isSkinnedMesh&&!1===Ke.skinning||!O.isSkinnedMesh&&!0===Ke.skinning||O.isInstancedMesh&&!0===Ke.instancingColor&&null===O.instanceColor||O.isInstancedMesh&&!1===Ke.instancingColor&&null!==O.instanceColor||O.isInstancedMesh&&!0===Ke.instancingMorph&&null===O.morphTexture||O.isInstancedMesh&&!1===Ke.instancingMorph&&null!==O.morphTexture||Ke.envMap!==Oe||!0===z.fog&&Ke.fog!==ce||void 0!==Ke.numClippingPlanes&&(Ke.numClippingPlanes!==he.numPlanes||Ke.numIntersection!==he.numIntersection)||Ke.vertexAlphas!==dt||Ke.vertexTangents!==pt||Ke.morphTargets!==Je||Ke.morphNormals!==Nt||Ke.morphColors!==Jt||Ke.toneMapping!==bn||Ke.morphTargetsCount!==Ht)&&(qt=!0):(qt=!0,Ke.__version=z.version);let as=Ke.currentProgram;!0===qt&&(as=$y(z,L,O));let ud=!1,Sr=!1,Xf=!1;const vn=as.getUniforms(),Hr=Ke.uniforms;if(ve.useProgram(as.program)&&(ud=!0,Sr=!0,Xf=!0),z.id!==M&&(M=z.id,Sr=!0),ud||w!==S){ve.buffers.depth.getReversed()?(me.copy(S.projectionMatrix),function mee(n){const e=n.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}(me),function vee(n){const e=n.elements;-1===e[11]?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=1-e[14])}(me),vn.setValue(I,"projectionMatrix",me)):vn.setValue(I,"projectionMatrix",S.projectionMatrix),vn.setValue(I,"viewMatrix",S.matrixWorldInverse);const ar=vn.map.cameraPosition;void 0!==ar&&ar.setValue(I,at.setFromMatrixPosition(S.matrixWorld)),Le.logarithmicDepthBuffer&&vn.setValue(I,"logDepthBufFC",2/(Math.log(S.far+1)/Math.LN2)),(z.isMeshPhongMaterial||z.isMeshToonMaterial||z.isMeshLambertMaterial||z.isMeshBasicMaterial||z.isMeshStandardMaterial||z.isShaderMaterial)&&vn.setValue(I,"isOrthographic",!0===S.isOrthographicCamera),w!==S&&(w=S,Sr=!0,Xf=!0)}if(O.isSkinnedMesh){vn.setOptional(I,O,"bindMatrix"),vn.setOptional(I,O,"bindMatrixInverse");const Hi=O.skeleton;Hi&&(null===Hi.boneTexture&&Hi.computeBoneTexture(),vn.setValue(I,"boneTexture",Hi.boneTexture,D))}O.isBatchedMesh&&(vn.setOptional(I,O,"batchingTexture"),vn.setValue(I,"batchingTexture",O._matricesTexture,D),vn.setOptional(I,O,"batchingIdTexture"),vn.setValue(I,"batchingIdTexture",O._indirectTexture,D),vn.setOptional(I,O,"batchingColorTexture"),null!==O._colorsTexture&&vn.setValue(I,"batchingColorTexture",O._colorsTexture,D));const Gr=V.morphAttributes;if((void 0!==Gr.position||void 0!==Gr.normal||void 0!==Gr.color)&&ut.update(O,V,as),(Sr||Ke.receiveShadow!==O.receiveShadow)&&(Ke.receiveShadow=O.receiveShadow,vn.setValue(I,"receiveShadow",O.receiveShadow)),z.isMeshGouraudMaterial&&null!==z.envMap&&(Hr.envMap.value=Oe,Hr.flipEnvMap.value=Oe.isCubeTexture&&!1===Oe.isRenderTargetTexture?-1:1),z.isMeshStandardMaterial&&null===z.envMap&&null!==L.environment&&(Hr.envMapIntensity.value=L.environmentIntensity),Sr&&(vn.setValue(I,"toneMappingExposure",x.toneMappingExposure),Ke.needsLights&&function Goe(S,L){S.ambientLightColor.needsUpdate=L,S.lightProbe.needsUpdate=L,S.directionalLights.needsUpdate=L,S.directionalLightShadows.needsUpdate=L,S.pointLights.needsUpdate=L,S.pointLightShadows.needsUpdate=L,S.spotLights.needsUpdate=L,S.spotLightShadows.needsUpdate=L,S.rectAreaLights.needsUpdate=L,S.hemisphereLights.needsUpdate=L}(Hr,Xf),ce&&!0===z.fog&&Ee.refreshFogUniforms(Hr,ce),Ee.refreshMaterialUniforms(Hr,z,q,fe,g.state.transmissionRenderTarget[S.id]),Hy.upload(I,y3(Ke),Hr,D)),z.isShaderMaterial&&!0===z.uniformsNeedUpdate&&(Hy.upload(I,y3(Ke),Hr,D),z.uniformsNeedUpdate=!1),z.isSpriteMaterial&&vn.setValue(I,"center",O.center),vn.setValue(I,"modelViewMatrix",O.modelViewMatrix),vn.setValue(I,"normalMatrix",O.normalMatrix),vn.setValue(I,"modelMatrix",O.matrixWorld),z.isShaderMaterial||z.isRawShaderMaterial){const Hi=z.uniformsGroups;for(let ar=0,ZS=Hi.length;ar<ZS;ar++){const Wl=Hi[ar];P.update(Wl,as),P.bind(Wl,as)}}return as}(S,L,V,z,O);ve.setMaterial(z,Me);let Oe=V.index,dt=1;if(!0===z.wireframe){if(Oe=se.getWireframeAttribute(V),void 0===Oe)return;dt=2}const pt=V.drawRange,Je=V.attributes.position;let Nt=pt.start*dt,Jt=(pt.start+pt.count)*dt;null!==ce&&(Nt=Math.max(Nt,ce.start*dt),Jt=Math.min(Jt,(ce.start+ce.count)*dt)),null!==Oe?(Nt=Math.max(Nt,0),Jt=Math.min(Jt,Oe.count)):null!=Je&&(Nt=Math.max(Nt,0),Jt=Math.min(Jt,Je.count));const bn=Jt-Nt;if(bn<0||bn===1/0)return;dn.setup(O,z,Fe,V,Oe);let Rn,Ht=Ue;if(null!==Oe&&(Rn=Y.get(Oe),Ht=Lt,Ht.setIndex(Rn)),O.isMesh)!0===z.wireframe?(ve.setLineWidth(z.wireframeLinewidth*pe()),Ht.setMode(I.LINES)):Ht.setMode(I.TRIANGLES);else if(O.isLine){let Ke=z.linewidth;void 0===Ke&&(Ke=1),ve.setLineWidth(Ke*pe()),Ht.setMode(O.isLineSegments?I.LINES:O.isLineLoop?I.LINE_LOOP:I.LINE_STRIP)}else O.isPoints?Ht.setMode(I.POINTS):O.isSprite&&Ht.setMode(I.TRIANGLES);if(O.isBatchedMesh)if(null!==O._multiDrawInstances)Ht.renderMultiDrawInstances(O._multiDrawStarts,O._multiDrawCounts,O._multiDrawCount,O._multiDrawInstances);else if(le.get("WEBGL_multi_draw"))Ht.renderMultiDraw(O._multiDrawStarts,O._multiDrawCounts,O._multiDrawCount);else{const Ke=O._multiDrawStarts,gi=O._multiDrawCounts,qt=O._multiDrawCount,as=Oe?Y.get(Oe).bytesPerElement:1,ud=Ce.get(z).currentProgram.getUniforms();for(let Sr=0;Sr<qt;Sr++)ud.setValue(I,"_gl_DrawID",Sr),Ht.render(Ke[Sr]/as,gi[Sr])}else if(O.isInstancedMesh)Ht.renderInstances(Nt,bn,O.count);else if(V.isInstancedBufferGeometry){const gi=Math.min(V.instanceCount,void 0!==V._maxInstanceCount?V._maxInstanceCount:1/0);Ht.renderInstances(Nt,bn,gi)}else Ht.render(Nt,bn)},this.compile=function(S,L,V=null){null===V&&(V=S),g=At.get(V),g.init(L),_.push(g),V.traverseVisible(function(O){O.isLight&&O.layers.test(L.layers)&&(g.pushLight(O),O.castShadow&&g.pushShadow(O))}),S!==V&&S.traverseVisible(function(O){O.isLight&&O.layers.test(L.layers)&&(g.pushLight(O),O.castShadow&&g.pushShadow(O))}),g.setupLights();const z=new Set;return S.traverse(function(O){if(!(O.isMesh||O.isPoints||O.isLine||O.isSprite))return;const ce=O.material;if(ce)if(Array.isArray(ce))for(let Me=0;Me<ce.length;Me++){const Fe=ce[Me];Zt(Fe,V,O),z.add(Fe)}else Zt(ce,V,O),z.add(ce)}),_.pop(),g=null,z},this.compileAsync=function(S,L,V=null){const z=this.compile(S,L,V);return new Promise(O=>{function ce(){z.forEach(function(Me){Ce.get(Me).currentProgram.isReady()&&z.delete(Me)}),0!==z.size?setTimeout(ce,10):O(S)}null!==le.get("KHR_parallel_shader_compile")?ce():setTimeout(ce,10)})};let os=null;function f3(){$l.stop()}function p3(){$l.start()}const $l=new Uk;function YS(S,L,V,z){if(!1===S.visible)return;if(S.layers.test(L.layers))if(S.isGroup)V=S.renderOrder;else if(S.isLOD)!0===S.autoUpdate&&S.update(L);else if(S.isLight)g.pushLight(S),S.castShadow&&g.pushShadow(S);else if(S.isSprite){if(!S.frustumCulled||J.intersectsSprite(S)){z&&nt.setFromMatrixPosition(S.matrixWorld).applyMatrix4(Ye);const Me=Z.update(S),Fe=S.material;Fe.visible&&m.push(S,Me,Fe,V,nt.z,null)}}else if((S.isMesh||S.isLine||S.isPoints)&&(!S.frustumCulled||J.intersectsObject(S))){const Me=Z.update(S),Fe=S.material;if(z&&(void 0!==S.boundingSphere?(null===S.boundingSphere&&S.computeBoundingSphere(),nt.copy(S.boundingSphere.center)):(null===Me.boundingSphere&&Me.computeBoundingSphere(),nt.copy(Me.boundingSphere.center)),nt.applyMatrix4(S.matrixWorld).applyMatrix4(Ye)),Array.isArray(Fe)){const Oe=Me.groups;for(let dt=0,pt=Oe.length;dt<pt;dt++){const Je=Oe[dt],Nt=Fe[Je.materialIndex];Nt&&Nt.visible&&m.push(S,Me,Nt,V,nt.z,Je)}}else Fe.visible&&m.push(S,Me,Fe,V,nt.z,null)}const ce=S.children;for(let Me=0,Fe=ce.length;Me<Fe;Me++)YS(ce[Me],L,V,z)}function g3(S,L,V,z){const O=S.opaque,ce=S.transmissive,Me=S.transparent;g.setupLightsView(V),!0===ge&&he.setGlobalState(x.clippingPlanes,V),z&&ve.viewport(N.copy(z)),O.length>0&&jy(O,L,V),ce.length>0&&jy(ce,L,V),Me.length>0&&jy(Me,L,V),ve.buffers.depth.setTest(!0),ve.buffers.depth.setMask(!0),ve.buffers.color.setMask(!0),ve.setPolygonOffset(!1)}function m3(S,L,V,z){if(null!==(!0===V.isScene?V.overrideMaterial:null))return;void 0===g.state.transmissionRenderTarget[z.id]&&(g.state.transmissionRenderTarget[z.id]=new ho(1,1,{generateMipmaps:!0,type:le.has("EXT_color_buffer_half_float")||le.has("EXT_color_buffer_float")?wf:lo,minFilter:ao,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Ft.workingColorSpace}));const ce=g.state.transmissionRenderTarget[z.id],Me=z.viewport||N;ce.setSize(Me.z*x.transmissionResolutionScale,Me.w*x.transmissionResolutionScale);const Fe=x.getRenderTarget();x.setRenderTarget(ce),x.getClearColor(j),K=x.getClearAlpha(),K<1&&x.setClearColor(16777215,.5),x.clear(),ne&&it.render(V);const Oe=x.toneMapping;x.toneMapping=0;const dt=z.viewport;if(void 0!==z.viewport&&(z.viewport=void 0),g.setupLightsView(z),!0===ge&&he.setGlobalState(x.clippingPlanes,z),jy(S,V,z),D.updateMultisampleRenderTarget(ce),D.updateRenderTargetMipmap(ce),!1===le.has("WEBGL_multisampled_render_to_texture")){let pt=!1;for(let Je=0,Nt=L.length;Je<Nt;Je++){const Jt=L[Je],bn=Jt.object,Rn=Jt.geometry,Ht=Jt.material,Ke=Jt.group;if(2===Ht.side&&bn.layers.test(z.layers)){const gi=Ht.side;Ht.side=1,Ht.needsUpdate=!0,v3(bn,V,z,Rn,Ht,Ke),Ht.side=gi,Ht.needsUpdate=!0,pt=!0}}!0===pt&&(D.updateMultisampleRenderTarget(ce),D.updateRenderTargetMipmap(ce))}x.setRenderTarget(Fe),x.setClearColor(j,K),void 0!==dt&&(z.viewport=dt),x.toneMapping=Oe}function jy(S,L,V){const z=!0===L.isScene?L.overrideMaterial:null;for(let O=0,ce=S.length;O<ce;O++){const Me=S[O],Fe=Me.object,Oe=Me.geometry,dt=null===z?Me.material:z,pt=Me.group;Fe.layers.test(V.layers)&&v3(Fe,L,V,Oe,dt,pt)}}function v3(S,L,V,z,O,ce){S.onBeforeRender(x,L,V,z,O,ce),S.modelViewMatrix.multiplyMatrices(V.matrixWorldInverse,S.matrixWorld),S.normalMatrix.getNormalMatrix(S.modelViewMatrix),O.onBeforeRender(x,L,V,z,S,ce),!0===O.transparent&&2===O.side&&!1===O.forceSinglePass?(O.side=1,O.needsUpdate=!0,x.renderBufferDirect(V,L,z,O,S,ce),O.side=0,O.needsUpdate=!0,x.renderBufferDirect(V,L,z,O,S,ce),O.side=2):x.renderBufferDirect(V,L,z,O,S,ce),S.onAfterRender(x,L,V,z,O,ce)}function $y(S,L,V){!0!==L.isScene&&(L=kt);const z=Ce.get(S),O=g.state.lights,Me=O.state.version,Fe=He.getParameters(S,O.state,g.state.shadowsArray,L,V),Oe=He.getProgramCacheKey(Fe);let dt=z.programs;z.environment=S.isMeshStandardMaterial?L.environment:null,z.fog=L.fog,z.envMap=(S.isMeshStandardMaterial?F:b).get(S.envMap||z.environment),z.envMapRotation=null!==z.environment&&null===S.envMap?L.environmentRotation:S.envMapRotation,void 0===dt&&(S.addEventListener("dispose",Mt),dt=new Map,z.programs=dt);let pt=dt.get(Oe);if(void 0!==pt){if(z.currentProgram===pt&&z.lightsStateVersion===Me)return _3(S,Fe),pt}else Fe.uniforms=He.getUniforms(S),S.onBeforeCompile(Fe,x),pt=He.acquireProgram(Fe,Oe),dt.set(Oe,pt),z.uniforms=Fe.uniforms;const Je=z.uniforms;return(!S.isShaderMaterial&&!S.isRawShaderMaterial||!0===S.clipping)&&(Je.clippingPlanes=he.uniform),_3(S,Fe),z.needsLights=function joe(S){return S.isMeshLambertMaterial||S.isMeshToonMaterial||S.isMeshPhongMaterial||S.isMeshStandardMaterial||S.isShadowMaterial||S.isShaderMaterial&&!0===S.lights}(S),z.lightsStateVersion=Me,z.needsLights&&(Je.ambientLightColor.value=O.state.ambient,Je.lightProbe.value=O.state.probe,Je.directionalLights.value=O.state.directional,Je.directionalLightShadows.value=O.state.directionalShadow,Je.spotLights.value=O.state.spot,Je.spotLightShadows.value=O.state.spotShadow,Je.rectAreaLights.value=O.state.rectArea,Je.ltc_1.value=O.state.rectAreaLTC1,Je.ltc_2.value=O.state.rectAreaLTC2,Je.pointLights.value=O.state.point,Je.pointLightShadows.value=O.state.pointShadow,Je.hemisphereLights.value=O.state.hemi,Je.directionalShadowMap.value=O.state.directionalShadowMap,Je.directionalShadowMatrix.value=O.state.directionalShadowMatrix,Je.spotShadowMap.value=O.state.spotShadowMap,Je.spotLightMatrix.value=O.state.spotLightMatrix,Je.spotLightMap.value=O.state.spotLightMap,Je.pointShadowMap.value=O.state.pointShadowMap,Je.pointShadowMatrix.value=O.state.pointShadowMatrix),z.currentProgram=pt,z.uniformsList=null,pt}function y3(S){if(null===S.uniformsList){const L=S.currentProgram.getUniforms();S.uniformsList=Hy.seqWithValue(L.seq,S.uniforms)}return S.uniformsList}function _3(S,L){const V=Ce.get(S);V.outputColorSpace=L.outputColorSpace,V.batching=L.batching,V.batchingColor=L.batchingColor,V.instancing=L.instancing,V.instancingColor=L.instancingColor,V.instancingMorph=L.instancingMorph,V.skinning=L.skinning,V.morphTargets=L.morphTargets,V.morphNormals=L.morphNormals,V.morphColors=L.morphColors,V.morphTargetsCount=L.morphTargetsCount,V.numClippingPlanes=L.numClippingPlanes,V.numIntersection=L.numClipIntersection,V.vertexAlphas=L.vertexAlphas,V.vertexTangents=L.vertexTangents,V.toneMapping=L.toneMapping}$l.setAnimationLoop(function Eo(S){os&&os(S)}),typeof self<"u"&&$l.setContext(self),this.setAnimationLoop=function(S){os=S,X.setAnimationLoop(S),null===S?$l.stop():$l.start()},X.addEventListener("sessionstart",f3),X.addEventListener("sessionend",p3),this.render=function(S,L){if(void 0!==L&&!0!==L.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===T)return;if(!0===S.matrixWorldAutoUpdate&&S.updateMatrixWorld(),null===L.parent&&!0===L.matrixWorldAutoUpdate&&L.updateMatrixWorld(),!0===X.enabled&&!0===X.isPresenting&&(!0===X.cameraAutoUpdate&&X.updateCamera(L),L=X.getCamera()),!0===S.isScene&&S.onBeforeRender(x,S,L,R),g=At.get(S,_.length),g.init(L),_.push(g),Ye.multiplyMatrices(L.projectionMatrix,L.matrixWorldInverse),J.setFromProjectionMatrix(Ye),Ge=this.localClippingEnabled,ge=he.init(this.clippingPlanes,Ge),m=Pe.get(S,y.length),m.init(),y.push(m),!0===X.enabled&&!0===X.isPresenting){const ce=x.xr.getDepthSensingMesh();null!==ce&&YS(ce,L,-1/0,x.sortObjects)}YS(S,L,0,x.sortObjects),m.finish(),!0===x.sortObjects&&m.sort(we,Re),ne=!1===X.enabled||!1===X.isPresenting||!1===X.hasDepthSensing(),ne&&it.addToRenderList(m,S),this.info.render.frame++,!0===ge&&he.beginShadows(),ke.render(g.state.shadowsArray,S,L),!0===ge&&he.endShadows(),!0===this.info.autoReset&&this.info.reset();const z=m.opaque,O=m.transmissive;if(g.setupLights(),L.isArrayCamera){const ce=L.cameras;if(O.length>0)for(let Me=0,Fe=ce.length;Me<Fe;Me++)m3(z,O,S,ce[Me]);ne&&it.render(S);for(let Me=0,Fe=ce.length;Me<Fe;Me++){const Oe=ce[Me];g3(m,S,Oe,Oe.viewport)}}else O.length>0&&m3(z,O,S,L),ne&&it.render(S),g3(m,S,L);null!==R&&0===C&&(D.updateMultisampleRenderTarget(R),D.updateRenderTargetMipmap(R)),!0===S.isScene&&S.onAfterRender(x,S,L),dn.resetDefaultState(),M=-1,w=null,_.pop(),_.length>0?(g=_[_.length-1],!0===ge&&he.setGlobalState(x.clippingPlanes,g.state.camera)):g=null,y.pop(),m=y.length>0?y[y.length-1]:null},this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return C},this.getRenderTarget=function(){return R},this.setRenderTargetTextures=function(S,L,V){Ce.get(S.texture).__webglTexture=L,Ce.get(S.depthTexture).__webglTexture=V;const z=Ce.get(S);z.__hasExternalTextures=!0,z.__autoAllocateDepthBuffer=void 0===V,z.__autoAllocateDepthBuffer||!0===le.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),z.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(S,L){const V=Ce.get(S);V.__webglFramebuffer=L,V.__useDefaultFramebuffer=void 0===L};const $oe=I.createFramebuffer();this.setRenderTarget=function(S,L=0,V=0){R=S,E=L,C=V;let z=!0,O=null,ce=!1,Me=!1;if(S){const Oe=Ce.get(S);if(void 0!==Oe.__useDefaultFramebuffer)ve.bindFramebuffer(I.FRAMEBUFFER,null),z=!1;else if(void 0===Oe.__webglFramebuffer)D.setupRenderTarget(S);else if(Oe.__hasExternalTextures)D.rebindTextures(S,Ce.get(S.texture).__webglTexture,Ce.get(S.depthTexture).__webglTexture);else if(S.depthBuffer){const Je=S.depthTexture;if(Oe.__boundDepthTexture!==Je){if(null!==Je&&Ce.has(Je)&&(S.width!==Je.image.width||S.height!==Je.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");D.setupDepthRenderbuffer(S)}}const dt=S.texture;(dt.isData3DTexture||dt.isDataArrayTexture||dt.isCompressedArrayTexture)&&(Me=!0);const pt=Ce.get(S).__webglFramebuffer;S.isWebGLCubeRenderTarget?(O=Array.isArray(pt[L])?pt[L][V]:pt[L],ce=!0):O=S.samples>0&&!1===D.useMultisampledRTT(S)?Ce.get(S).__webglMultisampledFramebuffer:Array.isArray(pt)?pt[V]:pt,N.copy(S.viewport),G.copy(S.scissor),B=S.scissorTest}else N.copy(Ve).multiplyScalar(q).floor(),G.copy(yt).multiplyScalar(q).floor(),B=Wt;if(0!==V&&(O=$oe),ve.bindFramebuffer(I.FRAMEBUFFER,O)&&z&&ve.drawBuffers(S,O),ve.viewport(N),ve.scissor(G),ve.setScissorTest(B),ce){const Oe=Ce.get(S.texture);I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_CUBE_MAP_POSITIVE_X+L,Oe.__webglTexture,V)}else if(Me){const Oe=Ce.get(S.texture);I.framebufferTextureLayer(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,Oe.__webglTexture,V,L)}else if(null!==S&&0!==V){const Oe=Ce.get(S.texture);I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_2D,Oe.__webglTexture,V)}M=-1},this.readRenderTargetPixels=function(S,L,V,z,O,ce,Me){if(!S||!S.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Fe=Ce.get(S).__webglFramebuffer;if(S.isWebGLCubeRenderTarget&&void 0!==Me&&(Fe=Fe[Me]),Fe){ve.bindFramebuffer(I.FRAMEBUFFER,Fe);try{const Oe=S.texture,dt=Oe.format,pt=Oe.type;if(!Le.textureFormatReadable(dt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!Le.textureTypeReadable(pt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");L>=0&&L<=S.width-z&&V>=0&&V<=S.height-O&&I.readPixels(L,V,z,O,Tt.convert(dt),Tt.convert(pt),ce)}finally{const Oe=null!==R?Ce.get(R).__webglFramebuffer:null;ve.bindFramebuffer(I.FRAMEBUFFER,Oe)}}},this.readRenderTargetPixelsAsync=function(){var S=Hn(function*(L,V,z,O,ce,Me,Fe){if(!L||!L.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Oe=Ce.get(L).__webglFramebuffer;if(L.isWebGLCubeRenderTarget&&void 0!==Fe&&(Oe=Oe[Fe]),Oe){const dt=L.texture,pt=dt.format,Je=dt.type;if(!Le.textureFormatReadable(pt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Le.textureTypeReadable(Je))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(V>=0&&V<=L.width-O&&z>=0&&z<=L.height-ce){ve.bindFramebuffer(I.FRAMEBUFFER,Oe);const Nt=I.createBuffer();I.bindBuffer(I.PIXEL_PACK_BUFFER,Nt),I.bufferData(I.PIXEL_PACK_BUFFER,Me.byteLength,I.STREAM_READ),I.readPixels(V,z,O,ce,Tt.convert(pt),Tt.convert(Je),0);const Jt=null!==R?Ce.get(R).__webglFramebuffer:null;ve.bindFramebuffer(I.FRAMEBUFFER,Jt);const bn=I.fenceSync(I.SYNC_GPU_COMMANDS_COMPLETE,0);return I.flush(),yield function gee(n,e,t){return new Promise(function(i,r){setTimeout(function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:r();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:i()}},t)})}(I,bn,4),I.bindBuffer(I.PIXEL_PACK_BUFFER,Nt),I.getBufferSubData(I.PIXEL_PACK_BUFFER,0,Me),I.deleteBuffer(Nt),I.deleteSync(bn),Me}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}});return function(L,V,z,O,ce,Me,Fe){return S.apply(this,arguments)}}(),this.copyFramebufferToTexture=function(S,L=null,V=0){!0!==S.isTexture&&(Lu("WebGLRenderer: copyFramebufferToTexture function signature has changed."),L=arguments[0]||null,S=arguments[1]);const z=Math.pow(2,-V),O=Math.floor(S.image.width*z),ce=Math.floor(S.image.height*z),Me=null!==L?L.x:0,Fe=null!==L?L.y:0;D.setTexture2D(S,0),I.copyTexSubImage2D(I.TEXTURE_2D,V,0,0,Me,Fe,O,ce),ve.unbindTexture()};const Woe=I.createFramebuffer(),qoe=I.createFramebuffer();this.copyTextureToTexture=function(S,L,V=null,z=null,O=0,ce=null){let Me,Fe,Oe,dt,pt,Je,Nt,Jt,bn;!0!==S.isTexture&&(Lu("WebGLRenderer: copyTextureToTexture function signature has changed."),z=arguments[0]||null,S=arguments[1],L=arguments[2],ce=arguments[3]||0,V=null),null===ce&&(0!==O?(Lu("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),ce=O,O=0):ce=0);const Rn=S.isCompressedTexture?S.mipmaps[ce]:S.image;if(null!==V)Me=V.max.x-V.min.x,Fe=V.max.y-V.min.y,Oe=V.isBox3?V.max.z-V.min.z:1,dt=V.min.x,pt=V.min.y,Je=V.isBox3?V.min.z:0;else{const Gr=Math.pow(2,-O);Me=Math.floor(Rn.width*Gr),Fe=Math.floor(Rn.height*Gr),Oe=S.isDataArrayTexture?Rn.depth:S.isData3DTexture?Math.floor(Rn.depth*Gr):1,dt=0,pt=0,Je=0}null!==z?(Nt=z.x,Jt=z.y,bn=z.z):(Nt=0,Jt=0,bn=0);const Ht=Tt.convert(L.format),Ke=Tt.convert(L.type);let gi;L.isData3DTexture?(D.setTexture3D(L,0),gi=I.TEXTURE_3D):L.isDataArrayTexture||L.isCompressedArrayTexture?(D.setTexture2DArray(L,0),gi=I.TEXTURE_2D_ARRAY):(D.setTexture2D(L,0),gi=I.TEXTURE_2D),I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,L.flipY),I.pixelStorei(I.UNPACK_PREMULTIPLY_ALPHA_WEBGL,L.premultiplyAlpha),I.pixelStorei(I.UNPACK_ALIGNMENT,L.unpackAlignment);const qt=I.getParameter(I.UNPACK_ROW_LENGTH),as=I.getParameter(I.UNPACK_IMAGE_HEIGHT),ud=I.getParameter(I.UNPACK_SKIP_PIXELS),Sr=I.getParameter(I.UNPACK_SKIP_ROWS),Xf=I.getParameter(I.UNPACK_SKIP_IMAGES);I.pixelStorei(I.UNPACK_ROW_LENGTH,Rn.width),I.pixelStorei(I.UNPACK_IMAGE_HEIGHT,Rn.height),I.pixelStorei(I.UNPACK_SKIP_PIXELS,dt),I.pixelStorei(I.UNPACK_SKIP_ROWS,pt),I.pixelStorei(I.UNPACK_SKIP_IMAGES,Je);const vn=S.isDataArrayTexture||S.isData3DTexture,Hr=L.isDataArrayTexture||L.isData3DTexture;if(S.isDepthTexture){const Gr=Ce.get(S),Hi=Ce.get(L),ar=Ce.get(Gr.__renderTarget),ZS=Ce.get(Hi.__renderTarget);ve.bindFramebuffer(I.READ_FRAMEBUFFER,ar.__webglFramebuffer),ve.bindFramebuffer(I.DRAW_FRAMEBUFFER,ZS.__webglFramebuffer);for(let Wl=0;Wl<Oe;Wl++)vn&&(I.framebufferTextureLayer(I.READ_FRAMEBUFFER,I.COLOR_ATTACHMENT0,Ce.get(S).__webglTexture,O,Je+Wl),I.framebufferTextureLayer(I.DRAW_FRAMEBUFFER,I.COLOR_ATTACHMENT0,Ce.get(L).__webglTexture,ce,bn+Wl)),I.blitFramebuffer(dt,pt,Me,Fe,Nt,Jt,Me,Fe,I.DEPTH_BUFFER_BIT,I.NEAREST);ve.bindFramebuffer(I.READ_FRAMEBUFFER,null),ve.bindFramebuffer(I.DRAW_FRAMEBUFFER,null)}else if(0!==O||S.isRenderTargetTexture||Ce.has(S)){const Gr=Ce.get(S),Hi=Ce.get(L);ve.bindFramebuffer(I.READ_FRAMEBUFFER,Woe),ve.bindFramebuffer(I.DRAW_FRAMEBUFFER,qoe);for(let ar=0;ar<Oe;ar++)vn?I.framebufferTextureLayer(I.READ_FRAMEBUFFER,I.COLOR_ATTACHMENT0,Gr.__webglTexture,O,Je+ar):I.framebufferTexture2D(I.READ_FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_2D,Gr.__webglTexture,O),Hr?I.framebufferTextureLayer(I.DRAW_FRAMEBUFFER,I.COLOR_ATTACHMENT0,Hi.__webglTexture,ce,bn+ar):I.framebufferTexture2D(I.DRAW_FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_2D,Hi.__webglTexture,ce),0!==O?I.blitFramebuffer(dt,pt,Me,Fe,Nt,Jt,Me,Fe,I.COLOR_BUFFER_BIT,I.NEAREST):Hr?I.copyTexSubImage3D(gi,ce,Nt,Jt,bn+ar,dt,pt,Me,Fe):I.copyTexSubImage2D(gi,ce,Nt,Jt,dt,pt,Me,Fe);ve.bindFramebuffer(I.READ_FRAMEBUFFER,null),ve.bindFramebuffer(I.DRAW_FRAMEBUFFER,null)}else Hr?S.isDataTexture||S.isData3DTexture?I.texSubImage3D(gi,ce,Nt,Jt,bn,Me,Fe,Oe,Ht,Ke,Rn.data):L.isCompressedArrayTexture?I.compressedTexSubImage3D(gi,ce,Nt,Jt,bn,Me,Fe,Oe,Ht,Rn.data):I.texSubImage3D(gi,ce,Nt,Jt,bn,Me,Fe,Oe,Ht,Ke,Rn):S.isDataTexture?I.texSubImage2D(I.TEXTURE_2D,ce,Nt,Jt,Me,Fe,Ht,Ke,Rn.data):S.isCompressedTexture?I.compressedTexSubImage2D(I.TEXTURE_2D,ce,Nt,Jt,Rn.width,Rn.height,Ht,Rn.data):I.texSubImage2D(I.TEXTURE_2D,ce,Nt,Jt,Me,Fe,Ht,Ke,Rn);I.pixelStorei(I.UNPACK_ROW_LENGTH,qt),I.pixelStorei(I.UNPACK_IMAGE_HEIGHT,as),I.pixelStorei(I.UNPACK_SKIP_PIXELS,ud),I.pixelStorei(I.UNPACK_SKIP_ROWS,Sr),I.pixelStorei(I.UNPACK_SKIP_IMAGES,Xf),0===ce&&L.generateMipmaps&&I.generateMipmap(gi),ve.unbindTexture()},this.copyTextureToTexture3D=function(S,L,V=null,z=null,O=0){return!0!==S.isTexture&&(Lu("WebGLRenderer: copyTextureToTexture3D function signature has changed."),V=arguments[0]||null,z=arguments[1]||null,S=arguments[2],L=arguments[3],O=arguments[4]||0),Lu('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(S,L,V,z,O)},this.initRenderTarget=function(S){void 0===Ce.get(S).__webglFramebuffer&&D.setupRenderTarget(S)},this.initTexture=function(S){S.isCubeTexture?D.setTextureCube(S,0):S.isData3DTexture?D.setTexture3D(S,0):S.isDataArrayTexture||S.isCompressedArrayTexture?D.setTexture2DArray(S,0):D.setTexture2D(S,0),ve.unbindTexture()},this.resetState=function(){E=0,C=0,R=null,ve.reset(),dn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Is}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorspace=Ft._getDrawingBufferColorSpace(e),t.unpackColorSpace=Ft._getUnpackColorSpace()}}const Boe=["canvas"];let Voe=(()=>{class n{canvasRef;renderer;scene;camera;particles;mouseX=0;mouseY=0;windowHalfX=window.innerWidth/2;windowHalfY=window.innerHeight/2;ngOnInit(){this.init(),this.animate(),this.addEventListeners()}init(){this.scene=new wF,this.camera=new pi(75,window.innerWidth/window.innerHeight,1,3e3),this.camera.position.z=1e3;const t=new bt,i=[],r=2e3;for(let o=0;o<2e3;o++){const a=(Math.random()*r+450)*(Math.round(Math.random())?-1:1),l=(Math.random()*r+450)*(Math.round(Math.random())?-1:1),c=(Math.random()*r+450)*(Math.round(Math.random())?-1:1);i.push(a,l,c)}t.setAttribute("position",new ze(i,3));const s=new rS({size:2,color:7340287,transparent:!0,opacity:.8,sizeAttenuation:!0});this.particles=new HF(t,s),this.scene.add(this.particles),this.renderer=new Uoe({canvas:this.canvasRef.nativeElement,alpha:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight)}addEventListeners(){window.addEventListener("resize",()=>this.onWindowResize()),document.addEventListener("mousemove",t=>this.onMouseMove(t))}onWindowResize(){this.windowHalfX=window.innerWidth/2,this.windowHalfY=window.innerHeight/2,this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}onMouseMove(t){this.mouseX=t.clientX-this.windowHalfX,this.mouseY=t.clientY-this.windowHalfY}animate(){requestAnimationFrame(()=>this.animate()),this.camera.position.x+=.01*(.05*this.mouseX-this.camera.position.x),this.camera.position.y+=.01*(.05*-this.mouseY-this.camera.position.y),this.camera.lookAt(this.scene.position),this.particles.rotation.y+=.001,this.renderer.render(this.scene,this.camera)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=Zs({type:n,selectors:[["app-background"]],viewQuery:function(i,r){if(1&i&&function FR(n,e,t){S1(n,e,t)}(Boe,7),2&i){let s;(function xw(n){const e=U(),t=tt(),i=H_();Ap(i+1);const r=Bx(t,i);if(n.dirty&&function CU(n){return!(4&~n[2])}(e)===!(2&~r.metadata.flags)){if(null===r.matches)n.reset([]);else{const s=D1(e,i);n.reset(s,FC),n.notifyOnChanges()}return!0}return!1})(s=function ww(){return function Ux(n,e){return n[18].queries[e].queryList}(U(),H_())}())&&(r.canvasRef=s.first)}},decls:2,vars:0,consts:[["canvas",""],[1,"fixed","top-0","left-0","w-full","h-full","-z-10"]],template:function(i,r){1&i&&$t(0,"canvas",1,0)},encapsulation:2})}return n})(),zoe=(()=>{class n{translation;currentLang;constructor(t){this.translation=t,this.currentLang=t.currentLang}switchLanguage(t){const i=t.target.value;this.translation.use(i),this.currentLang=i}static \u0275fac=function(i){return new(i||n)(Be(bu))};static \u0275cmp=Zs({type:n,selectors:[["app-language-switcher-selector"]],decls:6,vars:1,consts:[[1,"fixed","top-4","right-4","z-50"],[1,"bg-bg-secondary","text-text-primary","border","border-white/10","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","focus:ring-accent",3,"change","value"],["value","en"],["value","es"]],template:function(i,r){1&i&&(ae(0,"div",0)(1,"select",1),Mh("change",function(o){return r.switchLanguage(o)}),ae(2,"option",2),Ze(3,"English"),ue(),ae(4,"option",3),Ze(5,"Espa\xf1ol"),ue()()()),2&i&&(Te(),It("value",r.currentLang))},encapsulation:2})}return n})();(function dq(n,e){return sW({rootComponent:n,...pL(e)})})((()=>{class n{translate;title="AlfonsoLopezViejo.Github.io";currentYear=(new Date).getFullYear();projects=lM;constructor(t){this.translate=t,this.translate.addLangs(["es","en"]),this.translate.setDefaultLang("es"),this.translate.use("es")}static \u0275fac=function(i){return new(i||n)(Be(bu))};static \u0275cmp=Zs({type:n,selectors:[["app-root"]],decls:3,vars:0,template:function(i,r){1&i&&$t(0,"app-background")(1,"app-language-switcher-selector")(2,"router-outlet")},dependencies:[wm,tM,Gb,zoe,Voe,uv,IO],encapsulation:2})}return n})(),oQ).catch(n=>console.error(n))},73:()=>{Error;const Kl=function(k,...H){if(Kl.translate){const de=Kl.translate(k,H);k=de[0],H=de[1]}let re=Ql(k[0],k.raw[0]);for(let de=1;de<k.length;de++)re+=H[de-1]+Ql(k[de],k.raw[de]);return re},eT=":";function Ql(k,H){return H.charAt(0)===eT?k.substring(function Ea(k,H){for(let re=1,de=1;re<k.length;re++,de++)if("\\"===H[de])de++;else if(":"===k[re])return re;throw new Error(`Unterminated $localize metadata block in "${H}".`)}(k,H)+1):k}globalThis.$localize=Kl}},Os=>{var Hn=yn=>Os(Os.s=yn);Hn(73),Hn(675)}]);